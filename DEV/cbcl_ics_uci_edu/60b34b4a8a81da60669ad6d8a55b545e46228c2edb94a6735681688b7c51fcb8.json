{"url": "https://cbcl.ics.uci.edu/public_data/shilab/ChIPseq_szang_20160205/ChIP_seq_pipeline.txt", "content": "##########################\nChIP-seq Pipeline\n##########################\n\n\n1. Alignment\nmodule load bowtie/1.0.0\nbowtie [reference_genome_idx] -q [input.fastq] -n 2 -m 1 -S > [output.sam]\n\n\n2. Prepare sorted bam files\nmodule load samtools/1.1\nsamtools view -b [input.sam] > [output.bam] \nsamtools sort -T [temp.file] -o [output.sorted.bam] [input.bam]\n\n\n3. Generate bigwigs\n# deeptools/bamCoverage\nbamCoverage -b [input.bam] --normalizeUsingRPKM --ignoreDuplicates -p 32 -of bigwig -o [output.bw]\n\n\n4. Call peaks\n# MACS2.1.0.20150731  \nmodule load enthought_python/7.3.2\nmacs2 callpeak -t [input.sam] -c [control.sam] -g hs -n [output.name] --outdir [output.path]\n\n\n5. Annotation\n# HOMER(v4.8, 1-13-2016)\nmodule load perl/5.16.2\nmodule load enthought_python/7.3.2\nannotatePeaks.pl [input.peak.bed] Ref-hg19 > [output.annotatedpeaks.txt]\n\n\n6. NGSplot - common\n# produce common ngs.plots\nngs.plot.r -G hg19 -R genebody -C [input.sorted.bam] -O [output.name] -T [label.on.graph]\n\n\n7. NGSplot - associated\n7.1 \n# extract the genelist for ngs.plot.r\n# NR is built-in variable for number of rows so it is here to skip the header \nawk '{if(NR>1)print}' [input.annotatedpeaks] | cut -f 16 > [output.genelist]\n7.2\n# produce associated ngs.plot\nmodule load R\nngs.plot.r -G hg19 -R genebody -E [input.genelist] -C [input.sorted.bam] -O [output.name] -T [label.on.graph]\n\n\n\n", "encoding": "ascii"}