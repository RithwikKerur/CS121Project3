{"url": "https://cbcl.ics.uci.edu/public_data/shilab/PASseq_szang_20160302/PAS-seq_pipeline_usingTophat.txt", "content": "##########################\n# PAS-seq Pipeline using Tophat\n##########################\n\n\n\n1. QC\nmodule load fastqc/0.11.2\nls [all the input.fastq] | xargs fastqc\n# here I am using the combination of ls and xargs, which pump listed inputs one at a time into fastqc command tool.\n\n\n2. Trim low-quality reads.\nmodule load java/1.8.0.51\nmodule load trimmomatic/0.35\njava -jar /data/apps/trimmomatic/0.35/trimmomatic-0.35.jar SE -threads 12 -phred33 [input.fastq] [output.name] TRAILING:20 SLIDINGWINDOW:4:20 \nMINLEN:20\n\n\n3. Tophat mapping.\nmodule load bowtie2/2.2.7\nmodule load tophat/2.1.0\ntophat -p 32 -o [output.name] -g 1 --library-type fr-secondstrand -G [annotation_file] [indexed_reference_genome] [input.fastq]\n\n\n3.5 Remove internal priming reads\n# using \"PTM_filter_TophatAdapted.py\" in myPythonTool folder\n\n\n4. Prepare BAMs\nmodule load samtools/1.1\nsamtools sort -o [output.sorted.bam] -@ 32 [input.bam]\nsamtools view -h [input.sorted.bam] > [output.sorted.sam]\n\n\n5. Generate tracks\nmodule load bedtools/2.23.0\n\n# combined tracks\nbedtools genomecov -ibam [input.sorted.bam] -split -bg -g [mm9_chromSize] > [output.bedGraph]\n\n# separated tracks\nbedtools genomecov -ibam [input.sorted.bam] -split -bg -strand + -g [mm9_chromSize] > [output.bedGraph]\nbedtools genomecov -ibam [input.sorted.bam] -split -bg -strand - -g [mm9_chromSize] > [output.bedGraph]\n\n# and then:\n./bedGraphToBigWig [input.bedGraph] [mm9_chromSize] [output.bw]\n\n\n6. Generate read counts table \n# using masterlist \u00e2\u20ac\u201d Tian PAS data.txt, as reference, available at:\nhttps://cbcl.ics.uci.edu/public_data/shilab/PASseq_szang_20160302/Tian%20PAS%20data.txt\n# using \"PAS_incrementer_onTophat.py\" in myPythonTool folder to increment the read counts for each ApAid\n# using \"mergeCounts_separatedAPAgenes.py\" in myPythonTool folder to combine results from each sample\n\n", "encoding": "Windows-1252"}