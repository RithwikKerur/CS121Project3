{"url": "https://cbcl.ics.uci.edu/public_data/shilab/20180125-m6a-motifanalysis/labeled_15pct_68KO12_negvspos-vsall-noreg-dreme-s/dreme.html", "content": "<!DOCTYPE HTML>\n<html>\n  <head>\n    <meta charset=\"UTF-8\">\n    <title>DREME</title>\n    <script>\n      // @JSON_VAR data\n      var data = {\n        \"program\": \"dreme\",\n        \"version\": \"4.12.0\",\n        \"release\": \"Tue Jun 27 16:22:50 2017 -0700\",\n        \"cmd\": [\n          \"dreme\", \"-p\", \"labeled_15pct_68KO12_negvspos-ext200.fa\", \"-n\",\n          \"labeled_15pct_68KO12_negvspos-nochange-ext200.fa\", \"-oc\",\n          \"labeled_15pct_68KO12_negvspos-vsall-noreg-dreme-s\", \"-norc\",\n          \"-mink\", \"4\", \"-maxk\", \"12\", \"-m\", \"20\", \"-e\", \"0.00000001\"\n        ],\n        \"options\": {\n          \"revcomp\": false,\n          \"ngen\": 100,\n          \"add_pv_thresh\": 0.01,\n          \"seed\": 1,\n          \"stop\": {\n            \"evalue\": \"1e-08\",\n            \"count\": 20\n          }\n        },\n        \"alphabet\": {\n          \"name\": \"DNA\",\n          \"like\": \"dna\",\n          \"ncore\": 4,\n          \"symbols\": [\n            {\n              \"symbol\": \"A\",\n              \"name\": \"Adenine\",\n              \"colour\": \"CC0000\",\n              \"complement\": \"T\"\n            }, {\n              \"symbol\": \"C\",\n              \"name\": \"Cytosine\",\n              \"colour\": \"0000CC\",\n              \"complement\": \"G\"\n            }, {\n              \"symbol\": \"G\",\n              \"name\": \"Guanine\",\n              \"colour\": \"FFB300\",\n              \"complement\": \"C\"\n            }, {\n              \"symbol\": \"T\",\n              \"aliases\": \"U\",\n              \"name\": \"Thymine\",\n              \"colour\": \"008000\",\n              \"complement\": \"A\"\n            }, {\n              \"symbol\": \"N\",\n              \"aliases\": \"X.\",\n              \"name\": \"Any base\",\n              \"equals\": \"ACGT\"\n            }, {\n              \"symbol\": \"V\",\n              \"name\": \"Not T\",\n              \"equals\": \"ACG\"\n            }, {\n              \"symbol\": \"H\",\n              \"name\": \"Not G\",\n              \"equals\": \"ACT\"\n            }, {\n              \"symbol\": \"D\",\n              \"name\": \"Not C\",\n              \"equals\": \"AGT\"\n            }, {\n              \"symbol\": \"B\",\n              \"name\": \"Not A\",\n              \"equals\": \"CGT\"\n            }, {\n              \"symbol\": \"M\",\n              \"name\": \"Amino\",\n              \"equals\": \"AC\"\n            }, {\n              \"symbol\": \"R\",\n              \"name\": \"Purine\",\n              \"equals\": \"AG\"\n            }, {\n              \"symbol\": \"W\",\n              \"name\": \"Weak\",\n              \"equals\": \"AT\"\n            }, {\n              \"symbol\": \"S\",\n              \"name\": \"Strong\",\n              \"equals\": \"CG\"\n            }, {\n              \"symbol\": \"Y\",\n              \"name\": \"Pyrimidine\",\n              \"equals\": \"CT\"\n            }, {\n              \"symbol\": \"K\",\n              \"name\": \"Keto\",\n              \"equals\": \"GT\"\n            }\n          ]\n        },\n        \"background\": {\n          \"freqs\": [0.303, 0.171, 0.189, 0.338]\n        },\n        \"sequence_db\": {\n          \"name\": \"labeled 15pct 68KO12 negvspos-ext200\",\n          \"file\": \"labeled_15pct_68KO12_negvspos-ext200.fa\",\n          \"lmod\": \"Tue Jan 23 20:49:24 PST 2018\",\n          \"count\": 2130\n        },\n        \"control_db\": {\n          \"name\": \"labeled 15pct 68KO12 negvspos-nochange-ext200\",\n          \"from\": \"file\",\n          \"file\": \"labeled_15pct_68KO12_negvspos-nochange-ext200.fa\",\n          \"lmod\": \"Thu Jan 25 11:52:53 PST 2018\",\n          \"count\": 11710,\n          \"freqs\": [0.303, 0.171, 0.189, 0.338]\n        },\n        \"motifs\": [\n          {\n            \"db\": 0,\n            \"id\": \"CSKGG\",\n            \"alt\": \"DREME-1\",\n            \"len\": 5,\n            \"nsites\": 1094,\n            \"evalue\": \"3.1e-016\",\n            \"p\": 745,\n            \"n\": 2893,\n            \"pvalue\": \"2.6e-022\",\n            \"unerased_evalue\": \"3.1e-016\",\n            \"pwm\": [\n              [0.000000, 1.000000, 0.000000, 0.000000], \n              [0.000000, 0.752285, 0.247715, 0.000000], \n              [0.000000, 0.000000, 0.213894, 0.786106], \n              [0.000000, 0.000000, 1.000000, 0.000000], \n              [0.000000, 0.000000, 1.000000, 0.000000]\n            ],\n            \"matches\": [\n              {\n                \"seq\": \"CCTGG\",\n                \"p\": 550,\n                \"n\": 2073,\n                \"pvalue\": \"1.1e-017\",\n                \"evalue\": \"1.3e-011\"\n              }, {\n                \"seq\": \"CGTGG\",\n                \"p\": 158,\n                \"n\": 577,\n                \"pvalue\": \"3.9e-006\",\n                \"evalue\": \"4.6e+000\"\n              }, {\n                \"seq\": \"CCGGG\",\n                \"p\": 126,\n                \"n\": 443,\n                \"pvalue\": \"8.6e-006\",\n                \"evalue\": \"1.0e+001\"\n              }, {\n                \"seq\": \"CGGGG\",\n                \"p\": 118,\n                \"n\": 422,\n                \"pvalue\": \"3.1e-005\",\n                \"evalue\": \"3.7e+001\"\n              }\n            ]\n          }, {\n            \"db\": 0,\n            \"id\": \"SGCWG\",\n            \"alt\": \"DREME-2\",\n            \"len\": 5,\n            \"nsites\": 1234,\n            \"evalue\": \"1.4e-010\",\n            \"p\": 813,\n            \"n\": 3408,\n            \"pvalue\": \"1.2e-016\",\n            \"unerased_evalue\": \"2.4e-010\",\n            \"pwm\": [\n              [0.000000, 0.158023, 0.841977, 0.000000], \n              [0.000000, 0.000000, 1.000000, 0.000000], \n              [0.000000, 1.000000, 0.000000, 0.000000], \n              [0.462723, 0.000000, 0.000000, 0.537277], \n              [0.000000, 0.000000, 1.000000, 0.000000]\n            ],\n            \"matches\": [\n              {\n                \"seq\": \"GGCTG\",\n                \"p\": 451,\n                \"n\": 1790,\n                \"pvalue\": \"2.7e-011\",\n                \"evalue\": \"3.1e-005\"\n              }, {\n                \"seq\": \"GGCAG\",\n                \"p\": 396,\n                \"n\": 1591,\n                \"pvalue\": \"2.4e-009\",\n                \"evalue\": \"2.7e-003\"\n              }, {\n                \"seq\": \"CGCTG\",\n                \"p\": 101,\n                \"n\": 397,\n                \"pvalue\": \"1.7e-003\",\n                \"evalue\": \"2.0e+003\"\n              }, {\n                \"seq\": \"CGCAG\",\n                \"p\": 86,\n                \"n\": 342,\n                \"pvalue\": \"4.8e-003\",\n                \"evalue\": \"5.5e+003\"\n              }\n            ]\n          }, {\n            \"db\": 0,\n            \"id\": \"GDSCC\",\n            \"alt\": \"DREME-3\",\n            \"len\": 5,\n            \"nsites\": 1503,\n            \"evalue\": \"6.1e-011\",\n            \"p\": 959,\n            \"n\": 4154,\n            \"pvalue\": \"5.6e-017\",\n            \"unerased_evalue\": \"2.0e-012\",\n            \"pwm\": [\n              [0.000000, 0.000000, 1.000000, 0.000000], \n              [0.339987, 0.000000, 0.254824, 0.405190], \n              [0.000000, 0.452428, 0.547572, 0.000000], \n              [0.000000, 1.000000, 0.000000, 0.000000], \n              [0.000000, 1.000000, 0.000000, 0.000000]\n            ],\n            \"matches\": [\n              {\n                \"seq\": \"GTCCC\",\n                \"p\": 258,\n                \"n\": 967,\n                \"pvalue\": \"1.8e-008\",\n                \"evalue\": \"2.0e-002\"\n              }, {\n                \"seq\": \"GGCCC\",\n                \"p\": 211,\n                \"n\": 792,\n                \"pvalue\": \"4.6e-007\",\n                \"evalue\": \"5.1e-001\"\n              }, {\n                \"seq\": \"GAGCC\",\n                \"p\": 273,\n                \"n\": 1097,\n                \"pvalue\": \"1.2e-006\",\n                \"evalue\": \"1.3e+000\"\n              }, {\n                \"seq\": \"GGGCC\",\n                \"p\": 190,\n                \"n\": 729,\n                \"pvalue\": \"5.8e-006\",\n                \"evalue\": \"6.4e+000\"\n              }, {\n                \"seq\": \"GTGCC\",\n                \"p\": 289,\n                \"n\": 1283,\n                \"pvalue\": \"3.5e-004\",\n                \"evalue\": \"3.8e+002\"\n              }, {\n                \"seq\": \"GACCC\",\n                \"p\": 190,\n                \"n\": 806,\n                \"pvalue\": \"6.4e-004\",\n                \"evalue\": \"7.0e+002\"\n              }\n            ]\n          }\n        ],\n        \"runtime\": {\n          \"host\": \"compute-1-13.local\",\n          \"when\": \"Thu Jan 25 11:52:56 PST 2018\",\n          \"cpu\": 1566.72,\n          \"real\": 2081.65,\n          \"stop\": \"evalue\"\n        }\n      };\n    </script>\n    <script>\nvar site_url = \"http://meme-suite.org\";\n</script>\n    <script>\n\n/*\n * $\n *\n * Shorthand function for getElementById\n */\nfunction $(el) {\n  return document.getElementById(el);\n}\n\n\n/*\n * See http://stackoverflow.com/a/5450113/66387\n * Does string multiplication like the perl x operator.\n */\nfunction string_mult(pattern, count) {\n    if (count < 1) return '';\n    var result = '';\n    while (count > 1) {\n        if (count & 1) result += pattern;\n        count >>= 1, pattern += pattern;\n    }\n    return result + pattern;\n}\n\n/*\n * See http://stackoverflow.com/questions/814613/how-to-read-get-data-from-a-url-using-javascript\n * Slightly modified with information from\n * https://developer.mozilla.org/en/DOM/window.location\n */\nfunction parse_params() {\n  \"use strict\";\n  var search, queryStart, queryEnd, query, params, nvPairs, i, nv, n, v;\n  search = window.location.search;\n  queryStart = search.indexOf(\"?\") + 1;\n  queryEnd   = search.indexOf(\"#\") + 1 || search.length + 1;\n  query      = search.slice(queryStart, queryEnd - 1);\n\n  if (query === search || query === \"\") return {};\n\n  params  = {};\n  nvPairs = query.replace(/\\+/g, \" \").split(\"&\");\n\n  for (i = 0; i < nvPairs.length; i++) {\n    nv = nvPairs[i].split(\"=\");\n    n  = decodeURIComponent(nv[0]);\n    v  = decodeURIComponent(nv[1]);\n    // allow a name to be used multiple times\n    // storing each value in the array\n    if (!(n in params)) {\n      params[n] = [];\n    }\n    params[n].push(nv.length === 2 ? v : null);\n  }\n  return params;\n}\n\n/*\n * coords\n *\n * Calculates the x and y offset of an element.\n * From http://www.quirksmode.org/js/findpos.html\n * with alterations to take into account scrolling regions\n */\nfunction coords(elem) {\n  var myX = myY = 0;\n  if (elem.getBoundingClientRect) {\n    var rect;\n    rect = elem.getBoundingClientRect();\n    myX = rect.left + ((typeof window.pageXOffset !== \"undefined\") ?\n        window.pageXOffset : document.body.scrollLeft);\n    myY = rect.top + ((typeof window.pageYOffset !== \"undefined\") ?\n        window.pageYOffset : document.body.scrollTop);\n  } else {\n    // this fall back doesn't properly handle absolutely positioned elements\n    // inside a scrollable box\n    var node;\n    if (elem.offsetParent) {\n      // subtract all scrolling\n      node = elem;\n      do {\n        myX -= node.scrollLeft ? node.scrollLeft : 0;\n        myY -= node.scrollTop ? node.scrollTop : 0;\n      } while (node = node.parentNode);\n      // this will include the page scrolling (which is unwanted) so add it back on\n      myX += (typeof window.pageXOffset !== \"undefined\") ? window.pageXOffset : document.body.scrollLeft;\n      myY += (typeof window.pageYOffset !== \"undefined\") ? window.pageYOffset : document.body.scrollTop;\n      // sum up offsets\n      node = elem;\n      do {\n        myX += node.offsetLeft;\n        myY += node.offsetTop;\n      } while (node = node.offsetParent);\n    }\n  }\n  return [myX, myY];\n}\n\n/*\n * position_popup\n *\n * Positions a popup relative to an anchor element.\n *\n * The avaliable positions are:\n * 0 - Centered below the anchor.\n */\nfunction position_popup(anchor, popup, position) {\n  \"use strict\";\n  var a_x, a_y, a_w, a_h, p_x, p_y, p_w, p_h;\n  var a_xy, spacer, margin, scrollbar, page_w;\n  // define constants\n  spacer = 5;\n  margin = 15;\n  scrollbar = 15;\n  // define the positions and widths\n  a_xy = coords(anchor);\n  a_x = a_xy[0];\n  a_y = a_xy[1];\n  a_w = anchor.offsetWidth;\n  a_h = anchor.offsetHeight;\n  p_w = popup.offsetWidth;\n  p_h = popup.offsetHeight;\n  page_w = null;\n  if (window.innerWidth) {\n    page_w = window.innerWidth;\n  } else if (document.body) {\n    page_w = document.body.clientWidth;\n  }\n  // check the position type is defined\n  if (typeof position !== \"number\") {\n    position = 0;\n  }\n  // calculate the popup position\n  switch (position) {\n    case 1:\n      p_x = a_x + a_w + spacer;\n      p_y = a_y + (a_h / 2) - (p_h / 2);\n      break;\n    case 0:\n    default:\n      p_x = a_x + (a_w / 2) - (p_w / 2);\n      p_y = a_y + a_h + spacer;\n      break;\n  }\n  // constrain the popup position\n  if (p_x < margin) {\n    p_x = margin;\n  } else if (page_w != null && (p_x + p_w) > (page_w - margin - scrollbar)) {\n    p_x = page_w - margin - scrollbar - p_w;\n  }\n  if (p_y < margin) {\n    p_y = margin;\n  }\n  // position the popup\n  popup.style.left = p_x + \"px\";\n  popup.style.top = p_y + \"px\";\n}\n\nfunction lookup_help_popup(popup_id) {\n  var _body, pop, info;\n  pop = document.getElementById(popup_id);\n  if (pop == null) {\n    _body = document.getElementsByTagName(\"body\")[0];\n    pop = document.createElement(\"div\");\n    pop.className = \"pop_content\";\n    pop.id = popup_id;\n    pop.style.backgroundColor = \"#FFC\";\n    pop.style.borderColor = \"black\";\n    info = document.createElement(\"p\");\n    info.style.fontWeight = \"bold\";\n    info.appendChild(document.createTextNode(\"Error: No popup for topic \\\"\" + popup_id + \"\\\".\"));\n    pop.appendChild(info);\n    // this might cause problems with the menu, but as this only happens\n    // when something is already wrong I don't think that's too much of a problem\n    _body.insertBefore(pop, _body.firstChild);\n  }\n  if (document.getElementsByTagName('body')[0].hasAttribute(\"data-autobtns\")) {\n    if (!/\\bauto_buttons\\b/.test(pop.className)) {\n      pop.className += \" auto_buttons\";\n      var back_btn_sec = document.createElement(\"div\");\n      back_btn_sec.className = \"nested_only pop_back_sec\";\n      var back_btn = document.createElement(\"span\");\n      back_btn.className = \"pop_back\";\n      back_btn.appendChild(document.createTextNode(\"<< back\"));\n      back_btn.addEventListener(\"click\", function(e) {\n        help_return();\n      }, false);\n      back_btn_sec.appendChild(back_btn);\n      pop.insertBefore(back_btn_sec, pop.firstChild);\n      var close_btn_sec = document.createElement(\"div\");\n      close_btn_sec.className = \"pop_close_sec\";\n      var close_btn = document.createElement(\"span\");\n      close_btn.className = \"pop_close\";\n      close_btn.appendChild(document.createTextNode(\"close\"));\n      close_btn.addEventListener(\"click\", function(e) {\n        help_popup();\n      }, false);\n      close_btn_sec.appendChild(close_btn);\n      pop.appendChild(close_btn_sec);\n    }\n  }\n  return pop;\n}\n\n/*\n * help_popup\n *\n * Moves around help pop-ups so they appear\n * below an activator.\n */\nfunction help_popup(activator, popup_id) {\n  \"use strict\";\n  var pop;\n  // set default values\n  if (typeof help_popup.popup === \"undefined\") {\n    help_popup.popup = [];\n  }\n  if (typeof help_popup.activator === \"undefined\") {\n    help_popup.activator = null;\n  }\n  var last_pop = (help_popup.popup.length > 0 ? help_popup.popup[help_popup.popup.length - 1] : null);\n  if (typeof(activator) == \"undefined\") { // no activator so hide\n    if (last_pop != null) {\n      last_pop.style.display = 'none';\n      help_popup.popup = [];\n    }\n    return;\n  }\n  pop = lookup_help_popup(popup_id);\n  if (pop == last_pop) {\n    if (activator == help_popup.activator) {\n      //hide popup (as we've already shown it for the current help button)\n      last_pop.style.display = 'none';\n      help_popup.popup = [];\n      return; // toggling complete!\n    }\n  } else if (last_pop != null) {\n    //activating different popup so hide current one\n    last_pop.style.display = 'none';\n  }\n  help_popup.popup = [pop];\n  help_popup.activator = activator;\n  toggle_class(pop, \"nested\", false);\n  //must make the popup visible to measure it or it has zero width\n  pop.style.display = 'block';\n  position_popup(activator, pop);\n}\n\n/*\n * help_refine\n * \n * Intended for links within a help popup. Stores a stack of state so\n * you can go back.\n */\nfunction help_refine(popup_id) {\n  if (help_popup.popup == null || help_popup.popup.length == 0 || help_popup.activator == null) {\n    throw new Error(\"Can not refine a help popup when one is not shown!\");\n  }\n  var pop = lookup_help_popup(popup_id);\n  var last_pop = help_popup.popup[help_popup.popup.length - 1];\n  if (pop == last_pop) return; // slightly odd, but no real cause for alarm\n  help_popup.popup.push(pop);\n  toggle_class(pop, \"nested\", true);\n  last_pop.style.display = \"none\";\n  //must make the popup visible to measure it or it has zero width\n  pop.style.display = \"block\";\n  position_popup(help_popup.activator, pop);\n}\n\n/*\n * help_return\n * \n * Intended for links within a help popup. Stores a stack of state so\n * you can go back.\n */\nfunction help_return() {\n  if (help_popup.popup == null || help_popup.popup.length == 0 || help_popup.activator == null) {\n    throw new Error(\"Can not return to a earlier help popup when one is not shown!\");\n  }\n  var last_pop = help_popup.popup.pop();\n  last_pop.style.display = \"none\";\n  var pop = (help_popup.popup.length > 0 ? help_popup.popup[help_popup.popup.length - 1] : null);\n  if (pop != null) {\n    toggle_class(pop, \"nested\", help_popup.popup.length > 1);\n    pop.style.display = \"block\";\n    position_popup(help_popup.activator, pop);\n  } else {\n    help_popup.activator = null;\n  }\n}\n\n/*\n * update_scroll_pad\n *\n * Creates padding at the bottom of the page to allow\n * scrolling of anything into view.\n */\nfunction update_scroll_pad() {\n  var page, pad;\n  page = (document.compatMode === \"CSS1Compat\") ? document.documentElement : document.body;\n  pad = $(\"scrollpad\");\n  if (pad === null) {\n    pad = document.createElement(\"div\");\n    pad.id = 'scrollpad';\n    document.getElementsByTagName('body')[0].appendChild(pad);\n  }\n  pad.style.height = Math.abs(page.clientHeight - 100) + \"px\";\n}\n\nfunction substitute_classes(node, remove, add) {\n  \"use strict\";\n  var list, all, i, cls, classes;\n  list = node.className.split(/\\s+/);\n  all = {};\n  for (i = 0; i < list.length; i++) {\n    if (list[i].length > 0) all[list[i]] = true;\n  }\n  for (i = 0; i < remove.length; i++) {\n    if (all.hasOwnProperty(remove[i])) {\n      delete all[remove[i]];\n    }\n  }\n  for (i = 0; i < add.length; i++) {\n    all[add[i]] = true;\n  }\n  classes = \"\";\n  for (cls in all) {\n    classes += cls + \" \";\n  }\n  node.className = classes;\n}\n\n/*\n * toggle_class\n *\n * Adds or removes a class from the node. If the parameter 'enabled' is not \n * passed then the existence of the class will be toggled, otherwise it will be\n * included if enabled is true.\n */\nfunction toggle_class(node, cls, enabled) {\n  var classes = node.className;\n  var list = classes.replace(/^\\s+/, '').replace(/\\s+$/, '').split(/\\s+/);\n  var found = false;\n  for (var i = 0; i < list.length; i++) {\n    if (list[i] == cls) {\n      list.splice(i, 1);\n      i--;\n      found = true;\n    }\n  }\n  if (typeof enabled == \"undefined\") {\n    if (!found) list.push(cls);\n  } else {\n    if (enabled) list.push(cls);\n  }\n  node.className = list.join(\" \");\n}\n\n/*\n * find_child\n *\n * Searches child nodes in depth first order and returns the first it finds\n * with the className specified.\n * TODO replace with querySelector\n */\nfunction find_child(node, className) {\n  var pattern;\n  if (node == null || typeof node !== \"object\") {\n    return null;\n  }\n  if (typeof className === \"string\") {\n    pattern = new RegExp(\"\\\\b\" + className + \"\\\\b\");\n  } else {\n    pattern = className;\n  }\n  if (node.nodeType == Node.ELEMENT_NODE && \n      pattern.test(node.className)) {\n    return node;\n  } else {\n    var result = null;\n    for (var i = 0; i < node.childNodes.length; i++) {\n      result = find_child(node.childNodes[i], pattern);\n      if (result != null) break;\n    }\n    return result;\n  }\n}\n\n/*\n * find_parent\n *\n * Searches parent nodes outwards from the node and returns the first it finds\n * with the className specified.\n */\nfunction find_parent(node, className) {\n  var pattern;\n  pattern = new RegExp(\"\\\\b\" + className + \"\\\\b\");\n  do {\n    if (node.nodeType == Node.ELEMENT_NODE && \n        pattern.test(node.className)) {\n      return node;\n    }\n  } while (node = node.parentNode);\n  return null;\n}\n\n/*\n * find_parent_tag\n *\n * Searches parent nodes outwards from the node and returns the first it finds\n * with the tag name specified. HTML tags should be specified in upper case.\n */\nfunction find_parent_tag(node, tag_name) {\n  do {\n    if (node.nodeType == Node.ELEMENT_NODE && node.tagName == tag_name) {\n      return node;\n    }\n  } while (node = node.parentNode);\n  return null;\n}\n\n/*\n * __toggle_help\n *\n * Uses the 'topic' property of the this object to\n * toggle display of a help topic.\n *\n * This function is not intended to be called directly.\n */\nfunction __toggle_help(e) {\n  if (!e) e = window.event;\n  if (e.type === \"keydown\") {\n    if (e.keyCode !== 13 && e.keyCode !== 32) {\n      return;\n    }\n    // stop a submit or something like that\n    e.preventDefault();\n  }\n\n  help_popup(this, this.getAttribute(\"data-topic\"));\n}\n\nfunction setup_help_button(button) {\n  \"use strict\";\n  var topic;\n  if (button.hasAttribute(\"data-topic\")) {\n    topic = button.getAttribute(\"data-topic\");\n    if (document.getElementById(topic) != null) {\n      button.tabIndex = \"0\"; // make keyboard selectable\n      button.addEventListener(\"click\", function() {\n        help_popup(button, topic);\n      }, false);\n      button.addEventListener(\"keydown\", function(e) {\n        // toggle only on Enter or Spacebar, let other keys do their thing\n        if (e.keyCode !== 13 && e.keyCode !== 32) return;\n        // stop a submit or something like that\n        e.preventDefault();\n        help_popup(button, topic);\n      }, false);\n    } else {\n      button.style.visibility = \"hidden\";\n    }\n  }\n  button.className += \" active\";\n}\n\n/*\n * help_button\n *\n * Makes a help button for the passed topic.\n */\nfunction help_button(topic) {\n  var btn = document.createElement(\"div\");\n  btn.className = \"help\";\n  btn.setAttribute(\"data-topic\", topic);\n  setup_help_button(btn);\n  return btn;\n}\n\n/*\n * prepare_download\n *\n * Sets the attributes of a link to setup a file download using the given content.\n * If no link is provided then create one and click it.\n */\nfunction prepare_download(content, mimetype, filename, link) {\n  \"use strict\";\n  // if no link is provided then create one and click it\n  var click_link = false;\n  if (!link) {\n    link = document.createElement(\"a\");\n    click_link = true;\n  }\n  try {\n    // Use a BLOB to convert the text into a data URL.\n    // We could do this manually with a base 64 conversion.\n    // This will only be supported on modern browsers,\n    // hence the try block.\n    var blob = new Blob([content], {type: mimetype});\n    var reader = new FileReader();\n    reader.onloadend = function() {\n      // If we're lucky the browser will also support the download\n      // attribute which will let us suggest a file name to save the link.\n      // Otherwise it is likely that the filename will be unintelligible. \n      link.setAttribute(\"download\", filename);\n      link.href = reader.result;\n      if (click_link) {\n        // must add the link to click it\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n      }\n    }\n    reader.readAsDataURL(blob);\n  } catch (error) {\n    if (console && console.log) console.log(error);\n    // probably an old browser\n    link.href = \"\";\n    link.visible = false;\n  }\n}\n\n/*\n * add_cell\n *\n * Add a cell to the table row.\n */\nfunction add_cell(row, node, cls, click_action) {\n  var cell = row.insertCell(row.cells.length);\n  if (node) cell.appendChild(node);\n  if (cls && cls !== \"\") cell.className = cls;\n  if (click_action) cell.addEventListener(\"click\", click_action, false);\n}\n\n/*\n * add_header_cell\n *\n * Add a header cell to the table row.\n */\nfunction add_header_cell(row, node, help_topic, cls, colspan) {\n  var th = document.createElement(\"th\");\n  if (node) th.appendChild(node);\n  if (help_topic && help_topic !== \"\") th.appendChild(help_button(help_topic));\n  if (cls && cls !== \"\") th.className = cls;\n  if (typeof colspan == \"number\" && colspan > 1) th.colSpan = colspan;\n  row.appendChild(th);\n}\n\n/*\n * add_text_cell\n *\n * Add a text cell to the table row.\n */\nfunction add_text_cell(row, text, cls, action) {\n  var node = null;\n  if (typeof(text) != 'undefined') node = document.createTextNode(text);\n  add_cell(row, node, cls, action);\n}\n\n/*\n * add_text_header_cell\n *\n * Add a text header cell to the table row.\n */\nfunction add_text_header_cell(row, text, help_topic, cls, action, colspan) {\n  var node = null;\n  if (typeof(text) != 'undefined') {\n    var nbsp = (help_topic ? \"\\u00A0\" : \"\");\n    var str = \"\" + text;\n    var parts = str.split(/\\n/);\n    if (parts.length === 1) {\n      if (action) {\n        node = document.createElement(\"span\");\n        node.appendChild(document.createTextNode(str + nbsp));\n      } else {\n        node = document.createTextNode(str + nbsp);\n      }\n    } else {\n      node = document.createElement(\"span\");\n      for (var i = 0; i < parts.length; i++) {\n        if (i !== 0) {\n          node.appendChild(document.createElement(\"br\"));\n        }\n        node.appendChild(document.createTextNode(parts[i]));\n      }\n    }\n    if (action) {\n      node.addEventListener(\"click\", action, false);\n      node.style.cursor = \"pointer\";\n    }\n  }\n  add_header_cell(row, node, help_topic, cls, colspan);\n}\n\nfunction setup_help() {\n  \"use strict\";\n  var help_buttons, i;\n  help_buttons = document.querySelectorAll(\".help:not(.active)\");\n  for (i = 0; i < help_buttons.length; i++) {\n    setup_help_button(help_buttons[i]);\n  }\n}\n\nfunction setup_scrollpad() {\n  \"use strict\";\n  if (document.getElementsByTagName('body')[0].hasAttribute(\"data-scrollpad\") && document.getElementById(\"scrollpad\") == null) {\n    window.addEventListener(\"resize\", update_scroll_pad, false);\n    update_scroll_pad();\n  }\n}\n\n// anon function to avoid polluting global scope\n(function() {\n  \"use strict\";\n  window.addEventListener(\"load\", function load(evt) {\n    window.removeEventListener(\"load\", load, false);\n    setup_help();\n    setup_scrollpad();\n  }, false);\n})();\n\n/*\n *  make_link\n *\n *  Creates a text node and if a URL is specified it surrounds it with a link.\n *  If the URL doesn't begin with \"http://\" it automatically adds it, as\n *  relative links don't make much sense in this context.\n */\nfunction make_link(text, url) {\n  var textNode = null;\n  var link = null;\n  if (typeof text !== \"undefined\" && text !== null) textNode = document.createTextNode(text);\n  if (typeof url === \"string\") {\n    if (url.indexOf(\"//\") == -1) {\n      url = \"http://\" + url;\n    }\n    link = document.createElement('a');\n    link.href = url;\n    if (textNode) link.appendChild(textNode);\n    return link;\n  }\n  return textNode;\n}\n</script>\n    <script>\nfunction motif_logo_template(inputs) {\n  function _input(name) {\n    if (typeof inputs[name] === \"undefined\") {\n      throw new Error(\"Missing template variable: \" + name);\n    }\n    return inputs[name];\n  }\n  return (\n\"%!PS-Adobe-3.0 EPSF-3.0\\n\" +\n\"%%Title: Sequence Logo : \" + _input(\"TITLE\") + \"\\n\" +\n\"%%Creator: \" + _input(\"CREATOR\") + \"\\n\" +\n\"%%CreationDate: \" + _input(\"CREATIONDATE\") + \"\\n\" +\n\"%%BoundingBox:   0  0  \" + _input(\"BOUNDINGWIDTH\") + \" \" + _input(\"BOUNDINGHEIGHT\") + \" \\n\" +\n\"%%Pages: 0\\n\" +\n\"%%DocumentFonts: \\n\" +\n\"%%EndComments\\n\" +\n\"\\n\" +\n\"% ---- CONSTANTS ----\\n\" +\n\"\\/cmfactor 72 2.54 div def % defines points -> cm conversion\\n\" +\n\"\\/cm {cmfactor mul} bind def % defines centimeters\\n\" +\n\"\\n\" +\n\"% ---- VARIABLES ----\\n\" +\n\"\\n\" +\n\"% NA = Nucleic Acid, AA = Amino Acid\\n\" +\n\"\\/logoType (\" + _input(\"LOGOTYPE\") + \") def \\n\" +\n\"\\n\" +\n\"\\/logoTitle (\" + _input(\"TITLE\") + \") def\\n\" +\n\"\\n\" +\n\"% Dimensions in cm\\n\" +\n\"\\/logoWidth \" + _input(\"LOGOWIDTH\") + \" cm def\\n\" +\n\"\\/logoHeight \" + _input(\"LOGOLINEHEIGHT\") + \" cm def\\n\" +\n\"\\/totalHeight \" + _input(\"LOGOHEIGHT\") + \" cm def\\n\" +\n\"\\n\" +\n\"\\/yaxis \" + _input(\"YAXIS\") + \" def\\n\" +\n\"\\/yaxisLabel (\" + _input(\"YAXISLABEL\") + \") def\\n\" +\n\"\\/yaxisBits  \" + _input(\"BARBITS\") + \" def % bits\\n\" +\n\"\\/yaxisTicBits \" + _input(\"TICBITS\") + \" def\\n\" +\n\"\\n\" +\n\"\\/xaxis \" + _input(\"NUMBERING\") + \" def\\n\" +\n\"\\/xaxisLabel (\" + _input(\"XAXISLABEL\") + \") def\\n\" +\n\"\\/showEnds (\" + _input(\"SHOWENDS\") + \") def \\n\" +\n\"\\n\" +\n\"\\/showFineprint true def\\n\" +\n\"\\/fineprint (\" + _input(\"FINEPRINT\") + \") def\\n\" +\n\"\\n\" +\n\"\\/charsPerLine \" + _input(\"CHARSPERLINE\") + \" def\\n\" +\n\"\\n\" +\n\"\\/showingBox \" + _input(\"SHOWINGBOX\") + \" def    \\n\" +\n\"\\/shrinking false def   % true falses\\n\" +\n\"\\/shrink  1.0 def\\n\" +\n\"\\/outline \" + _input(\"OUTLINE\") + \" def\\n\" +\n\"\\n\" +\n\"\\/IbeamFraction  \" + _input(\"ERRORBARFRACTION\") + \" def\\n\" +\n\"\\/IbeamGray      0.50 def\\n\" +\n\"\\/IbeamLineWidth 0.5 def\\n\" +\n\"\\n\" +\n\"\\/fontsize       \" + _input(\"FONTSIZE\") + \" def\\n\" +\n\"\\/titleFontsize  \" + _input(\"TITLEFONTSIZE\") + \" def\\n\" +\n\"\\/smallFontsize  \" + _input(\"SMALLFONTSIZE\") + \" def\\n\" +\n\"\\n\" +\n\"\\/topMargin      \" + _input(\"TOPMARGIN\") + \" cm def\\n\" +\n\"\\/bottomMargin   \" + _input(\"BOTTOMMARGIN\") + \" cm def\\n\" +\n\"\\n\" +\n\"\\/defaultColor [0 0 0] def \\n\" +\n\"\\n\" +\n_input(\"COLORDICT\") + \"\\n\" +\n\"\\n\" +\n\"\\/colorDict fullColourDict def\\n\" +\n\"\\n\" +\n\"% ---- DERIVED PARAMETERS ----\\n\" +\n\"\\n\" +\n\"\\/leftMargin\\n\" +\n\"  fontsize 3.5 mul\\n\" +\n\"\\n\" +\n\"def \\n\" +\n\"\\n\" +\n\"\\/rightMargin \\n\" +\n\"  %Add extra room if showing ends\\n\" +\n\"  showEnds (false) eq { fontsize}{fontsize 1.5 mul} ifelse\\n\" +\n\"def\\n\" +\n\"\\n\" +\n\"\\/yaxisHeight \\n\" +\n\"  logoHeight \\n\" +\n\"  bottomMargin sub  \\n\" +\n\"  topMargin sub\\n\" +\n\"def\\n\" +\n\"\\n\" +\n\"\\/ticWidth fontsize 2 div def\\n\" +\n\"\\n\" +\n\"\\/pointsPerBit yaxisHeight yaxisBits div  def\\n\" +\n\"\\n\" +\n\"\\/stackMargin 1 def\\n\" +\n\"\\n\" +\n\"% Do not add space aroung characters if characters are boxed\\n\" +\n\"\\/charRightMargin \\n\" +\n\"  showingBox { 0.0 } {stackMargin} ifelse\\n\" +\n\"def\\n\" +\n\"\\n\" +\n\"\\/charTopMargin \\n\" +\n\"  showingBox { 0.0 } {stackMargin} ifelse\\n\" +\n\"def\\n\" +\n\"\\n\" +\n\"\\/charWidth\\n\" +\n\"  logoWidth\\n\" +\n\"  leftMargin sub\\n\" +\n\"  rightMargin sub\\n\" +\n\"  charsPerLine div\\n\" +\n\"  charRightMargin sub\\n\" +\n\"def\\n\" +\n\"\\n\" +\n\"\\/charWidth4 charWidth 4 div def\\n\" +\n\"\\/charWidth2 charWidth 2 div def\\n\" +\n\"\\n\" +\n\"\\/stackWidth \\n\" +\n\"  charWidth charRightMargin add\\n\" +\n\"def\\n\" +\n\" \\n\" +\n\"\\/numberFontsize \\n\" +\n\"  fontsize charWidth lt {fontsize}{charWidth} ifelse\\n\" +\n\"def\\n\" +\n\"\\n\" +\n\"% movements to place 5'\\/N and 3'\\/C symbols\\n\" +\n\"\\/leftEndDeltaX  fontsize neg         def\\n\" +\n\"\\/leftEndDeltaY  fontsize 1.5 mul neg def\\n\" +\n\"\\/rightEndDeltaX fontsize 0.25 mul     def\\n\" +\n\"\\/rightEndDeltaY leftEndDeltaY        def\\n\" +\n\"\\n\" +\n\"% Outline width is proporional to charWidth, \\n\" +\n\"% but no less that 1 point\\n\" +\n\"\\/outlinewidth \\n\" +\n\"  charWidth 32 div dup 1 gt  {}{pop 1} ifelse\\n\" +\n\"def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"% ---- PROCEDURES ----\\n\" +\n\"\\n\" +\n\"\\/StartLogo { \\n\" +\n\"  % Save state\\n\" +\n\"  save \\n\" +\n\"  gsave \\n\" +\n\"\\n\" +\n\"  % Print Logo Title, top center \\n\" +\n\"  gsave \\n\" +\n\"    SetStringFont\\n\" +\n\"\\n\" +\n\"    logoWidth 2 div\\n\" +\n\"    logoTitle\\n\" +\n\"    stringwidth pop 2 div sub\\n\" +\n\"    totalHeight\\n\" +\n\"    titleFontsize sub\\n\" +\n\"    moveto\\n\" +\n\"\\n\" +\n\"    logoTitle\\n\" +\n\"    show\\n\" +\n\"  grestore\\n\" +\n\"\\n\" +\n\"  % Print X-axis label, bottom center\\n\" +\n\"  gsave\\n\" +\n\"    SetStringFont\\n\" +\n\"\\n\" +\n\"    logoWidth 2 div\\n\" +\n\"    xaxisLabel\\n\" +\n\"    stringwidth pop 2 div sub\\n\" +\n\"    0\\n\" +\n\"    titleFontsize 3 div\\n\" +\n\"    add\\n\" +\n\"    moveto\\n\" +\n\"\\n\" +\n\"    xaxisLabel\\n\" +\n\"    show\\n\" +\n\"  grestore\\n\" +\n\"\\n\" +\n\"  % Show Fine Print\\n\" +\n\"  showFineprint {\\n\" +\n\"    gsave\\n\" +\n\"      SetSmallFont\\n\" +\n\"      logoWidth\\n\" +\n\"        fineprint stringwidth pop sub\\n\" +\n\"        smallFontsize sub\\n\" +\n\"          smallFontsize 3 div\\n\" +\n\"      moveto\\n\" +\n\"    \\n\" +\n\"      fineprint show\\n\" +\n\"    grestore\\n\" +\n\"  } if\\n\" +\n\"\\n\" +\n\"  % Move to lower left corner of last line, first stack\\n\" +\n\"  leftMargin bottomMargin translate\\n\" +\n\"\\n\" +\n\"  % Move above first line ready for StartLine \\n\" +\n\"  0 totalHeight translate\\n\" +\n\"\\n\" +\n\"  SetLogoFont\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\/EndLogo { \\n\" +\n\"  grestore \\n\" +\n\"  showpage \\n\" +\n\"  restore \\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/StartLine { \\n\" +\n\"  % move down to the bottom of the line:\\n\" +\n\"  0 logoHeight neg translate\\n\" +\n\"  \\n\" +\n\"  gsave \\n\" +\n\"    yaxis { MakeYaxis } if\\n\" +\n\"    xaxis { showEnds (true) eq {ShowLeftEnd} if } if\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\/EndLine{ \\n\" +\n\"    xaxis { showEnds (true) eq {ShowRightEnd} if } if\\n\" +\n\"  grestore \\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/MakeYaxis {\\n\" +\n\"  gsave    \\n\" +\n\"    stackMargin neg 0 translate\\n\" +\n\"    ShowYaxisBar\\n\" +\n\"    ShowYaxisLabel\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/ShowYaxisBar { \\n\" +\n\"  gsave  \\n\" +\n\"    SetStringFont\\n\" +\n\"\\n\" +\n\"    \\/str 10 string def % string to hold number  \\n\" +\n\"    \\/smallgap stackMargin 2 div def\\n\" +\n\"\\n\" +\n\"    % Draw first tic and bar\\n\" +\n\"    gsave    \\n\" +\n\"      ticWidth neg 0 moveto \\n\" +\n\"      ticWidth 0 rlineto \\n\" +\n\"      0 yaxisHeight rlineto\\n\" +\n\"      stroke\\n\" +\n\"    grestore\\n\" +\n\"\\n\" +\n\"   \\n\" +\n\"    % Draw the tics\\n\" +\n\"    % initial increment limit proc for\\n\" +\n\"    0 yaxisTicBits yaxisBits abs %cvi\\n\" +\n\"    {\\/loopnumber exch def\\n\" +\n\"\\n\" +\n\"      % convert the number coming from the loop to a string\\n\" +\n\"      % and find its width\\n\" +\n\"      loopnumber 10 str cvrs\\n\" +\n\"      \\/stringnumber exch def % string representing the number\\n\" +\n\"\\n\" +\n\"      stringnumber stringwidth pop\\n\" +\n\"      \\/numberwidth exch def % width of number to show\\n\" +\n\"\\n\" +\n\"      \\/halfnumberheight\\n\" +\n\"         stringnumber CharBoxHeight 2 div\\n\" +\n\"      def\\n\" +\n\"\\n\" +\n\"      numberwidth % move back width of number\\n\" +\n\"      neg loopnumber pointsPerBit mul % shift on y axis\\n\" +\n\"      halfnumberheight sub % down half the digit\\n\" +\n\"\\n\" +\n\"      moveto % move back the width of the string\\n\" +\n\"\\n\" +\n\"      ticWidth neg smallgap sub % Move back a bit more  \\n\" +\n\"      0 rmoveto % move back the width of the tic  \\n\" +\n\"\\n\" +\n\"      stringnumber show\\n\" +\n\"      smallgap 0 rmoveto % Make a small gap  \\n\" +\n\"\\n\" +\n\"      % now show the tic mark\\n\" +\n\"      0 halfnumberheight rmoveto % shift up again\\n\" +\n\"      ticWidth 0 rlineto\\n\" +\n\"      stroke\\n\" +\n\"    } for\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\/ShowYaxisLabel {\\n\" +\n\"  gsave\\n\" +\n\"    SetStringFont\\n\" +\n\"\\n\" +\n\"    % How far we move left depends on the size of\\n\" +\n\"    % the tic labels.\\n\" +\n\"    \\/str 10 string def % string to hold number  \\n\" +\n\"    yaxisBits yaxisTicBits div cvi yaxisTicBits mul \\n\" +\n\"    str cvs stringwidth pop\\n\" +\n\"    ticWidth 1.5 mul  add neg  \\n\" +\n\"\\n\" +\n\"\\n\" +\n\"    yaxisHeight\\n\" +\n\"    yaxisLabel stringwidth pop\\n\" +\n\"    sub 2 div\\n\" +\n\"\\n\" +\n\"    translate\\n\" +\n\"    90 rotate\\n\" +\n\"    0 0 moveto\\n\" +\n\"    yaxisLabel show\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/StartStack {  % <stackNumber> startstack\\n\" +\n\"  xaxis {MakeNumber}{pop} ifelse\\n\" +\n\"  gsave\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\/EndStack {\\n\" +\n\"  grestore\\n\" +\n\"  stackWidth 0 translate\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"% Draw a character whose height is proportional to symbol bits\\n\" +\n\"\\/MakeSymbol{ % charbits character MakeSymbol\\n\" +\n\"  gsave\\n\" +\n\"    \\/char exch def\\n\" +\n\"    \\/bits exch def\\n\" +\n\"\\n\" +\n\"    \\/bitsHeight \\n\" +\n\"       bits pointsPerBit mul \\n\" +\n\"    def\\n\" +\n\"\\n\" +\n\"    \\/charHeight \\n\" +\n\"       bitsHeight charTopMargin sub\\n\" +\n\"       dup \\n\" +\n\"       0.0 gt {}{pop 0.0} ifelse % if neg replace with zero \\n\" +\n\"    def \\n\" +\n\" \\n\" +\n\"    charHeight 0.0 gt {\\n\" +\n\"      char SetColor\\n\" +\n\"      charWidth charHeight char ShowChar\\n\" +\n\"\\n\" +\n\"      showingBox { % Unfilled box\\n\" +\n\"        0 0 charWidth charHeight false ShowBox\\n\" +\n\"      } if\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"    } if\\n\" +\n\"\\n\" +\n\"  grestore\\n\" +\n\"\\n\" +\n\"  0 bitsHeight translate \\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/ShowChar { % <width> <height> <char> ShowChar\\n\" +\n\"  gsave\\n\" +\n\"    \\/tc exch def    % The character\\n\" +\n\"    \\/ysize exch def % the y size of the character\\n\" +\n\"    \\/xsize exch def % the x size of the character\\n\" +\n\"\\n\" +\n\"    \\/xmulfactor 1 def \\n\" +\n\"    \\/ymulfactor 1 def\\n\" +\n\"    \\/limmulfactor 0.01 def\\n\" +\n\"    \\/drawable true def\\n\" +\n\"\\n\" +\n\"  \\n\" +\n\"    % if ysize is negative, make everything upside down!\\n\" +\n\"    ysize 0 lt {\\n\" +\n\"      % put ysize normal in this orientation\\n\" +\n\"      \\/ysize ysize abs def\\n\" +\n\"      xsize ysize translate\\n\" +\n\"      180 rotate\\n\" +\n\"    } if\\n\" +\n\"\\n\" +\n\"    shrinking {\\n\" +\n\"      xsize 1 shrink sub 2 div mul\\n\" +\n\"        ysize 1 shrink sub 2 div mul translate \\n\" +\n\"\\n\" +\n\"      shrink shrink scale\\n\" +\n\"    } if\\n\" +\n\"\\n\" +\n\"    % Calculate the font scaling factors\\n\" +\n\"    % Loop twice to catch small correction due to first scaling\\n\" +\n\"    2 {\\n\" +\n\"      gsave\\n\" +\n\"        xmulfactor ymulfactor scale\\n\" +\n\"      \\n\" +\n\"        ysize % desired size of character in points\\n\" +\n\"        tc CharBoxHeight \\n\" +\n\"        dup 0.0 ne {\\n\" +\n\"          div % factor by which to scale up the character\\n\" +\n\"          \\/ymulfactor exch def\\n\" +\n\"        } % end if\\n\" +\n\"        {pop pop}\\n\" +\n\"        ifelse\\n\" +\n\"\\n\" +\n\"        xsize % desired size of character in points\\n\" +\n\"        tc CharBoxWidth  \\n\" +\n\"        dup 0.0 ne {\\n\" +\n\"          div % factor by which to scale up the character\\n\" +\n\"          \\/xmulfactor exch def\\n\" +\n\"        } % end if\\n\" +\n\"        {pop pop}\\n\" +\n\"        ifelse\\n\" +\n\"      grestore\\n\" +\n\"      % if the multiplication factors get too small we need to avoid a crash\\n\" +\n\"      xmulfactor limmulfactor lt {\\n\" +\n\"        \\/xmulfactor 1 def\\n\" +\n\"        \\/drawable false def\\n\" +\n\"      } if\\n\" +\n\"      ymulfactor limmulfactor lt {\\n\" +\n\"        \\/ymulfactor 1 def\\n\" +\n\"        \\/drawable false def\\n\" +\n\"      } if\\n\" +\n\"    } repeat\\n\" +\n\"\\n\" +\n\"    % Adjust horizontal position if the symbol is an I\\n\" +\n\"    tc (I) eq {\\n\" +\n\"      charWidth 2 div % half of requested character width\\n\" +\n\"      tc CharBoxWidth 2 div % half of the actual character\\n\" +\n\"      sub 0 translate\\n\" +\n\"      % Avoid x scaling for I \\n\" +\n\"      \\/xmulfactor 1 def \\n\" +\n\"    } if\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"    % ---- Finally, draw the character\\n\" +\n\"    drawable { \\n\" +\n\"      newpath\\n\" +\n\"      xmulfactor ymulfactor scale\\n\" +\n\"\\n\" +\n\"      % Move lower left corner of character to start point\\n\" +\n\"      tc CharBox pop pop % llx lly : Lower left corner\\n\" +\n\"      exch neg exch neg\\n\" +\n\"      moveto\\n\" +\n\"\\n\" +\n\"      outline {  % outline characters:\\n\" +\n\"        outlinewidth setlinewidth\\n\" +\n\"        tc true charpath\\n\" +\n\"        gsave 1 setgray fill grestore\\n\" +\n\"        clip stroke\\n\" +\n\"      } { % regular characters\\n\" +\n\"        tc show\\n\" +\n\"      } ifelse\\n\" +\n\"    } if\\n\" +\n\"\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/ShowBox { % x1 y1 x2 y2 filled ShowBox\\n\" +\n\"  gsave\\n\" +\n\"    \\/filled exch def \\n\" +\n\"    \\/y2 exch def\\n\" +\n\"    \\/x2 exch def\\n\" +\n\"    \\/y1 exch def\\n\" +\n\"    \\/x1 exch def\\n\" +\n\"    newpath\\n\" +\n\"    x1 y1 moveto\\n\" +\n\"    x2 y1 lineto\\n\" +\n\"    x2 y2 lineto\\n\" +\n\"    x1 y2 lineto\\n\" +\n\"    closepath\\n\" +\n\"\\n\" +\n\"    clip\\n\" +\n\"    \\n\" +\n\"    filled {\\n\" +\n\"      fill\\n\" +\n\"    }{ \\n\" +\n\"      0 setgray stroke   \\n\" +\n\"    } ifelse\\n\" +\n\"\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/MakeNumber { % number MakeNumber\\n\" +\n\"  gsave\\n\" +\n\"    SetNumberFont\\n\" +\n\"    stackWidth 0 translate\\n\" +\n\"    90 rotate % rotate so the number fits\\n\" +\n\"    dup stringwidth pop % find the length of the number\\n\" +\n\"    neg % prepare for move\\n\" +\n\"    stackMargin sub % Move back a bit\\n\" +\n\"    charWidth (0) CharBoxHeight % height of numbers\\n\" +\n\"    sub 2 div %\\n\" +\n\"    moveto % move back to provide space\\n\" +\n\"    show\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/Ibeam{ % heightInBits Ibeam\\n\" +\n\"  gsave\\n\" +\n\"    % Make an Ibeam of twice the given height in bits\\n\" +\n\"    \\/height exch  pointsPerBit mul def \\n\" +\n\"    \\/heightDRAW height IbeamFraction mul def\\n\" +\n\"\\n\" +\n\"    IbeamLineWidth setlinewidth\\n\" +\n\"    IbeamGray setgray \\n\" +\n\"\\n\" +\n\"    charWidth2 height neg translate\\n\" +\n\"    ShowIbar\\n\" +\n\"    newpath\\n\" +\n\"      0 0 moveto\\n\" +\n\"      0 heightDRAW rlineto\\n\" +\n\"    stroke\\n\" +\n\"    newpath\\n\" +\n\"      0 height moveto\\n\" +\n\"      0 height rmoveto\\n\" +\n\"      currentpoint translate\\n\" +\n\"    ShowIbar\\n\" +\n\"    newpath\\n\" +\n\"    0 0 moveto\\n\" +\n\"    0 heightDRAW neg rlineto\\n\" +\n\"    currentpoint translate\\n\" +\n\"    stroke\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/ShowIbar { % make a horizontal bar\\n\" +\n\"  gsave\\n\" +\n\"    newpath\\n\" +\n\"      charWidth4 neg 0 moveto\\n\" +\n\"      charWidth4 0 lineto\\n\" +\n\"    stroke\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/ShowLeftEnd {\\n\" +\n\"  gsave\\n\" +\n\"    SetStringFont\\n\" +\n\"    leftEndDeltaX leftEndDeltaY moveto\\n\" +\n\"    logoType (NA) eq {(5) show ShowPrime} if\\n\" +\n\"    logoType (AA) eq {(N) show} if\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/ShowRightEnd { \\n\" +\n\"  gsave\\n\" +\n\"    SetStringFont\\n\" +\n\"    rightEndDeltaX rightEndDeltaY moveto\\n\" +\n\"    logoType (NA) eq {(3) show ShowPrime} if\\n\" +\n\"    logoType (AA) eq {(C) show} if\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"\\/ShowPrime {\\n\" +\n\"  gsave\\n\" +\n\"    SetPrimeFont\\n\" +\n\"    (\\\\242) show \\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\" \\n\" +\n\"\\/SetColor{ % <char> SetColor\\n\" +\n\"  dup colorDict exch known {\\n\" +\n\"    colorDict exch get aload pop setrgbcolor\\n\" +\n\"  } {\\n\" +\n\"    pop\\n\" +\n\"    defaultColor aload pop setrgbcolor\\n\" +\n\"  } ifelse \\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"% define fonts\\n\" +\n\"\\/SetTitleFont {\\/Times-Bold findfont titleFontsize scalefont setfont} bind def\\n\" +\n\"\\/SetLogoFont  {\\/Helvetica-Bold findfont charWidth  scalefont setfont} bind def\\n\" +\n\"\\/SetStringFont{\\/Helvetica-Bold findfont fontsize scalefont setfont} bind def\\n\" +\n\"\\/SetPrimeFont {\\/Symbol findfont fontsize scalefont setfont} bind def\\n\" +\n\"\\/SetSmallFont {\\/Helvetica findfont smallFontsize scalefont setfont} bind def\\n\" +\n\"\\n\" +\n\"\\/SetNumberFont {\\n\" +\n\"    \\/Helvetica-Bold findfont \\n\" +\n\"    numberFontsize\\n\" +\n\"    scalefont\\n\" +\n\"    setfont\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"%Take a single character and return the bounding box\\n\" +\n\"\\/CharBox { % <char> CharBox <lx> <ly> <ux> <uy>\\n\" +\n\"  gsave\\n\" +\n\"    newpath\\n\" +\n\"    0 0 moveto\\n\" +\n\"    % take the character off the stack and use it here:\\n\" +\n\"    true charpath \\n\" +\n\"    flattenpath \\n\" +\n\"    pathbbox % compute bounding box of 1 pt. char => lx ly ux uy\\n\" +\n\"    % the path is here, but toss it away ...\\n\" +\n\"  grestore\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"% The height of a characters bounding box\\n\" +\n\"\\/CharBoxHeight { % <char> CharBoxHeight <num>\\n\" +\n\"  CharBox\\n\" +\n\"  exch pop sub neg exch pop\\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"% The width of a characters bounding box\\n\" +\n\"\\/CharBoxWidth { % <char> CharBoxHeight <num>\\n\" +\n\"  CharBox\\n\" +\n\"  pop exch pop sub neg \\n\" +\n\"} bind def\\n\" +\n\"\\n\" +\n\"% Set the colour scheme to be faded to indicate trimming\\n\" +\n\"\\/MuteColour {\\n\" +\n\"  \\/colorDict mutedColourDict def\\n\" +\n\"} def\\n\" +\n\"\\n\" +\n\"% Restore the colour scheme to the normal colours\\n\" +\n\"\\/RestoreColour {\\n\" +\n\"  \\/colorDict fullColourDict def\\n\" +\n\"} def\\n\" +\n\"\\n\" +\n\"% Draw the background for a trimmed section\\n\" +\n\"% takes the number of columns as a parameter\\n\" +\n\"\\/DrawTrimBg { % <num> DrawTrimBox\\n\" +\n\"  \\/col exch def\\n\" +\n\"  \\n\" +\n\"  \\/boxwidth \\n\" +\n\"    col stackWidth mul \\n\" +\n\"  def\\n\" +\n\" \\n\" +\n\"  gsave\\n\" +\n\"    0.97 setgray\\n\" +\n\"\\n\" +\n\"    newpath\\n\" +\n\"    0 0 moveto\\n\" +\n\"    boxwidth 0 rlineto\\n\" +\n\"    0 yaxisHeight rlineto\\n\" +\n\"    0 yaxisHeight lineto\\n\" +\n\"    closepath\\n\" +\n\"    \\n\" +\n\"    fill\\n\" +\n\"  grestore\\n\" +\n\"} def\\n\" +\n\"\\n\" +\n\"\\/DrawTrimEdge {\\n\" +\n\"  gsave\\n\" +\n\"    0.2 setgray\\n\" +\n\"    [2] 0 setdash\\n\" +\n\"\\n\" +\n\"    newpath\\n\" +\n\"    0 0 moveto\\n\" +\n\"    0 yaxisHeight lineto\\n\" +\n\"    \\n\" +\n\"    stroke\\n\" +\n\"\\n\" +\n\"} def\\n\" +\n\"\\n\" +\n\"\\n\" +\n\"% Deprecated names\\n\" +\n\"\\/startstack {StartStack} bind  def\\n\" +\n\"\\/endstack {EndStack}     bind def\\n\" +\n\"\\/makenumber {MakeNumber} bind def\\n\" +\n\"\\/numchar { MakeSymbol }  bind def\\n\" +\n\"\\n\" +\n\"%%EndProlog\\n\" +\n\"\\n\" +\n\"%%Page: 1 1\\n\" +\n\"StartLogo\\n\" +\n\"\\n\" +\n_input(\"DATA\") + \"\\n\" +\n\"\\n\" +\n\"EndLogo\\n\" +\n\"\\n\" +\n\"%%EOF\\n\"\n  );\n}</script>\n    <script>\n//======================================================================\n// start Alphabet object\n//======================================================================\nvar Alphabet = function(alphabet, background) {\n  \"use strict\";\n  var i, j, sym, aliases, complement, comp_e_sym, ambigs, generate_background;\n  generate_background = (background == null);\n  if (generate_background) {\n    background = [];\n    for (i = 0; i < alphabet.ncore; i++) background[i] = 1.0 / alphabet.ncore;\n  } else if (alphabet.ncore != background.length) {\n    throw new Error(\"The background length does not match the alphabet length.\");\n  }\n  this.name = alphabet.name;\n  this.like = (alphabet.like != null ? alphabet.like.toUpperCase() : null);\n  this.ncore = alphabet.ncore;\n  this.symbols = alphabet.symbols;\n  this.background = background;\n  this.genbg = generate_background;\n  this.encode = {};\n  this.encode2core = {};\n  this.complement = {};\n  // check if all symbols are same case\n  var seen_uc = false;\n  var seen_lc = false;\n  var check_case = function (syms) {\n    var s, sym;\n    if (typeof syms === \"string\") {\n      for (s = 0; s < syms.length; s++) {\n        sym = syms.charAt(s);\n        if (sym >= 'a' && sym <= 'z') seen_lc = true;\n        else if (sym >= 'A' && sym <= 'Z') seen_uc = true;\n      }\n    }\n  };\n  for (i = 0; i < this.symbols.length; i++) {\n    check_case(this.symbols[i].symbol);\n    check_case(this.symbols[i].aliases);\n  }\n  // now map symbols to indexes\n  var update_array = function(array, syms, index) {\n    var s, sym;\n    if (typeof syms === \"string\") {\n      for (s = 0; s < syms.length; s++) {\n        sym = syms.charAt(s);\n        array[sym] = index;\n        // when only a single case is used, then encode as case insensitive\n        if (seen_uc != seen_lc) {\n          if (sym >= 'a' && sym <= 'z') {\n            array[sym.toUpperCase()] = index;\n          } else if (sym >= 'A' && sym <= 'Z') {\n            array[sym.toLowerCase()] = index;\n          }\n        }\n      }\n    }\n  }\n  // map core symbols to index\n  for (i = 0; i < this.ncore; i++) {\n    update_array(this.encode2core, this.symbols[i].symbol, i);\n    update_array(this.encode, this.symbols[i].symbol, i);\n    update_array(this.encode2core, this.symbols[i].aliases, i);\n    update_array(this.encode, this.symbols[i].aliases, i);\n  }\n  // map ambigous symbols to index\n  ambigs = {};\n  for (i = this.ncore; i < this.symbols.length; i++) {\n    update_array(this.encode, this.symbols[i].symbol, i);\n    update_array(this.encode, this.symbols[i].aliases, i);\n    ambigs[this.symbols[i].equals] = i;\n  }\n  // determine complements\n  for (i = 0; i < this.ncore; i++) {\n    complement = this.symbols[i].complement;\n    if (typeof complement === \"string\") {\n      this.complement[i] = this.encode2core[complement];\n    }\n  }\n  next_symbol:\n  for (i = this.ncore; i < this.symbols.length; i++) {\n    complement = \"\";\n    for (j = 0; j < this.symbols[i].equals.length; j++) {\n      comp_e_sym = this.complement[this.encode2core[this.symbols[i].equals.charAt(j)]];\n      if (typeof comp_e_sym !== \"number\") continue next_symbol;\n      complement += this.symbols[comp_e_sym].symbol;\n    }\n    complement = complement.split(\"\").sort().join(\"\");\n    if (typeof ambigs[complement] === \"number\") {\n      this.complement[i] = ambigs[complement];\n    }\n  }\n  // determine case insensitivity\n  this.case_insensitive = true;\n  if (seen_uc == seen_lc) {\n    // when there is a mixture of cases it probably won't\n    // be case insensitive but we still need to check\n    loop:\n    for (i = 0; i < this.symbols.length; i++) {\n      sym = this.symbols[i].symbol;\n      if (sym >= 'A' && sym <= 'Z') {\n        if (this.encode[sym.toLowerCase()] != i) {\n          this.case_insensitive = false;\n          break loop;\n        }\n      } else if (sym >= 'a' && sym <= 'z') {\n        if (this.encode[sym.toUpperCase()] != i) {\n          this.case_insensitive = false;\n          break loop;\n        }\n      }\n      aliases = this.symbols[i].aliases;\n      if (aliases != null) {\n        for (j = 0; j < aliases.length; j++) {\n          sym = aliases.charAt(j);\n          if (sym >= 'A' && sym <= 'Z') {\n            if (this.encode[sym.toLowerCase()] != i) {\n              this.case_insensitive = false;\n              break loop;\n            }\n          } else if (sym >= 'a' && sym <= 'z') {\n            if (this.encode[sym.toUpperCase()] != i) {\n              this.case_insensitive = false;\n              break loop;\n            }\n          }\n        }\n      }\n    }\n  }\n  // normalise aliases to remove the prime symbol and eliminate\n  // the alternate cases when the alphabet is case insensitive\n  var seen, out;\n  for (i = 0; i < this.symbols.length; i++) {\n    sym = this.symbols[i].symbol;\n    aliases = this.symbols[i].aliases;\n    if (typeof aliases != \"string\") aliases = \"\";\n    seen = {};\n    out = [];\n    if (this.case_insensitive) {\n      sym = sym.toUpperCase();\n      aliases = aliases.toUpperCase();\n    }\n    seen[sym] = true;\n    for (j = 0; j < aliases.length; j++) {\n      if (!seen[aliases.charAt(j)]) {\n        seen[aliases.charAt(j)] = true;\n        out.push(aliases.charAt(j));\n      }\n    }\n    this.symbols[i].aliases = out.sort().join(\"\");\n  }\n};\n// return the name of the alphabet\nAlphabet.prototype.get_alphabet_name = function() {\n  return this.name;\n};\n// return if the alphabet can be complemented\nAlphabet.prototype.has_complement = function() {\n  return (typeof this.symbols[0].complement === \"string\");\n};\n// return true if an uppercase letter has the same meaning as the lowercase form\nAlphabet.prototype.is_case_insensitive = function() {\n  return this.case_insensitive;\n};\n// return the information content of an alphabet letter\nAlphabet.prototype.get_ic = function() {\n  return Math.log(this.ncore) / Math.LN2;\n};\n// return the count of the core alphabet symbols\nAlphabet.prototype.get_size_core = function() {\n  return this.ncore;\n};\n// return the count of all alphabet symbols\nAlphabet.prototype.get_size_full = function() {\n  return this.symbols.length;\n};\n// return the symbol for the given alphabet index\nAlphabet.prototype.get_symbol = function(alph_index) {\n  \"use strict\";\n  if (alph_index < 0 || alph_index >= this.symbols.length) {\n    throw new Error(\"Alphabet index out of bounds\");\n  }\n  return this.symbols[alph_index].symbol;\n};\n// return the aliases for the given alphabet index\nAlphabet.prototype.get_aliases = function(alph_index) {\n  \"use strict\";\n  if (alph_index < 0 || alph_index >= this.symbols.length) {\n    throw new Error(\"Alphabet index out of bounds\");\n  }\n  var sym_obj = this.symbols[alph_index];\n  return (sym_obj.aliases != null ? sym_obj.aliases : \"\");\n};\n// return the name for the given alphabet index\nAlphabet.prototype.get_name = function(alph_index) {\n  \"use strict\";\n  var sym;\n  if (alph_index < 0 || alph_index >= this.symbols.length) {\n    throw new Error(\"Alphabet index out of bounds\");\n  }\n  sym = this.symbols[alph_index];\n  return (typeof sym.name === \"string\" ? sym.name : sym.symbol);\n};\n// return the alphabet it is like or null\nAlphabet.prototype.get_like = function() {\n  \"use strict\";\n  return this.like;\n};\n// return the index of the complement for the given alphabet index\nAlphabet.prototype.get_complement = function(alph_index) {\n  var comp_e_sym = this.complement[alph_index];\n  if (typeof comp_e_sym === \"number\") {\n    return comp_e_sym;\n  } else {\n    return -1;\n  }\n};\n// return a string containing the core symbols\nAlphabet.prototype.get_symbols = function() {\n  \"use strict\";\n  var i, core_symbols;\n  core_symbols = \"\";\n  for (i = 0; i < this.ncore; i++) {\n    core_symbols += this.symbols[i].symbol;\n  }\n  return core_symbols;\n};\n// return if the background was not a uniform generated background\nAlphabet.prototype.has_bg = function() {\n  \"use strict\";\n  return !this.genbg;\n};\n// get the background frequency for the index\nAlphabet.prototype.get_bg_freq = function(alph_index) {\n  \"use strict\";\n  var freq, i, symbols;\n  if (alph_index >= 0) {\n    if (alph_index < this.ncore) {\n      return this.background[alph_index];\n    } else if (alph_index < this.symbols.length) {\n      freq = 0;\n      symbols = this.symbols[alph_index].equals;\n      for (i = 0; i < symbols.length; i++) {\n        freq += this.background[this.encode2core[symbols.charAt(i)]];\n      }\n      return freq;\n    } \n  }\n  throw new Error(\"The alphabet index is out of range.\");\n};\n// get the colour of the index\nAlphabet.prototype.get_colour = function(alph_index) {\n  \"use strict\";\n  if (alph_index < 0 || alph_index >= this.symbols.length) {\n    throw new Error(\"BAD_ALPHABET_INDEX\");\n  }\n  if (typeof this.symbols[alph_index].colour != \"string\") {\n    return \"black\";\n  }\n  return \"#\" + this.symbols[alph_index].colour;\n};\n// get the rgb componets of the colour at the index\nAlphabet.prototype.get_rgb = function(alph_index) {\n  \"use strict\";\n  if (alph_index < 0 || alph_index >= this.symbols.length) {\n    throw new Error(\"BAD_ALPHABET_INDEX\");\n  }\n  if (typeof this.symbols[alph_index].colour != \"string\") {\n    return {\"red\": 0, \"green\": 0, \"blue\": 0};\n  }\n  var colour = this.symbols[alph_index].colour;\n  var red = parseInt(colour.substr(0, 2), 16) / 255;\n  var green = parseInt(colour.substr(2, 2), 16) / 255;\n  var blue = parseInt(colour.substr(4, 2), 16) / 255;\n  return {\"red\": red, \"green\": green, \"blue\": blue};\n};\n// convert a symbol into the index\nAlphabet.prototype.get_index = function(letter) {\n  \"use strict\";\n  var alph_index;\n  alph_index = this.encode[letter];\n  if (typeof alph_index === \"undefined\") {\n    return -1;\n  }\n  return alph_index;\n};\n// convert a symbol into the list of core indexes that it equals\nAlphabet.prototype.get_indexes = function(letter) {\n  \"use strict\";\n  var alph_index, comprise_str, i, comprise_list;\n  alph_index = this.encode[letter];\n  if (typeof alph_index === \"undefined\") {\n    throw new Error(\"Unknown letter\");\n  }\n  comprise_str = this.symbols[alph_index].equals;\n  comprise_list = [];\n  if (typeof comprise_str == \"string\") {\n    for (i = 0; i < comprise_str.length; i++) {\n      comprise_list.push(this.encode2core[comprise_str.charAt(i)]);\n    }\n  } else {\n    comprise_list.push(alph_index);\n  }\n  return comprise_list;\n};\n// check if a symbol is the primary way of representing the symbol in the alphabet\nAlphabet.prototype.is_prime_symbol = function(letter) {\n  var alph_index;\n  alph_index = this.encode[letter];\n  if (alph_index == null) return false;\n  if (this.is_case_insensitive()) {\n    return (this.symbols[alph_index].symbol.toUpperCase() == letter.toUpperCase());\n  } else {\n    return (this.symbols[alph_index].symbol == letter);\n  }\n};\n// compare 2 alphabets\nAlphabet.prototype.equals = function(other) {\n  \"use strict\";\n  var i, sym1, sym2;\n  // first check that it's actually an alphabet object\n  if (!(typeof other === \"object\" && other != null && other instanceof Alphabet)) {\n    return false;\n  }\n  // second shortcircuit if it's the same object\n  if (this === other) return true;\n  // compare\n  if (this.name !== other.name) return false;\n  if (this.ncore !== other.ncore) return false;\n  if (this.symbols.length !== other.symbols.length) return false;\n  for (i = 0; i < this.symbols.length; i++) {\n    sym1 = this.symbols[i];\n    sym2 = other.symbols[i];\n    if (sym1.symbol !== sym2.symbol) return false;\n    if (sym1.aliases !== sym2.aliases) return false;\n    if (sym1.name !== sym2.name) return false;\n    if (typeof sym1.colour !== typeof sym2.colour || \n        (typeof sym1.colour === \"string\" && typeof sym2.colour === \"string\" &&\n         parseInt(sym1.colour, 16) != parseInt(sym2.colour, 16))) {\n      return false;\n    }\n    if (sym1.complement !== sym2.complement) return false;\n    if (sym1.equals !== sym2.equals) return false;\n  }\n  return true;\n};\nAlphabet.prototype.check_core_subset = function(super_alph) {\n  var complement_same = true;\n  var seen_set = {};\n  var sub_i, sub_symbol, super_i, super_symbol;\n  for (sub_i = 0; sub_i < this.ncore; sub_i++) {\n    sub_symbol = this.symbols[sub_i];\n    super_i = super_alph.encode[sub_symbol.symbol]; \n    if (super_i == null) return 0;\n    super_symbol = super_alph.symbols[super_i];\n    if (seen_set[super_i]) return 0;\n    seen_set[super_i] = true;\n    // check complement\n    if (sub_symbol.complement != null && super_symbol.complement != null) {\n      if (super_alph.encode[sub_symbol.complement] != super_alph.encode[super_symbol.complement]) {\n        complement_same = false;\n      }\n    } else if (sub_symbol.complement != null || super_symbol.complement != null) {\n      complement_same = false;\n    }\n  }\n  return (complement_same ? 1 : -1);\n};\n// convert a sequence to its reverse complement\nAlphabet.prototype.invcomp_seq = function(seq) {\n  \"use strict\";\n  var syms, i, e_sym, comp_e_sym;\n  if (!this.has_complement()) throw new Error(\"Alphabet must be complementable\");\n  syms = seq.split(\"\");\n  for (i = 0; i < syms.length; i++) {\n    e_sym = this.encode[syms[i]];\n    if (typeof e_sym === \"undefined\") {\n      e_sym = this.ncore; // wildcard\n    }\n    comp_e_sym = this.complement[e_sym];\n    if (typeof comp_e_sym === \"undefined\") {\n      comp_e_sym = e_sym; // not complementable\n    }\n    syms[i] = this.symbols[comp_e_sym].symbol;\n  }\n  return syms.reverse().join(\"\");\n};\n// convert the alphabet to the text version\nAlphabet.prototype.as_text = function() {\n  \"use strict\";\n  function name_as_text(name) {\n    var i, c, out;\n    out = \"\\\"\";\n    for (i = 0; i < name.length; i++) {\n      c = name.charAt(i);\n      if (c == \"\\\"\") {\n        out += \"\\\\\\\"\";\n      } else if (c == \"/\") {\n        out += \"\\\\/\";\n      } else if (c == \"\\\\\") {\n        out += \"\\\\\\\\\";\n      } else {\n        out += c;\n      }\n    }\n    out += \"\\\"\";\n    return out;\n  }\n  function symbol_as_text(sym) {\n    var out;\n    out = sym.symbol;\n    if (typeof sym.name === \"string\" && sym.name != sym.symbol) {\n      out += \" \" + name_as_text(sym.name);\n    }\n    if (typeof sym.colour === \"string\") {\n      out += \" \" + sym.colour;\n    }\n    return out;\n  }\n  var out, i, j, c, sym;\n  out = \"\";\n  // output core symbols with 2 way complements\n  for (i = 0; i < this.ncore; i++) {\n    c = this.complement[i];\n    if (typeof c === \"number\" && i < c && this.complement[c] === i) {\n      out += symbol_as_text(this.symbols[i]) + \" ~ \" + symbol_as_text(this.symbols[c]) + \"\\n\";  \n    }\n  }\n  // output core symbols with no complement\n  for (i = 0; i < this.ncore; i++) {\n    if (typeof this.complement[i] === \"undefined\") {\n      out += symbol_as_text(this.symbols[i]) + \"\\n\";\n    }\n  }\n  // output ambiguous symbols that have comprising characters\n  for (i = this.ncore; i < this.symbols.length; i++) {\n    if (this.symbols[i].equals.length == 0) break;\n    out += symbol_as_text(this.symbols[i]) + \" = \" + this.symbols[i].equals + \"\\n\";\n    if (typeof this.symbols[i].aliases === \"string\") {\n      for (j = 0; j < this.symbols[i].aliases.length; j++) {\n        if (this.symbols[i].aliases.charAt(j) == this.symbols[i].symbol) continue;\n        out += this.symbols[i].aliases.charAt(j) + \" = \" + this.symbols[i].equals + \"\\n\";\n      }\n    }\n  }\n  // output aliases of core symbols\n  for (i = 0; i < this.ncore; i++) {\n    if (typeof this.symbols[i].aliases === \"string\") {\n      for (j = 0; j < this.symbols[i].aliases.length; j++) {\n        if (this.symbols[i].aliases.charAt(j) == this.symbols[i].symbol) continue;\n        out += this.symbols[i].aliases.charAt(j) + \" = \" + this.symbols[i].symbol + \"\\n\";\n      }\n    }\n  }\n  // output gap symbols\n  i = this.symbols.length - 1;\n  if (this.symbols[i].equals.length == 0) {\n    out += symbol_as_text(this.symbols[i]) + \" =\\n\";\n    if (typeof this.symbols[i].aliases === \"string\") {\n      for (j = 0; j < this.symbols[i].aliases.length; j++) {\n        if (this.symbols[i].aliases.charAt(j) == this.symbols[i].symbol) continue;\n        out += this.symbols[i].aliases.charAt(j) + \" =\\n\";\n      }\n    }\n  }\n  return out;\n};\n// output the alphabet as it appears in minimal MEME format\nAlphabet.prototype.as_meme = function() {\n  \"use strict\";\n  function name_as_text(name) {\n    var i, c, out;\n    out = \"\\\"\";\n    for (i = 0; i < name.length; i++) {\n      c = name.charAt(i);\n      if (c == \"\\\"\") {\n        out += \"\\\\\\\"\";\n      } else if (c == \"/\") {\n        out += \"\\\\/\";\n      } else if (c == \"\\\\\") {\n        out += \"\\\\\\\\\";\n      } else {\n        out += c;\n      }\n    }\n    out += \"\\\"\";\n    return out;\n  }\n  if (this.equals(AlphStd.DNA)) {\n    return \"ALPHABET= ACGT\\n\";\n  } else if (this.equals(AlphStd.PROTEIN)) {\n    return \"ALPHABET= ACDEFGHIKLMNPQRSTVWY\\n\";\n  } else {\n    return \"ALPHABET\" + \n      (this.name != null ? \" \" + name_as_text(this.name) : \"\") + \n      (this.like != null ? \" \" + this.like + \"-LIKE\" : \"\") + \"\\n\" +\n      this.as_text() + \"END ALPHABET\\n\";\n  }\n};\n\n// Returns a table showing all the letters in the alphabet\nAlphabet.prototype.as_table = function() {\n  \"use strict\";\n  var i, j, row, th, td, aliases, equals, sym;\n  var table = document.createElement(\"table\");\n  // create the core symbol header\n  row = table.insertRow(table.rows.length);\n  th = document.createElement(\"th\");\n  th.appendChild(document.createTextNode(\"Symbol(s)\"));\n  row.appendChild(th);\n  th = document.createElement(\"th\");\n  th.appendChild(document.createTextNode(\"Name\"));\n  row.appendChild(th);\n  th = document.createElement(\"th\");\n  if (this.has_complement()) {\n    th.appendChild(document.createTextNode(\"Complement\"));\n  }\n  row.appendChild(th);\n  // list the core symbols\n  for (i = 0; i < this.ncore; i++) {\n    row = table.insertRow(table.rows.length);\n    td = document.createElement(\"td\");\n    if (this.symbols[i].colour != null) {\n      td.style.color = '#' + this.symbols[i].colour;\n    }\n    td.appendChild(document.createTextNode(this.symbols[i].symbol));\n    aliases = this.get_aliases(i);\n    if (aliases.length > 0) {\n      td.appendChild(document.createTextNode(' ' + aliases.split('').join(' ')));\n    }\n    row.appendChild(td);\n    td = document.createElement(\"td\");\n    if (this.symbols[i].name != null) {\n      td.appendChild(document.createTextNode(this.symbols[i].name));\n    }\n    row.appendChild(td);\n    td = document.createElement(\"td\");\n    if (this.symbols[i].complement != null) {\n      td.style.color = this.get_colour(this.get_index(this.symbols[i].complement));\n      td.appendChild(document.createTextNode(this.symbols[i].complement));\n    }\n    row.appendChild(td);\n  }\n  // create the ambiguous symbol header\n  row = table.insertRow(table.rows.length);\n  th = document.createElement(\"th\");\n  th.appendChild(document.createTextNode(\"Symbol(s)\"));\n  row.appendChild(th);\n  th = document.createElement(\"th\");\n  th.appendChild(document.createTextNode(\"Name\"));\n  row.appendChild(th);\n  th = document.createElement(\"th\");\n  th.appendChild(document.createTextNode(\"Matches\"));\n  row.appendChild(th);\n  // list the ambiguous symbols\n  for (i = this.ncore; i < this.symbols.length; i++) {\n    row = table.insertRow(table.rows.length);\n    td = document.createElement(\"td\");\n    if (this.symbols[i].colour != null) {\n      td.style.color = '#' + this.symbols[i].colour;\n    }\n    td.appendChild(document.createTextNode(this.symbols[i].symbol));\n    aliases = this.get_aliases(i);\n    if (aliases.length > 0) {\n      td.appendChild(document.createTextNode(' ' + aliases.split('').join(' ')));\n    }\n    row.appendChild(td);\n    td = document.createElement(\"td\");\n    if (this.symbols[i].name != null) {\n      td.appendChild(document.createTextNode(this.symbols[i].name));\n    }\n    row.appendChild(td);\n    td = document.createElement(\"td\");\n    equals = this.symbols[i].equals.split('');\n    for (j = 0; j < equals.length; j++) {\n      if (j != 0) td.appendChild(document.createTextNode(' '));\n      sym = document.createElement(\"span\");\n      sym.style.color = this.get_colour(this.get_index(equals[j]));\n      sym.appendChild(document.createTextNode(equals[j]));\n      td.appendChild(sym);\n    }\n    row.appendChild(td);\n  }\n  return table;\n};\n\n// returns a dictionary of the colours for EPS\nAlphabet.prototype._as_eps_dict = function() {\n  \"use strict\";\n  var i, sym, rgb;\n  var out = \"/fullColourDict <<\\n\";\n  for (i = 0; i < this.ncore; i++) {\n    sym = this.get_symbol(i);\n    sym = sym.replace(/\\\\/g, \"\\\\\\\\\");\n    sym = sym.replace(/\\(/g, \"\\\\(\");\n    sym = sym.replace(/\\)/g, \"\\\\)\");\n    rgb = this.get_rgb(i);\n    out += \" (\" + sym + \") [\" + rgb.red.toFixed(4) + \" \" + rgb.green.toFixed(4) + \" \" + rgb.blue.toFixed(4) + \"]\\n\";\n  }\n  out += \">> def\\n\";\n  out += \"/mutedColourDict <<\\n\";\n  for (i = 0; i < this.ncore; i++) {\n    sym = this.get_symbol(i);\n    sym = sym.replace(/\\\\/g, \"\\\\\\\\\");\n    sym = sym.replace(/\\(/g, \"\\\\(\");\n    sym = sym.replace(/\\)/g, \"\\\\)\");\n    rgb = Alphabet.lighten_colour(this.get_rgb(i));\n    out += \" (\" + sym + \") [\" + rgb.red.toFixed(4) + \" \" + rgb.green.toFixed(4) + \" \" + rgb.blue.toFixed(4) + \"]\\n\";\n  }\n  out += \">> def\\n\";\n  return out;\n};\n\n// return the alphabet name or a list of primary symbols\nAlphabet.prototype.toString = function() {\n  \"use strict\";\n  if (this.name != null) {\n    return this.name;\n  } else {\n    return this.get_symbols();\n  }\n};\n\n//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n// Helper functions\n//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n// Convert a colour specified in RGB colourspace values into LAB colourspace\nAlphabet.rgb2lab = function(rgb) {\n  \"use strict\";\n  var xyzHelper, labHelper;\n  // XYZ helper\n  xyzHelper = function(value) {\n    if (value > 0.0445) {\n      value = (value + 0.055) / 1.055;\n      value = Math.pow(value, 2.4);\n    } else {\n      value /= 12.92;\n    }\n    value *= 100;\n    return value;\n  };\n  // lab helper\n  labHelper = function(value) {\n    if (value > 0.008856) {\n      value = Math.pow(value, 1.0 / 3.0);\n    } else {\n      value = (7.787 * value) + (16.0 / 116.0);\n    }\n    return value;\n  };\n  // convert into XYZ colourspace\n  var c1, c2, c3;\n  if (typeof rgb == \"number\") {\n    c1 = xyzHelper(((rgb >> 16) & 0xFF) / 255.0);\n    c2 = xyzHelper(((rgb >> 8) & 0xFF) / 255.0);\n    c3 = xyzHelper((rgb & 0xFF) / 255.0);\n  } else {\n    c1 = xyzHelper(rgb.red);\n    c2 = xyzHelper(rgb.green);\n    c3 = xyzHelper(rgb.blue);\n  }\n  var x = (c1 * 0.4124) + (c2 * 0.3576) + (c3 * 0.1805);\n  var y = (c1 * 0.2126) + (c2 * 0.7152) + (c3 * 0.0722);\n  var z = (c1 * 0.0193) + (c2 * 0.1192) + (c3 * 0.9505);\n  // convert into Lab colourspace\n  c1 = labHelper(x / 95.047);\n  c2 = labHelper(y / 100.0);\n  c3 = labHelper(z / 108.883);\n  var l = (116.0 * c2) - 16;\n  var a = 500.0 * (c1 - c2);\n  var b = 200.0 * (c2 - c3);\n  return {\"l\": l, \"a\": a, \"b\": b};\n};\n\n// Convert a colour specified in HSV colourspace into RGB colourspace\nAlphabet.hsv2rgb = function(hue, sat, value, output_object) {\n  // achromatic (grey)\n  var r = value;\n  var g = value;\n  var b = value;\n  if (sat != 0) {\n    var h = hue / 60.0;\n    var i = Math.floor(h);\n    var f = h - i;\n    var p = value * (1.0 - sat);\n    var q = value * (1.0 - (sat * f));\n    var t = value * (1.0 - (sat * (1.0 - f)));\n    if (i == 0) {\n      r = value;\n      g = t;\n      b = p;\n    } else if (i == 1) {\n      r = q;\n      g = value;\n      b = p;\n    } else if (i == 2) {\n      r = p;\n      g = value;\n      b = t;\n    } else if (i == 3) {\n      r = p;\n      g = q;\n      b = value;\n    } else if (i == 4) {\n      r = t;\n      g = p;\n      b = value;\n    } else {\n      r = value;\n      g = p;\n      b = q;\n    }\n  }\n  if (output_object) {\n    return {\"red\": r, \"green\": g, \"blue\": b};\n  } else {\n    return (Math.floor(r * 255) << 15) | (Math.floor(g * 255) << 8) | (Math.floor(b * 255));\n  }\n};\n\n// Calculate a distance score between two colours in LAB colourspace\nAlphabet.lab_dist = function(lab1, lab2) {\n  var c1 = Math.sqrt((lab1.l * lab1.l) + (lab1.a * lab1.a));\n  var c2 = Math.sqrt((lab2.l * lab2.l) + (lab2.a * lab2.a));\n  var dc = c1 - c2;\n  var dl = lab1.l - lab2.l;\n  var da = lab1.a - lab2.a;\n  var db = lab1.b - lab2.b;\n  // we don't want NaN due to rounding errors so fudge things a bit...\n  var dh = 0;\n  var dh_squared = (da * da) + (db * db) - (dc * dc);\n  if (dh_squared > 0) {\n    dh = Math.sqrt(dh_squared);\n  }\n  var first = dl;\n  var second = dc / (1.0 + (0.045 * c1));\n  var third = dh / (1.0 + (0.015 * c1));\n  return Math.sqrt((first * first) + (second * second) + (third * third));\n};\n\n// convert an RGB value into a HSL value\nAlphabet.rgb2hsl = function(rgb) {\n  \"use strict\";\n  var min, max, delta, h, s, l, r, g, b;\n  if (typeof rgb == \"number\") {\n    r = ((rgb >> 16) & 0xFF) / 255.0;\n    g = ((rgb >> 8) & 0xFF) / 255.0;\n    b = (rgb & 0xFF) / 255.0;\n  } else {\n    r = rgb.red;\n    g = rgb.green;\n    b = rgb.blue;\n  }\n  min = Math.min(r, g, b);\n  max = Math.max(r, g, b);\n  delta = max - min;\n  l = min + (delta / 2);\n  if (max == min) {\n    h = 0; // achromatic (grayscale)\n    s = 0;\n  } else {\n    if (l > 0.5) {\n      s = delta / (2 - max - min);\n    } else {\n      s = delta / (max + min);\n    }\n    if (max == r) {\n      h = (g - b) / delta;\n      if (g < b) h += 6;\n    } else if (max == g) {\n      h = ((b - r) / delta) + 2;\n    } else {\n      h = ((r - g) / delta) + 4;\n    }\n    h /= 6;\n  }\n  return {\"h\": h, \"s\": s, \"l\": l};\n};\n\n// convert a HSL value into an RGB value\nAlphabet.hsl2rgb = function(hsl, output_object) {\n  \"use strict\";\n  function _hue(p, q, t) {\n    \"use strict\";\n    if (t < 0) t += 1;\n    else if (t > 1) t -= 1;\n    if (t < (1.0 / 6.0)) {\n      return p + ((q - p) * 6.0 * t);\n    } else if (t < 0.5) {\n      return q;\n    } else if (t < (2.0 / 3.0)) {\n      return p + ((q - p) * ((2.0 / 3.0) - t) * 6.0);\n    } else {\n      return p;\n    }\n  }\n  var r, g, b, p, q;\n  if (hsl.s == 0) {\n    // achromatic (grayscale)\n    r = hsl.l;\n    g = hsl.l;\n    b = hsl.l;\n  } else {\n    if (hsl.l < 0.5) {\n      q = hsl.l * (1 + hsl.s);\n    } else {\n      q = hsl.l + hsl.s - (hsl.l * hsl.s);\n    }\n    p = (2 * hsl.l) - q;\n    r = _hue(p, q, hsl.h + (1.0 / 3.0));\n    g = _hue(p, q, hsl.h);\n    b = _hue(p, q, hsl.h - (1.0 / 3.0));\n  }\n  if (output_object) {\n    return {\"red\": r, \"green\": g, \"blue\": b};\n  } else {\n    return (Math.floor(r * 255) << 15) | (Math.floor(g * 255) << 8) | (Math.floor(b * 255));\n  }\n};\n\nAlphabet.lighten_colour = function(rgb) {\n  \"use strict\";\n  var hsl = Alphabet.rgb2hsl(rgb);\n  hsl.l += (1.0 - hsl.l) * 2 / 3;\n  return Alphabet.hsl2rgb(hsl, typeof rgb != \"number\");\n};\n\n//======================================================================\n// end Alphabet object\n//======================================================================\n\n//======================================================================\n// start StandardAlphabet object\n//======================================================================\n\n// an extension of the alphabet object to support some additional fields \n// only present in standard alphabets.\nvar StandardAlphabet = function(enum_code, enum_name, alphabet_data) {\n  Alphabet.apply(this, [alphabet_data]);\n  this.enum_code = enum_code;\n  this.enum_name = enum_name;\n};\nStandardAlphabet.prototype = Alphabet.prototype;\nStandardAlphabet.prototype.constructor = StandardAlphabet;\n\n// A unique code for this standard alphabet.\n// This code will be a power of 2 to enable creation of bitsets for\n// a selection of standard alphabets.\nStandardAlphabet.prototype.get_code = function() {\n  return this.enum_code;\n};\n\n// A unique name for this standard alphabet.\n// this name will be all upper case and the same as the property that\n// refers to this alphabet in the AlphStd collection.\nStandardAlphabet.prototype.get_enum = function() {\n  return this.enum_name;\n};\n\n//======================================================================\n// end StandardAlphabet object\n//======================================================================\n\n// A collection of standard alphabets.\nvar AlphStd = {\n  RNA: new StandardAlphabet(1, \"RNA\", {\n    \"name\": \"RNA\",\n    \"like\": \"RNA\",\n    \"ncore\": 4,\n    \"symbols\": [\n      {\"symbol\": \"A\", \"name\": \"Adenine\", \"colour\": \"CC0000\"},\n      {\"symbol\": \"C\", \"name\": \"Cytosine\", \"colour\": \"0000CC\"},\n      {\"symbol\": \"G\", \"name\": \"Guanine\", \"colour\": \"FFB300\"},\n      {\"symbol\": \"U\", \"name\": \"Uracil\", \"colour\": \"008000\",\n        \"aliases\": \"T\"},\n      {\"symbol\": \"N\", \"name\": \"Any base\", \"equals\": \"ACGU\", \"aliases\": \"X.\"},\n      {\"symbol\": \"V\", \"name\": \"Not U\", \"equals\": \"ACG\"},\n      {\"symbol\": \"H\", \"name\": \"Not G\", \"equals\": \"ACU\"},\n      {\"symbol\": \"D\", \"name\": \"Not C\", \"equals\": \"AGU\"},\n      {\"symbol\": \"B\", \"name\": \"Not A\", \"equals\": \"CGU\"},\n      {\"symbol\": \"M\", \"name\": \"Amino\", \"equals\": \"AC\"},\n      {\"symbol\": \"R\", \"name\": \"Purine\", \"equals\": \"AG\"},\n      {\"symbol\": \"W\", \"name\": \"Weak\", \"equals\": \"AU\"}, \n      {\"symbol\": \"S\", \"name\": \"Strong\", \"equals\": \"CG\"},\n      {\"symbol\": \"Y\", \"name\": \"Pyrimidine\", \"equals\": \"CU\"},\n      {\"symbol\": \"K\", \"name\": \"Keto\", \"equals\": \"GU\"}\n    ]\n  }), \n  DNA: new StandardAlphabet(2, \"DNA\", {\n    \"name\": \"DNA\",\n    \"like\": \"DNA\",\n    \"ncore\": 4,\n    \"symbols\": [\n      {\"symbol\": \"A\", \"name\": \"Adenine\", \"colour\": \"CC0000\", \"complement\": \"T\"},\n      {\"symbol\": \"C\", \"name\": \"Cytosine\", \"colour\": \"0000CC\", \"complement\": \"G\"},\n      {\"symbol\": \"G\", \"name\": \"Guanine\", \"colour\": \"FFB300\", \"complement\": \"C\"},\n      {\"symbol\": \"T\", \"name\": \"Thymine\", \"colour\": \"008000\", \"complement\": \"A\",\n        \"aliases\": \"U\"},\n      {\"symbol\": \"N\", \"name\": \"Any base\", \"equals\": \"ACGT\", \"aliases\": \"X.\"},\n      {\"symbol\": \"V\", \"name\": \"Not T\", \"equals\": \"ACG\"},\n      {\"symbol\": \"H\", \"name\": \"Not G\", \"equals\": \"ACT\"},\n      {\"symbol\": \"D\", \"name\": \"Not C\", \"equals\": \"AGT\"},\n      {\"symbol\": \"B\", \"name\": \"Not A\", \"equals\": \"CGT\"},\n      {\"symbol\": \"M\", \"name\": \"Amino\", \"equals\": \"AC\"},\n      {\"symbol\": \"R\", \"name\": \"Purine\", \"equals\": \"AG\"},\n      {\"symbol\": \"W\", \"name\": \"Weak\", \"equals\": \"AT\"}, \n      {\"symbol\": \"S\", \"name\": \"Strong\", \"equals\": \"CG\"},\n      {\"symbol\": \"Y\", \"name\": \"Pyrimidine\", \"equals\": \"CT\"},\n      {\"symbol\": \"K\", \"name\": \"Keto\", \"equals\": \"GT\"}\n    ]\n  }), \n  PROTEIN: new StandardAlphabet(4, \"PROTEIN\", {\n    \"name\": \"Protein\",\n    \"like\": \"PROTEIN\",\n    \"ncore\": 20,\n    \"symbols\": [\n      {\"symbol\": \"A\", \"name\": \"Alanine\", \"colour\": \"0000CC\"},\n      {\"symbol\": \"C\", \"name\": \"Cysteine\", \"colour\": \"0000CC\"},\n      {\"symbol\": \"D\", \"name\": \"Aspartic acid\", \"colour\": \"FF00FF\"},\n      {\"symbol\": \"E\", \"name\": \"Glutamic acid\", \"colour\": \"FF00FF\"},\n      {\"symbol\": \"F\", \"name\": \"Phenylalanine\", \"colour\": \"0000CC\"},\n      {\"symbol\": \"G\", \"name\": \"Glycine\", \"colour\": \"FFB300\"},\n      {\"symbol\": \"H\", \"name\": \"Histidine\", \"colour\": \"FFCCCC\"},\n      {\"symbol\": \"I\", \"name\": \"Isoleucine\", \"colour\": \"0000CC\"},\n      {\"symbol\": \"K\", \"name\": \"Lysine\", \"colour\": \"CC0000\"},\n      {\"symbol\": \"L\", \"name\": \"Leucine\", \"colour\": \"0000CC\"},\n      {\"symbol\": \"M\", \"name\": \"Methionine\", \"colour\": \"0000CC\"},\n      {\"symbol\": \"N\", \"name\": \"Asparagine\", \"colour\": \"008000\"},\n      {\"symbol\": \"P\", \"name\": \"Proline\", \"colour\": \"FFFF00\"},\n      {\"symbol\": \"Q\", \"name\": \"Glutamine\", \"colour\": \"008000\"},\n      {\"symbol\": \"R\", \"name\": \"Arginine\", \"colour\": \"CC0000\"},\n      {\"symbol\": \"S\", \"name\": \"Serine\", \"colour\": \"008000\"},\n      {\"symbol\": \"T\", \"name\": \"Threonine\", \"colour\": \"008000\"},\n      {\"symbol\": \"V\", \"name\": \"Valine\", \"colour\": \"0000CC\"},\n      {\"symbol\": \"W\", \"name\": \"Tryptophan\", \"colour\": \"0000CC\"},\n      {\"symbol\": \"Y\", \"name\": \"Tyrosine\", \"colour\": \"33E6CC\"},\n      {\"symbol\": \"X\", \"name\": \"Any amino acid\", \"equals\": \"ACDEFGHIKLMNPQRSTVWY\", \"aliases\": \"*.\"},\n      {\"symbol\": \"B\", \"name\": \"Asparagine or Aspartic acid\", \"equals\": \"DN\"}, \n      {\"symbol\": \"Z\", \"name\": \"Glutamine or Glutamic acid\", \"equals\": \"EQ\"}, \n      {\"symbol\": \"J\", \"name\": \"Leucine or Isoleucine\", \"equals\": \"IL\"}\n    ]\n  })\n};\n\n//======================================================================\n// start Symbol object\n//======================================================================\nvar Symbol = function(alph_index, scale, alphabet) {\n  \"use strict\";\n  //variable prototype\n  this.symbol = alphabet.get_symbol(alph_index);\n  this.scale = scale;\n  this.colour = alphabet.get_colour(alph_index);\n};\n\nSymbol.prototype.get_symbol = function() {\n  \"use strict\";\n  return this.symbol;\n};\n\nSymbol.prototype.get_scale = function() {\n  \"use strict\";\n  return this.scale;\n};\n\nSymbol.prototype.get_colour = function() {\n  \"use strict\";\n  return this.colour;\n};\n\nSymbol.prototype.toString = function() {\n  \"use strict\";\n  return this.symbol + \" \" + (Math.round(this.scale*1000)/10) + \"%\";\n};\n\nfunction compare_symbol(sym1, sym2) {\n  \"use strict\";\n  if (sym1.get_scale() < sym2.get_scale()) {\n    return -1;\n  } else if (sym1.get_scale() > sym2.get_scale()) {\n    return 1;\n  } else {\n    return 0;\n  }\n}\n//======================================================================\n// end Symbol object\n//======================================================================\n\n//======================================================================\n// start Pspm object\n//======================================================================\nvar Pspm = function(matrix, name, ltrim, rtrim, nsites, evalue, pssm, alt) {\n  \"use strict\";\n  var row, col, data, row_sum, delta, evalue_re;\n  if (typeof name !== \"string\") {\n    name = \"\";\n  }\n  this.name = name;\n  //construct\n  if (matrix instanceof Pspm) {\n    // copy constructor\n    this.alph_length = matrix.alph_length;\n    this.motif_length = matrix.motif_length;\n    this.name = matrix.name;\n    this.alt = matrix.alt;\n    this.nsites = matrix.nsites;\n    this.evalue = matrix.evalue;\n    this.ltrim = matrix.ltrim;\n    this.rtrim = matrix.rtrim;\n    this.pspm = [];\n    for (row = 0; row < matrix.motif_length; row++) {\n      this.pspm[row] = [];\n      for (col = 0; col < matrix.alph_length; col++) {\n        this.pspm[row][col] = matrix.pspm[row][col];\n      }\n    }\n    if (matrix.pssm != null) {\n      this.pssm = [];\n      for (row = 0; row < matrix.motif_length; row++) {\n        this.pspm[row] = [];\n        for (col = 0; col < matrix.alph_length; col++) {\n          this.pssm[row][col] = matrix.pssm[row][col];\n        }\n      }\n    }\n  } else {\n    // check parameters\n    if (ltrim == null) {\n      ltrim = 0;\n    } else if (typeof ltrim !== \"number\" || ltrim % 1 !== 0 || ltrim < 0) {\n      throw new Error(\"ltrim must be a non-negative integer, got: \" + ltrim);\n    }\n    if (rtrim == null) {\n      rtrim = 0;\n    } else if (typeof rtrim !== \"number\" || rtrim % 1 !== 0 || rtrim < 0) {\n      throw new Error(\"rtrim must be a non-negative integer, got: \" + rtrim);\n    }\n    if (nsites != null) {\n      if (typeof nsites !== \"number\" || nsites < 0) {\n        throw new Error(\"nsites must be a positive number, got: \" + nsites);\n      } else if (nsites == 0) {\n        nsites = null;\n      }\n    }\n    if (evalue != null) {\n      if (typeof evalue === \"number\") {\n        if (evalue < 0) {\n          throw new Error(\"evalue must be a non-negative number, got: \" + evalue);\n        }\n      } else if (typeof evalue === \"string\") {\n        evalue_re = /^((?:[+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|inf)$/;\n        if (!evalue_re.test(evalue)) {\n          throw new Error(\"evalue must be a non-negative number, got: \" + evalue);\n        }\n      } else {\n        throw new Error(\"evalue must be a non-negative number, got: \" + evalue);\n      }\n    }\n    // set properties\n    this.name = name;\n    this.alt = alt;\n    this.nsites = nsites;\n    this.evalue = evalue;\n    this.ltrim = ltrim;\n    this.rtrim = rtrim;\n    if (typeof matrix === \"string\") {\n      // string constructor\n      data = parse_pspm_string(matrix);\n      this.alph_length = data[\"alph_length\"];\n      this.motif_length = data[\"motif_length\"];\n      this.pspm = data[\"pspm\"];\n      if (this.evalue == null) {\n        if (data[\"evalue\"] != null) {\n          this.evalue = data[\"evalue\"];\n        } else {\n          this.evalue = 0;\n        }\n      }\n      if (this.nsites == null) {\n        if (typeof data[\"nsites\"] === \"number\") {\n          this.nsites = data[\"nsites\"];\n        } else {\n          this.nsites = 20;\n        }\n      }\n    } else {\n      // assume pspm is a nested array\n      this.motif_length = matrix.length;\n      this.alph_length = (matrix.length > 0 ? matrix[0].length : 0);\n      if (this.nsites == null) {\n        this.nsites = 20;\n      }\n      if (this.evalue == null) {\n        this.evalue = 0;\n      }\n      this.pspm = [];\n      // copy pspm and check\n      for (row = 0; row < this.motif_length; row++) {\n        if (this.alph_length != matrix[row].length) {\n          throw new Error(\"COLUMN_MISMATCH\");\n        }\n        this.pspm[row] = [];\n        row_sum = 0;\n        for (col = 0; col < this.alph_length; col++) {\n          this.pspm[row][col] = matrix[row][col];\n          row_sum += this.pspm[row][col];\n        }\n        delta = 0.1;\n        if (isNaN(row_sum) || (row_sum > 1 && (row_sum - 1) > delta) || \n            (row_sum < 1 && (1 - row_sum) > delta)) {\n          throw new Error(\"INVALID_SUM\");\n        }\n      }\n      // copy pssm\n      if (pssm != null) {\n        this.pssm = [];\n        for (row = 0; row < this.motif_length; row++) {\n          this.pssm[row] = [];\n          for (col = 0; col < this.alph_length; col++) {\n            this.pssm[row][col] = pssm[row][col];\n          }\n        }\n      }\n    }\n  }\n};\n\nPspm.prototype.copy = function() {\n  \"use strict\";\n  return new Pspm(this);\n};\n\nPspm.prototype.reverse = function() {\n  \"use strict\";\n  var x, y, temp, temp_trim;\n  //reverse\n  x = 0;\n  y = this.motif_length-1;\n  while (x < y) {\n    temp = this.pspm[x];\n    this.pspm[x] = this.pspm[y];\n    this.pspm[y] = temp;\n    x++;\n    y--;\n  }\n  // reverse pssm (if defined)\n  if (typeof this.pssm !== \"undefined\") {\n    //reverse\n    x = 0;\n    y = this.motif_length-1;\n    while (x < y) {\n      temp = this.pssm[x];\n      this.pspm[x] = this.pssm[y];\n      this.pssm[y] = temp;\n      x++;\n      y--;\n    }\n  }\n  //swap triming\n  temp_trim = this.ltrim;\n  this.ltrim = this.rtrim;\n  this.rtrim = temp_trim;\n  return this; //allow function chaining...\n};\n\nPspm.prototype.reverse_complement = function(alphabet) {\n  \"use strict\";\n  var x, y, temp, i, row, c, temp_trim;\n  if (this.alph_length != alphabet.get_size_core()) {\n    throw new Error(\"The alphabet size does not match the size of the pspm.\");\n  }\n  if (!alphabet.has_complement()) {\n    throw new Error(\"The specified alphabet can not be complemented.\");\n  }\n  // reverse motif\n  this.reverse();\n  //complement\n  for (x = 0; x < this.motif_length; x++) {\n    row = this.pspm[x];\n    for (i = 0; i < row.length; i++) {\n      c = alphabet.get_complement(i);\n      if (c < i) continue;\n      temp = row[i];\n      row[i] = row[c];\n      row[c] = temp;\n    }\n  }\n  // complement pssm (if defined)\n  if (typeof this.pssm !== \"undefined\") {\n    //complement\n    for (x = 0; x < this.motif_length; x++) {\n      row = this.pssm[x];\n      for (i = 0; i < row.length; i++) {\n        c = alphabet.get_complement(i);\n        if (c < i) continue;\n        temp = row[i];\n        row[i] = row[c];\n        row[c] = temp;\n      }\n    }\n  }\n  return this; //allow function chaining...\n};\n\nPspm.prototype.get_stack = function(position, alphabet, ssc) {\n  \"use strict\";\n  var row, stack_ic, alphabet_ic, stack, i, sym;\n  if (this.alph_length != alphabet.get_size_core()) {\n    throw new Error(\"The alphabet size does not match the size of the pspm.\");\n  }\n  row = this.pspm[position];\n  stack_ic = this.get_stack_ic(position, alphabet);\n  if (ssc) stack_ic -= this.get_error(alphabet);\n  alphabet_ic = alphabet.get_ic();\n  stack = [];\n  for (i = 0; i < this.alph_length; i++) {\n    sym = new Symbol(i, row[i]*stack_ic/alphabet_ic, alphabet);\n    if (sym.get_scale() <= 0) {\n      continue;\n    }\n    stack.push(sym);\n  }\n  stack.sort(compare_symbol);\n  return stack;\n};\n\nPspm.prototype.get_stack_ic = function(position, alphabet) {\n  \"use strict\";\n  var row, H, i;\n  if (this.alph_length != alphabet.get_size_core()) {\n    throw new Error(\"The alphabet size does not match the size fo the pspm.\");\n  }\n  row = this.pspm[position];\n  H = 0;\n  for (i = 0; i < this.alph_length; i++) {\n    if (row[i] === 0) {\n      continue;\n    }\n    H -= (row[i] * (Math.log(row[i]) / Math.LN2));\n  }\n  return alphabet.get_ic() - H;\n};\n\nPspm.prototype.get_error = function(alphabet) {\n  \"use strict\";\n  if (this.nsites === 0) {\n    return 0;\n  }\n  return (alphabet.get_size_core()-1) / (2 * Math.LN2 * this.nsites);\n};\n\nPspm.prototype.get_motif_length = function() {\n  \"use strict\";\n  return this.motif_length;\n};\n\nPspm.prototype.get_alph_length = function() {\n  \"use strict\";\n  return this.alph_length;\n};\n\nPspm.prototype.get_left_trim = function() {\n  \"use strict\";\n  return this.ltrim;\n};\n\nPspm.prototype.get_right_trim = function() {\n  \"use strict\";\n  return this.rtrim;\n};\n\nPspm.prototype.as_best_match = function(alphabet) {\n  \"use strict\";\n  var match, odds, best_odds, best_index;\n  var i, j;\n  match = \"\";\n  for (i = 0; i < this.motif_length; i++) {\n    best_index = 0;\n    best_odds = this.pspm[i][0] / alphabet.get_bg_freq(0);\n    for (j = 1; j < this.alph_length; j++) {\n      odds = this.pspm[i][j] / alphabet.get_bg_freq(j);\n      if (odds > best_odds) {\n        best_odds = odds;\n        best_index = j;\n      }\n    }\n    match += alphabet.get_symbol(best_index);\n  }\n  return match;\n};\n\nPspm.prototype.as_count_matrix = function() {\n  \"use strict\";\n  var count, count_text, text;\n  var i, j;\n  text = \"\";\n  for (i = 0; i < this.motif_length; i++) {\n    if (i !== 0) {\n      text += \"\\n\";\n    }\n    for (j = 0; j < this.alph_length; j++) {\n      if (j !== 0) {\n        text += \" \";\n      }\n      count = Math.round(this.nsites * this.pspm[i][j]);\n      count_text = \"\" + count;\n      // pad up to length of 4\n      if (count_text.length < 4) {\n        text += (new Array(5 - count_text.length)).join(\" \") + count_text;\n      } else {\n        text += count_text;\n      }\n    }\n  }\n  return text; \n};\n\nPspm.prototype.as_probability_matrix = function() {\n  \"use strict\";\n  var text;\n  var i, j;\n  text = \"\";\n  for (i = 0; i < this.motif_length; i++) {\n    if (i !== 0) {\n      text += \"\\n\";\n    }\n    for (j = 0; j < this.alph_length; j++) {\n      if (j !== 0) {\n        text += \" \";\n      }\n      text += this.pspm[i][j].toFixed(6);\n    }\n  }\n  return text; \n};\n\nPspm.prototype.as_score_matrix = function(alphabet, pseudo) {\n  \"use strict\";\n  var me, score, out, row, col, score_text;\n  me = this;\n  if (typeof this.pssm === \"undefined\") {\n    if (!(typeof alphabet === \"object\" && alphabet != null && alphabet instanceof Alphabet)) {\n      throw new Error(\"The alphabet is required to generate the pssm.\");\n    }\n    if (typeof pseudo === \"undefined\") {\n      pseudo = 0.01;\n    } else if (typeof pseudo !== \"number\" || pseudo < 0) {\n      throw new Error(\"Expected positive number for pseudocount\");\n    }\n    score = function(row, col) {\n      \"use strict\";\n      var p, bg, p2;\n      p = me.pspm[row][col];\n      bg = alphabet.get_bg_freq(col);\n      p2 = (p * me.nsites + bg * pseudo) / (me.nsites + pseudo);\n      return (p2 > 0 ? Math.round((Math.log(p2 / bg) / Math.LN2) * 100) : -10000);\n    };\n  } else {\n    score = function(row, col) {\n      \"use strict\";\n      return me.pssm[row][col];\n    };\n  }\n  out = \"\";\n  for (row = 0; row < this.motif_length; row++) {\n    for (col = 0; col < this.alph_length; col++) {\n      if (col !== 0) {\n        out += \" \";\n      }\n      score_text = \"\" + score(row, col);\n      // pad out to 6 characters\n      if (score_text.length < 6) {\n        out += (new Array(7 - score_text.length)).join(\" \") + score_text;\n      } else {\n        out += score_text;\n      }\n    }\n    out += \"\\n\";\n  }\n  return out;\n}\n\nPspm.prototype.as_pspm = function() {\n  \"use strict\";\n  return \"letter-probability matrix: alength= \" + this.alph_length + \n      \" w= \" + this.motif_length + \" nsites= \" + this.nsites + \n      \" E= \" + (typeof this.evalue === \"number\" ? \n          this.evalue.toExponential() : this.evalue) + \"\\n\" +\n      this.as_probability_matrix();\n};\n\nPspm.prototype.as_pssm = function(alphabet, pseudo) {\n  \"use strict\";\n  return \"log-odds matrix: alength= \" + this.alph_length + \n      \" w= \" + this.motif_length + \n      \" E= \" + (typeof this.evalue == \"number\" ?\n          this.evalue.toExponential() : this.evalue) + \"\\n\" +\n      this.as_score_matrix(alphabet, pseudo);\n};\n\nPspm.prototype.as_meme = function(options) {\n  var with_header, with_pspm, with_pssm, version, alphabet, bg_source, pseudocount, strands;\n  var out, alen, i;\n  // get the options\n  if (typeof options !== \"object\" || options === null) {\n    options = {};\n  }\n  with_header = (typeof options[\"with_header\"] === \"boolean\" ? options[\"with_header\"] : false);\n  with_pspm = (typeof options[\"with_pspm\"] === \"boolean\" ? options[\"with_pspm\"] : false);\n  with_pssm = (typeof options[\"with_pssm\"] === \"boolean\" ? options[\"with_pssm\"] : false);\n  if (!with_pspm && !with_pssm) with_pspm = true;\n  if (with_header) {\n    if (typeof options[\"version\"] === \"string\" && /^\\d+(?:\\.\\d+){0,2}$/.test(options[\"version\"])) {\n      version = options[\"version\"];\n    } else if (typeof options[\"version\"] === \"number\") {\n      version = options[\"version\"].toFixed(0);\n    } else {\n      version = \"4\";\n    }\n    if (typeof options[\"strands\"] === \"number\" && options[\"strands\"] === 1) {\n      strands = 1;\n    } else {\n      strands = 2;\n    }\n    if (typeof options[\"bg_source\"] === \"string\") {\n      bg_source = options[\"bg_source\"];\n    } else {\n      bg_source = \"unknown source\";\n    }\n    if (typeof options[\"alphabet\"] === \"object\" && options[\"alphabet\"] != null\n        && options[\"alphabet\"] instanceof Alphabet) {\n      alphabet = options[\"alphabet\"];\n    } else {\n      throw new Error(\"The alphabet is required to generate the header.\");\n    }\n  }\n  // now create the output\n  out = \"\";\n  if (with_header) {\n    out = \"MEME version \" + version + \"\\n\\n\";\n    out += alphabet.as_meme() + \"\\n\";\n    if (alphabet.has_complement()) { // assume DNA has both strands unless otherwise specified\n      out += \"strands: \" + (strands === 1 ? \"+\" : \"+ -\") + \"\\n\\n\";\n    }\n    out += \"Background letter frequencies (from \" + bg_source + \"):\\n\";\n    alen = alphabet.get_size_core();\n    for (i = 0; i < alen; i++) {\n      if (i !== 0) {\n        if (i % 9 === 0) { // maximum of nine entries per line\n          out += \"\\n\";\n        } else {\n          out += \" \";\n        }\n      }\n      out += alphabet.get_symbol(i) + \" \" + alphabet.get_bg_freq(i).toFixed(3);\n    }\n  }\n  out += \"\\n\\n\";\n  out += \"MOTIF \" + this.name + (this.alt == null ? \"\" : \" \" + this.alt);\n  if (with_pssm) {\n    out += \"\\n\\n\";\n    out += this.as_pssm(options[\"alphabet\"], options[\"pseudocount\"]);\n  }\n  if (with_pspm) {\n    out += \"\\n\\n\";\n    out += this.as_pspm();\n  }\n  return out;\n}\n\nPspm.prototype.toString = function() {\n  \"use strict\";\n  var str, i, row;\n  str = \"\";\n  for (i = 0; i < this.pspm.length; i++) {\n    row = this.pspm[i];\n    str += row.join(\"\\t\") + \"\\n\";\n  }\n  return str;\n};\n\nfunction parse_pspm_properties(str) {\n  \"use strict\";\n  var parts, i, eqpos, before, after, properties, prop, num, num_re;\n  num_re = /^((?:[+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|inf)$/;\n  parts = trim(str).split(/\\s+/);\n  // split up words containing =\n  for (i = 0; i < parts.length;) {\n    eqpos = parts[i].indexOf(\"=\");\n    if (eqpos != -1) {\n      before = parts[i].substr(0, eqpos);\n      after = parts[i].substr(eqpos+1);\n      if (before.length > 0 && after.length > 0) {\n        parts.splice(i, 1, before, \"=\", after);\n        i += 3;\n      } else if (before.length > 0) {\n        parts.splice(i, 1, before, \"=\");\n        i += 2;\n      } else if (after.length > 0) {\n        parts.splice(i, 1, \"=\", after);\n        i += 2;\n      } else {\n        parts.splice(i, 1, \"=\");\n        i++;\n      }\n    } else {\n      i++;\n    }\n  }\n  properties = {};\n  for (i = 0; i < parts.length; i += 3) {\n    if (parts.length - i < 3) {\n      throw new Error(\"Expected PSPM property was incomplete. \"+\n          \"Remaing parts are: \" + parts.slice(i).join(\" \"));\n    }\n    if (parts[i+1] !== \"=\") {\n      throw new Error(\"Expected '=' in PSPM property between key and \" +\n          \"value but got \" + parts[i+1]); \n    }\n    prop = parts[i].toLowerCase();\n    num = parts[i+2];\n    if (!num_re.test(num)) {\n      throw new Error(\"Expected numeric value for PSPM property '\" + \n          prop + \"' but got '\" + num + \"'\");\n    }\n    properties[prop] = num;\n  }\n  return properties;\n}\n\nfunction parse_pspm_string(pspm_string) {\n  \"use strict\";\n  var header_re, lines, first_line, line_num, col_num, alph_length, \n      motif_length, nsites, evalue, pspm, i, line, match, props, parts,\n      j, prob;\n  header_re = /^letter-probability\\s+matrix:(.*)$/i;\n  lines = pspm_string.split(/\\n/);\n  first_line = true;\n  line_num = 0;\n  col_num = 0;\n  alph_length;\n  motif_length;\n  nsites;\n  evalue;\n  pspm = [];\n  for (i = 0; i < lines.length; i++) {\n    line = trim(lines[i]);\n    if (line.length === 0) { \n      continue;\n    }\n    // check the first line for a header though allow matrices without it\n    if (first_line) {\n      first_line = false;\n      match = header_re.exec(line);\n      if (match !== null) {\n        props = parse_pspm_properties(match[1]);\n        if (props.hasOwnProperty(\"alength\")) {\n          alph_length = parseFloat(props[\"alength\"]);\n          if (alph_length != 4 && alph_length != 20) {\n            throw new Error(\"PSPM property alength should be 4 or 20\" +\n                \" but got \" + alph_length);\n          }\n        }\n        if (props.hasOwnProperty(\"w\")) {\n          motif_length = parseFloat(props[\"w\"]);\n          if (motif_length % 1 !== 0 || motif_length < 1) {\n            throw new Error(\"PSPM property w should be an integer larger \" +\n                \"than zero but got \" + motif_length);\n          }\n        }\n        if (props.hasOwnProperty(\"nsites\")) {\n          nsites = parseFloat(props[\"nsites\"]);\n          if (nsites <= 0) {\n            throw new Error(\"PSPM property nsites should be larger than \" +\n                \"zero but got \" + nsites);\n          }\n        }\n        if (props.hasOwnProperty(\"e\")) {\n          evalue = props[\"e\"];\n          if (evalue < 0) {\n            throw new Error(\"PSPM property evalue should be \" +\n                \"non-negative but got \" + evalue);\n          }\n        }\n        continue;\n      }\n    }\n    pspm[line_num] = [];\n    col_num = 0;\n    parts = line.split(/\\s+/);\n    for (j = 0; j < parts.length; j++) {\n      prob = parseFloat(parts[j]);\n      if (prob != parts[j] || prob < 0 || prob > 1) {\n        throw new Error(\"Expected probability but got '\" + parts[j] + \"'\"); \n      }\n      pspm[line_num][col_num] = prob;\n      col_num++;\n    }\n    line_num++;\n  }\n  if (typeof motif_length === \"number\") {\n    if (pspm.length != motif_length) {\n      throw new Error(\"Expected PSPM to have a motif length of \" + \n          motif_length + \" but it was actually \" + pspm.length);\n    }\n  } else {\n    motif_length = pspm.length;\n  }\n  if (typeof alph_length !== \"number\") {\n    alph_length = pspm[0].length;\n    if (alph_length != 4 && alph_length != 20) {\n      throw new Error(\"Expected length of first row in the PSPM to be \" +\n          \"either 4 or 20 but got \" + alph_length);\n    }\n  }\n  for (i = 0; i < pspm.length; i++) {\n    if (pspm[i].length != alph_length) {\n      throw new Error(\"Expected PSPM row \" + i + \" to have a length of \" + \n          alph_length + \" but the length was \" + pspm[i].length);\n    }\n  }\n  return {\"pspm\": pspm, \"motif_length\": motif_length, \n    \"alph_length\": alph_length, \"nsites\": nsites, \"evalue\": evalue};\n}\n//======================================================================\n// end Pspm object\n//======================================================================\n\n//======================================================================\n// start Logo object\n//======================================================================\n\nvar Logo = function(alphabet, options) {\n  \"use strict\";\n  this.alphabet = alphabet;\n  this.fine_text = \"\";\n  this.x_axis = 1;\n  this.y_axis = true;\n  this.xlate_nsyms = 1;\n  this.xlate_start = null;\n  this.xlate_end = null;\n  this.pspm_list = [];\n  this.pspm_column = [];\n  this.rows = 0;\n  this.columns = 0;\n  if (typeof options === \"string\") {\n    // the old method signature had fine_text here so we support that\n    this.fine_text = options;\n  } else if (typeof options === \"object\" && options != null) {\n    this.fine_text = (typeof options.fine_text === \"string\" ? options.fine_text : \"\");\n    this.x_axis = (typeof options.x_axis === \"boolean\" ? (options.x_axis ? 1 : 0) : 1);\n    if (options.x_axis_hidden != null && options.x_axis_hidden) this.x_axis = -1;\n    this.y_axis = (typeof options.y_axis === \"boolean\" ? options.y_axis : true);\n    this.xlate_nsyms = (typeof options.xlate_nsyms === \"number\" ? options.xlate_nsyms : this.xlate_nsyms);\n    this.xlate_start = (typeof options.xlate_start === \"number\" ? options.xlate_start : this.xlate_start);\n    this.xlate_end = (typeof options.xlate_end === \"number\" ? options.xlate_end : this.xlate_end);\n  }\n};\n\nLogo.prototype.add_pspm = function(pspm, column) {\n  \"use strict\";\n  var col;\n  if (typeof column === \"undefined\") {\n    column = 0;\n  } else if (column < 0) {\n    throw new Error(\"Column index out of bounds.\");\n  }\n  this.pspm_list[this.rows] = pspm;\n  this.pspm_column[this.rows] = column;\n  this.rows++;\n  col = column + pspm.get_motif_length();\n  if (col > this.columns) {\n    this.columns = col;\n  }\n};\n\nLogo.prototype.get_columns = function() {\n  \"use strict\";\n  return this.columns;\n};\n\nLogo.prototype.get_xlate_nsyms = function() {\n  \"use strict\";\n  return this.xlate_nsyms;\n};\n\nLogo.prototype.get_xlate_start = function() {\n  \"use strict\";\n  return (this.xlate_start != null ? this.xlate_start : 0);\n};\n\nLogo.prototype.get_xlate_end = function() {\n  \"use strict\";\n  return (this.xlate_end != null ? this.xlate_end : this.columns * this.xlate_nsyms);\n};\n\nLogo.prototype.get_xlate_columns = function() {\n  \"use strict\";\n  return this.get_xlate_end() - this.get_xlate_start();\n};\n\nLogo.prototype.get_rows = function() {\n  \"use strict\";\n  return this.rows;\n};\n\nLogo.prototype.get_pspm = function(row_index) {\n  \"use strict\";\n  if (row_index < 0 || row_index >= this.rows) {\n    throw new Error(\"INDEX_OUT_OF_BOUNDS\");\n  }\n  return this.pspm_list[row_index];\n};\n\nLogo.prototype.get_offset = function(row_index) {\n  \"use strict\";\n  if (row_index < 0 || row_index >= this.rows) {\n    throw new Error(\"INDEX_OUT_OF_BOUNDS\");\n  }\n  return this.pspm_column[row_index];\n};\n\nLogo.prototype._as_eps_data = function(ssc, errbars) {\n  var i, j, pos, stack_pos, pspm, stack, sym, out;\n  out = \"\";\n  for (i = 0; i < this.rows; i++) {\n    out += \"\\nStartLine\\n\";\n    // Indent\n    for (j = 0; j < this.pspm_column[i]; j++) {\n      out += \"() startstack\\nendstack\\n\\n\";\n    }\n    pspm = this.pspm_list[i];\n    if (pspm.get_left_trim() > 0) {\n      out += \"MuteColour\\nDrawTrimEdge\\n\" + pspm.get_left_trim() + \" DrawTrimBg\\n\";\n    }\n    for (pos = 0; pos < pspm.get_motif_length(); pos++) {\n      if (pos != 0 && pos == pspm.get_left_trim()) { // enable full colour\n        out += \"DrawTrimEdge\\nRestoreColour\\n\";\n      } else if (pos == (pspm.get_motif_length() - pspm.get_right_trim())) {\n        out += \"MuteColour\\n\" + pspm.get_right_trim() + \" DrawTrimBg\\n\";\n      }\n      out += \"(\" + (pos + 1) + \") startstack\\n\";\n      stack = pspm.get_stack(pos, this.alphabet, ssc);\n      for (stack_pos = 0; stack_pos < stack.length; stack_pos++) {\n        sym = stack[stack_pos];\n        out += \" \" + (sym.get_scale() * this.alphabet.get_ic()) + \" (\" + sym.get_symbol() + \") numchar\\n\";\n      }\n      if (errbars) {\n        out += \" \" + pspm.get_error(this.alphabet) + \" Ibeam\\n\";\n      }\n      out += \"endstack\\n\\n\";\n    }\n    if (pspm.get_right_trim() > 0 || pspm.get_left_trim() == pspm.get_motif_length()) {\n      out += \"RestoreColour\\n\";\n    }\n    out += \"EndLine\\n\";\n  }\n  return out;\n};\n\nLogo.prototype.as_eps = function(options) {\n  \"use strict\";\n  if (this.xlate_nsyms != 1) throw new Error(\"Unsupported setting xlate_nsyms for EPS\");\n  if (this.xlate_start != null) throw new Error(\"Unsupported setting xlate_start for EPS\");\n  if (this.xlate_end != null) throw new Error(\"Unsupported setting xlate_end for EPS\");\n\n  var LOGOHEIGHT = 7.5; // default height of line in cm\n  var cm2pts, height, width, now, ssc, errbars;\n  if (typeof options === \"undefined\") {\n    options = {};\n  }\n  cm2pts = 72 / 2.54;\n  if (typeof options.logo_height == \"number\") {\n    height = options.logo_height;\n  } else {\n    height = LOGOHEIGHT * this.rows;\n  }\n  if (typeof options.logo_width == \"number\") {\n    width = options.logo_width;\n  } else {\n    width = this.columns + 2;\n  }\n  now = new Date();\n  ssc = (typeof options.ssc == \"boolean\" ? options.ssc : false);\n  errbars = (typeof options.show_error_bar == \"boolean\" ? options.show_error_bar : ssc);\n  var values = {\n    \"LOGOHEIGHT\": height,\n    \"LOGOWIDTH\": width,\n    \"BOUNDINGHEIGHT\": Math.round(height * cm2pts),\n    \"BOUNDINGWIDTH\": Math.round(width * cm2pts),\n    \"LOGOLINEHEIGHT\": (height / this.rows),\n    \"CHARSPERLINE\": this.columns,\n    \"BARBITS\": this.alphabet.get_ic(),\n    \"LOGOTYPE\": (this.alphabet.has_complement() ? \"NA\" : \"AA\"),\n    \"CREATIONDATE\": now.getDate() + \".\" + (now.getMonth() + 1) + \".\" + now.getFullYear() + \" \" + now.getHours() + \":\" + now.getMinutes() + \":\" + now.getSeconds(),\n    \"ERRORBARFRACTION\": (typeof options.error_bar_fraction == \"number\" ? options.error_bar_fraction : 1.0),\n    \"TICBITS\": (typeof options.ticbits == \"number\" ? options.ticbits : 1.0),\n    \"TITLE\": (typeof options.title == \"string\" ? options.title : \"\"),\n    \"FINEPRINT\": (typeof options.fineprint == \"string\" ? options.fineprint : this.fine_text),\n    \"XAXISLABEL\": (typeof options.xaxislabel == \"string\" ? options.xaxislabel : \"\"),\n    \"YAXISLABEL\": (typeof options.yaxislabel == \"string\" ? options.yaxislabel : \"bits\"),\n    \"SSC\": ssc,\n    \"YAXIS\": (typeof options.show_y_axis == \"boolean\" ? options.show_y_axis : this.y_axis),\n    \"SHOWENDS\": (typeof options.show_ends == \"boolean\" ? options.show_ends : false),\n    \"ERRBAR\": errbars,\n    \"OUTLINE\": (typeof options.show_outline == \"boolean\" ? options.show_outline : false),\n    \"NUMBERING\": (typeof options.show_numbering == \"boolean\" ? options.show_numbering : this.x_axis != 0),\n    \"SHOWINGBOX\": (typeof options.show_box == \"boolean\" ? options.show_box : false),\n    \"CREATOR\": (typeof options.creator == \"string\" ? options.creator : \"motif_logo.js\"),\n    \"FONTSIZE\": (typeof options.label_font_size == \"number\" ? options.label_font_size : 12),\n    \"TITLEFONTSIZE\": (typeof options.title_font_size == \"number\" ? options.title_font_size : 12),\n    \"SMALLFONTSIZE\": (typeof options.small_font_size == \"number\" ? options.small_font_size : 6),\n    \"TOPMARGIN\" : (typeof options.top_margin == \"number\" ? options.top_margin : 0.9),\n    \"BOTTOMMARGIN\": (typeof options.bottom_margin == \"number\" ? options.bottom_margin : 0.9),\n    \"COLORDICT\": this.alphabet._as_eps_dict(),\n    \"DATA\": this._as_eps_data(ssc, errbars)\n  };\n  // now this requires that the script containing the template has been imported!\n  return motif_logo_template(values);\n};\n\n//======================================================================\n// end Logo object\n//======================================================================\n\n// calculate the exact size (in pixels) of an object drawn on the\n// canvas assuming that the background of the canvas is transparent.\nfunction canvas_bounds(ctx, cwidth, cheight) {\n  \"use strict\";\n  var data, r, c, top_line, bottom_line, left_line, right_line, \n      txt_width, txt_height;\n\n  // extract the image data\n  data = ctx.getImageData(0, 0, cwidth, cheight).data;\n\n  // set initial values\n  top_line = -1; bottom_line = -1; left_line = -1; right_line = -1;\n  txt_width = 0; txt_height = 0;\n\n  // Find the top-most line with a non-transparent pixel\n  for (r = 0; r < cheight; r++) {\n    for (c = 0; c < cwidth; c++) {\n      if (data[r * cwidth * 4 + c * 4 + 3]) {\n        top_line = r;\n        break;\n      }\n    }\n    if (top_line != -1) {\n      break;\n    }\n  }\n  \n  // Only bother looking if we found at least one set pixel... \n  if (top_line != -1) {\n\n    //find the last line with a non-transparent pixel\n    for (r = cheight-1; r >= top_line; r--) {\n      for(c = 0; c < cwidth; c++) {\n        if(data[r * cwidth * 4 + c * 4 + 3]) {\n          bottom_line = r;\n          break;\n        }\n      }\n      if (bottom_line != -1) {\n        break;\n      }\n    }\n    // calculate height\n    txt_height = bottom_line - top_line + 1;\n\n    // Find the left-most line with a non-transparent pixel\n    for (c = 0; c < cwidth; c++) {\n      for (r = top_line; r <= bottom_line; r++) {\n        if (data[r * cwidth * 4 + c * 4 + 3]) {\n          left_line = c;\n          break;\n        }\n      }\n      if (left_line != -1) {\n        break;\n      }\n    }\n\n    //find the right most line with a non-transparent pixel\n    for (c = cwidth-1; c >= left_line; c--) {\n      for(r = top_line; r <= bottom_line; r++) {\n        if(data[r * cwidth * 4 + c * 4 + 3]) {\n          right_line = c;\n          break;\n        }\n      }\n      if (right_line != -1) {\n        break;\n      }\n    }\n    txt_width = right_line - left_line + 1;\n  }\n\n  //return the bounds\n  return {bound_top: top_line, bound_bottom: bottom_line, \n    bound_left: left_line, bound_right: right_line, width: txt_width, \n    height: txt_height};\n}\n\n//======================================================================\n// start RasterizedAlphabet\n//======================================================================\n\n// Rasterize Alphabet\n// 1) Measure width of text at default font for all symbols in alphabet\n// 2) sort in width ascending\n// 3) Drop the top and bottom 10% (designed to ignore outliers like 'W' and 'I')\n// 4) Calculate the average as the maximum scaling factor (designed to stop I becoming a rectangular blob).\n// 5) Assume scale of zero would result in width of zero, interpolate scale required to make perfect width font\n// 6) Draw text onto temp canvas at calculated scale\n// 7) Find bounds of drawn text\n// 8) Paint on to another canvas at the desired height (but only scaling width to fit if larger).\nvar RasterizedAlphabet = function(alphabet, logo_scale, font, width) {\n  \"use strict\";\n  var default_size, safety_pad, canvas, ctx, middle, baseline, widths, sizes,\n      i, sym, size, tenpercent, avg_width, scale, \n      target_width, target_height;\n  //variable prototypes\n  this.alphabet = alphabet;\n  this.scale = logo_scale;\n  this.sym_cache = {};\n  this.stack_num_cache = [];\n  this.scale_num_cache = [];\n  // size of canvas\n  default_size = 60; // size of measuring canvas\n  safety_pad = 20; // pixels to pad around so we don't miss the edges\n  // create a canvas to do our measuring\n  canvas = document.createElement(\"canvas\");\n  if (!canvas.getContext) throw new Error(\"No canvas support\");\n  canvas.width = default_size + 2 * safety_pad;\n  canvas.height = default_size + 2 * safety_pad;\n  middle = Math.round(canvas.width / 2);\n  baseline = Math.round(canvas.height - safety_pad);\n  ctx = canvas.getContext('2d');\n  if (!supports_text(ctx)) throw new Error(\"Canvas does not support text\");\n  ctx.font = font;\n  ctx.textAlign = \"center\";\n  ctx.translate(middle, baseline);\n  // list of widths\n  widths = [];\n  sizes = [];\n  //now measure each letter in the alphabet\n  for (i = 0; i < alphabet.get_size_core(); ++i) {\n    // reset the canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.fillStyle = alphabet.get_colour(i);\n    // draw the test text\n    ctx.fillText(alphabet.get_symbol(i), 0, 0);\n    //measure\n    size = canvas_bounds(ctx, canvas.width, canvas.height);\n    if (size.width === 0) throw new Error(\"Invisible symbol!\");\n    widths.push(size.width);\n    sizes[i] = size;\n  }\n  //sort the widths\n  widths.sort(function(a,b) {return a - b;});\n  //drop 10% of the items off each end\n  tenpercent = Math.floor(widths.length / 10);\n  for (i = 0; i < tenpercent; ++i) {\n    widths.pop();\n    widths.shift();\n  }\n  //calculate average width\n  avg_width = 0;\n  for (i = 0; i < widths.length; ++i) {\n    avg_width += widths[i];\n  }\n  avg_width /= widths.length;\n  // calculate the target width\n  target_width = width * this.scale * 2;\n  // calculate scales\n  for (i = 0; i < alphabet.get_size_core(); ++i) {\n    sym = alphabet.get_symbol(i);\n    size = sizes[i];\n    // calculate scale\n    scale = target_width / Math.max(avg_width, size.width);\n    // estimate scaled height\n    target_height = size.height * scale;\n    // create an appropriately sized canvas\n    canvas = document.createElement(\"canvas\");\n    canvas.width = target_width;\n    canvas.height = target_height + safety_pad * 2;\n    // calculate the middle\n    middle = Math.round(canvas.width / 2);\n    // calculate the baseline\n    baseline = Math.round(canvas.height - safety_pad);\n    // get the context and prepare to draw the rasterized text\n    ctx = canvas.getContext('2d');\n    ctx.font = font;\n    ctx.fillStyle = alphabet.get_colour(i);\n    ctx.textAlign = \"center\";\n    ctx.translate(middle, baseline);\n    ctx.save();\n    ctx.scale(scale, scale);\n    // draw the text\n    ctx.fillText(sym, 0, 0);\n    ctx.restore();\n    this.sym_cache[sym] = {\"image\": canvas, \"size\": canvas_bounds(ctx, canvas.width, canvas.height)};\n  }\n};\n\nRasterizedAlphabet.prototype.get_alphabet = function() {\n  return this.alphabet;\n};\n\nRasterizedAlphabet.prototype.get_scale = function() {\n  return this.scale;\n};\n\nRasterizedAlphabet.prototype.draw_stack_sym = function(ctx, letter, dx, dy, dWidth, dHeight) {\n  \"use strict\";\n  var entry, image, size;\n  entry = this.sym_cache[letter];\n  image = entry.image;\n  size = entry.size;\n  ctx.drawImage(image, 0, size.bound_top -1, image.width, size.height+1, dx, dy, dWidth, dHeight);\n};\n\nRasterizedAlphabet.prototype.draw_stack_num = function(ctx, font, stack_width, index) {\n  var image, image_ctx, text_length;\n  if (index >= this.stack_num_cache.length) {\n    image = document.createElement(\"canvas\");\n    // measure the text\n    image_ctx = image.getContext('2d');\n    image_ctx.save();\n    image_ctx.font = font;\n    text_length = image_ctx.measureText(\"\" + (index + 1)).width;\n    image_ctx.restore();\n    // resize the canvas to fit\n    image.width = Math.ceil(stack_width);\n    image.height = Math.ceil(text_length);\n    // draw the text\n    image_ctx = image.getContext('2d');\n    image_ctx.translate(Math.round(stack_width / 2), 0);\n    image_ctx.font = font;\n    image_ctx.textBaseline = \"middle\";\n    image_ctx.textAlign = \"right\";\n    image_ctx.rotate(-(Math.PI / 2));\n    image_ctx.fillText(\"\" + (index + 1), 0, 0);\n    this.stack_num_cache[index] = image;\n  } else {\n    image = this.stack_num_cache[index];\n  }\n  ctx.drawImage(image, 0, 0);\n}\n\nRasterizedAlphabet.prototype.draw_scale_num = function(ctx, font, num) {\n  var image, image_ctx, text_size, m_length;\n  if (num >= this.scale_num_cache.length) {\n    image = document.createElement(\"canvas\");\n    // measure the text\n    image_ctx = image.getContext('2d');\n    image_ctx.font = font;\n    text_size = image_ctx.measureText(\"\" + num);\n    if (text_size.actualBoundingBoxAscent && text_size.actualBoundingBoxDesent) {\n      // resize the canvas to fit\n      image.width = Math.ceil(text_size.width);\n      image.height = Math.ceil(text_size.actualBoundingBoxAscent + text_size.actualBoundingBoxDesent);\n      // draw the text\n      image_ctx = image.getContext('2d');\n      image_ctx.font = font;\n      image_ctx.textAlign = \"right\";\n      image_ctx.fillText(\"\" + num, image.width, text_size.actualBoundingBoxAscent);\n    } else {\n      // measure width of 'm' to approximate height, we double it later anyway\n      m_length = image_ctx.measureText(\"m\").width;\n      // resize the canvas to fit\n      image.width = Math.ceil(text_size.width);\n      image.height = Math.ceil(2 * m_length);\n      // draw the text\n      image_ctx = image.getContext('2d');\n      image_ctx.font = font;\n      image_ctx.textAlign = \"right\";\n      image_ctx.textBaseline = \"middle\";\n      image_ctx.fillText(\"\" + num, image.width, m_length);\n    }\n    this.scale_num_cache[num] = image;\n  } else {\n    image = this.scale_num_cache[num];\n  }\n  ctx.drawImage(image, -image.width, -Math.round(image.height / 2))\n}\n\n//======================================================================\n// end RasterizedAlphabet\n//======================================================================\n\n//======================================================================\n// start LogoMetrics object\n//======================================================================\n\nvar LogoMetrics = function(ctx, logo_columns, logo_rows, has_names, has_finetext, x_axis, y_axis) {\n  \"use strict\";\n  var i, row_height;\n  //variable prototypes\n  this.pad_top = (has_names ? 5 : 0);\n  this.pad_left = (y_axis ? 10 : 0);\n  this.pad_right = (has_finetext ? 15 : 0);\n  this.pad_bottom = 0;\n  this.pad_middle = 20;\n  this.name_height = 14;\n  this.name_font = \"bold \" + this.name_height + \"px Times, sans-serif\";\n  this.name_spacer = 0;\n  this.y_axis = y_axis;\n  this.y_label = \"bits\";\n  this.y_label_height = 12;\n  this.y_label_font = \"bold \" + this.y_label_height + \"px Helvetica, sans-serif\";\n  this.y_label_spacer = 3;\n  this.y_num_height = 12;\n  this.y_num_width = 0;\n  this.y_num_font = \"bold \" + this.y_num_height + \"px Helvetica, sans-serif\";\n  this.y_tic_width = 5;\n  this.stack_pad_left = 0;\n  this.stack_font = \"bold 25px Helvetica, sans-serif\";\n  this.stack_height = 90;\n  this.stack_width = 26;\n  this.stacks_pad_right = 5;\n  this.x_axis = x_axis;\n  this.x_num_above = 2;\n  this.x_num_height = 12;\n  this.x_num_width = 0;\n  this.x_num_font = \"bold \" + this.x_num_height + \"px Helvetica, sans-serif\";\n  this.fine_txt_height = 6;\n  this.fine_txt_above = 2;\n  this.fine_txt_font = \"normal \" + this.fine_txt_height + \"px Helvetica, sans-serif\";\n  this.letter_metrics = new Array();\n  this.summed_width = 0;\n  this.summed_height = 0;\n  //calculate the width of the y axis numbers\n  ctx.font = this.y_num_font;\n  for (i = 0; i <= 2; i++) {\n    this.y_num_width = Math.max(this.y_num_width, ctx.measureText(\"\" + i).width);\n  }\n  //calculate the width of the x axis numbers (but they are rotated so it becomes height)\n  if (x_axis == 1) {\n    ctx.font = this.x_num_font;\n    for (i = 1; i <= logo_columns; i++) {\n      this.x_num_width = Math.max(this.x_num_width, ctx.measureText(\"\" + i).width);\n    }\n  } else if (x_axis == 0) {\n    this.x_num_height = 4;\n    this.x_num_width = 4;\n  } else {\n    this.x_num_height = 0;\n    this.x_num_width = 0;\n  }\n  \n  //calculate how much vertical space we want to draw this\n  //first we add the padding at the top and bottom since that's always there\n  this.summed_height += this.pad_top + this.pad_bottom;\n  //all except the last row have the same amount of space allocated to them\n  if (logo_rows > 1) {\n    row_height = this.stack_height + this.pad_middle;\n    if (has_names) {\n      row_height += this.name_height;\n      //the label is allowed to overlap into the spacer\n      row_height += Math.max(this.y_num_height/2, this.name_spacer); \n      //the label is allowed to overlap the space used by the other label\n      row_height += Math.max(this.y_num_height/2, this.x_num_height + this.x_num_above); \n    } else {\n      row_height += this.y_num_height/2; \n      //the label is allowed to overlap the space used by the other label\n      row_height += Math.max(this.y_num_height/2, this.x_num_height + this.x_num_above); \n    }\n    this.summed_height += row_height * (logo_rows - 1);\n  }\n  //the last row has the name and fine text below it but no padding\n  this.summed_height += this.stack_height + (this.y_axis ? this.y_num_height/2 : 0);\n\n  var fine_txt_total = (has_finetext ? this.fine_txt_height + this.fine_txt_above : 0);\n  if (has_names) {\n    this.summed_height += fine_txt_total + this.name_height;\n    this.summed_height += Math.max((this.y_axis ? this.y_num_height/2 : 0), \n        this.x_num_height + this.x_num_above + this.name_spacer);\n  } else {\n    this.summed_height += Math.max((this.y_axis ? this.y_num_height/2 : 0), \n        this.x_num_height + this.x_num_above + fine_txt_total);\n  }\n\n  //calculate how much horizontal space we want to draw this\n  //first add the padding at the left and right since that's always there\n  this.summed_width += this.pad_left + this.pad_right;\n  if (this.y_axis) {\n    //add on the space for the y-axis label\n    this.summed_width += this.y_label_height + this.y_label_spacer;\n    //add on the space for the y-axis\n    this.summed_width += this.y_num_width + this.y_tic_width;\n  }\n  //add on the space for the stacks\n  this.summed_width += (this.stack_pad_left + this.stack_width) * logo_columns;\n  //add on the padding after the stacks (an offset from the fine text)\n  this.summed_width += this.stacks_pad_right;\n\n};\n\n//======================================================================\n// end LogoMetrics object\n//======================================================================\n\n//found this trick at http://talideon.com/weblog/2005/02/detecting-broken-images-js.cfm\nfunction image_ok(img) {\n  \"use strict\";\n  // During the onload event, IE correctly identifies any images that\n  // weren't downloaded as not complete. Others should too. Gecko-based\n  // browsers act like NS4 in that they report this incorrectly.\n  if (!img.complete) {\n    return false;\n  }\n  // However, they do have two very useful properties: naturalWidth and\n  // naturalHeight. These give the true size of the image. If it failed\n  // to load, either of these should be zero.\n  if (typeof img.naturalWidth !== \"undefined\" && img.naturalWidth === 0) {\n    return false;\n  }\n  // No other way of checking: assume it's ok.\n  return true;\n}\n  \nfunction supports_text(ctx) {\n  \"use strict\";\n  if (!ctx.fillText) {\n    return false;\n  }\n  if (!ctx.measureText) {\n    return false;\n  }\n  return true;\n}\n\n//draws the scale, returns the width\nfunction draw_scale(ctx, metrics, alphabet_ic, raster) {\n  \"use strict\";\n  var tic_height, i;\n  tic_height = metrics.stack_height / alphabet_ic;\n  ctx.save();\n  ctx.translate(metrics.y_label_height, metrics.y_num_height/2);\n  //draw the axis label\n  ctx.save();\n  ctx.font = metrics.y_label_font;\n  ctx.translate(0, metrics.stack_height/2);\n  ctx.rotate(-(Math.PI / 2));\n  ctx.textAlign = \"center\";\n  ctx.fillText(\"bits\", 0, 0);\n  ctx.restore();\n\n  ctx.translate(metrics.y_label_spacer + metrics.y_num_width, 0);\n\n  //draw the axis tics\n  ctx.save();\n  ctx.translate(0, metrics.stack_height);\n  for (i = 0; i <= alphabet_ic; i++) {\n    //draw the number\n    ctx.save();\n    ctx.translate(-1, 0);\n    raster.draw_scale_num(ctx, metrics.y_num_font, i);\n    ctx.restore();\n    //draw the tic\n    ctx.fillRect(0, -1, metrics.y_tic_width, 2);\n    //prepare for next tic\n    ctx.translate(0, -tic_height);\n  }\n  ctx.restore();\n\n  ctx.fillRect(metrics.y_tic_width - 2, 0, 2, metrics.stack_height)\n\n  ctx.restore();\n}\n\nfunction draw_stack_num(ctx, metrics, row_index, raster) {\n  \"use strict\";\n  ctx.save();\n  ctx.translate(0, Math.round(metrics.stack_height + metrics.x_num_above));\n  if (metrics.x_axis == 1) {\n    raster.draw_stack_num(ctx, metrics.x_num_font, metrics.stack_width, row_index);\n  } else if (metrics.x_axis == 0) {\n    // draw dots instead of the numbers (good for small logos)\n    ctx.beginPath();\n    var radius = Math.round(metrics.x_num_height / 2);\n    ctx.arc(Math.round(metrics.stack_width / 2), radius, radius, 0, 2 * Math.PI, false);\n    ctx.fill();\n  }\n  ctx.restore();\n}\n\nfunction draw_stack(ctx, metrics, symbols, raster) {\n  \"use strict\";\n  var preferred_pad, sym_min, i, sym, sym_height, pad;\n  preferred_pad = 0;\n  sym_min = 5;\n\n  ctx.save();//1\n  ctx.translate(0, metrics.stack_height);\n  for (i = 0; i < symbols.length; i++) {\n    sym = symbols[i];\n    sym_height = metrics.stack_height * sym.get_scale();\n    \n    pad = preferred_pad;\n    if (sym_height - pad < sym_min) {\n      pad = Math.min(pad, Math.max(0, sym_height - sym_min));\n    }\n    sym_height -= pad;\n\n    //translate to the correct position\n    ctx.translate(0, -(pad/2 + sym_height));\n\n    //draw\n    raster.draw_stack_sym(ctx, sym.get_symbol(), 0, 0, metrics.stack_width, sym_height);\n    //translate past the padding\n    ctx.translate(0, -(pad/2));\n  }\n  ctx.restore();//1\n}\n\nfunction draw_dashed_line(ctx, pattern, start, x1, y1, x2, y2) {\n  \"use strict\";\n  var x, y, len, i, dx, dy, tlen, theta, mulx, muly, lx, ly;\n  dx = x2 - x1;\n  dy = y2 - y1;\n  tlen = Math.pow(dx*dx + dy*dy, 0.5);\n  theta = Math.atan2(dy,dx);\n  mulx = Math.cos(theta);\n  muly = Math.sin(theta);\n  lx = [];\n  ly = [];\n  for (i = 0; i < pattern; ++i) {\n    lx.push(pattern[i] * mulx);\n    ly.push(pattern[i] * muly);\n  }\n  i = start;\n  x = x1;\n  y = y1;\n  len = 0;\n  ctx.beginPath();\n  while (len + pattern[i] < tlen) {\n    ctx.moveTo(x, y);\n    x += lx[i];\n    y += ly[i];\n    ctx.lineTo(x, y);\n    len += pattern[i];\n    i = (i + 1) % pattern.length;\n    x += lx[i];\n    y += ly[i];\n    len += pattern[i];\n    i = (i + 1) % pattern.length;\n  }\n  if (len < tlen) {\n    ctx.moveTo(x, y);\n    x += mulx * (tlen - len);\n    y += muly * (tlen - len);\n    ctx.lineTo(x, y);\n  }\n  ctx.stroke();\n}\n\nfunction draw_trim_background(ctx, metrics, left_start, left_end, left_divider, right_start, right_end, right_divider) {\n  \"use strict\";\n  var left_size = left_end - left_start;\n  var right_size = right_end - right_start;\n  var line_x;\n\n  ctx.save();//s8\n  ctx.fillStyle = \"rgb(240, 240, 240)\";\n  if (left_size > 0) {\n    ctx.fillRect(left_start * metrics.stack_width, 0, left_size * metrics.stack_width, metrics.stack_height);\n  }\n  if (right_size > 0) {\n    ctx.fillRect(right_start * metrics.stack_width, 0, right_size * metrics.stack_width, metrics.stack_height);\n  }\n  ctx.fillStyle = \"rgb(51, 51, 51)\";\n  if (left_size > 0 && left_divider) {\n    line_x = (left_end * metrics.stack_width) - 0.5;\n    draw_dashed_line(ctx, [3], 0, line_x, 0, line_x, metrics.stack_height);\n  }\n  if (right_size > 0 && right_divider) {\n    line_x = (right_start * metrics.stack_width) + 0.5;\n    draw_dashed_line(ctx, [3], 0, line_x, 0, line_x, metrics.stack_height);\n  }\n  ctx.restore();//s8\n}\n\nfunction size_logo_on_canvas(logo, canvas, show_names, scale) {\n  \"use strict\";\n  var draw_name, draw_finetext, metrics;\n  draw_name = (typeof show_names === \"boolean\" ? show_names : (logo.get_rows() > 1));\n  draw_finetext = (logo.fine_text.length > 0);\n  if (canvas.width !== 0 && canvas.height !== 0) {\n    return;\n  }\n  metrics = new LogoMetrics(canvas.getContext('2d'), \n      logo.get_xlate_columns(), logo.get_rows(), draw_name, draw_finetext, logo.x_axis, logo.y_axis);\n  if (typeof scale == \"number\") {\n    //resize the canvas to fit the scaled logo\n    canvas.width = metrics.summed_width * scale;\n    canvas.height = metrics.summed_height * scale;\n  } else {\n    if (canvas.width === 0 && canvas.height === 0) {\n      canvas.width = metrics.summed_width;\n      canvas.height = metrics.summed_height;\n    } else if (canvas.width === 0) {\n      canvas.width = metrics.summed_width * (canvas.height / metrics.summed_height);\n    } else if (canvas.height === 0) {\n      canvas.height = metrics.summed_height * (canvas.width / metrics.summed_width);\n    }\n  }\n}\n\nfunction draw_logo_on_canvas(logo, canvas, show_names, scale) {\n  \"use strict\";\n  var i, draw_name, draw_finetext, ctx, metrics, raster, pspm_i, pspm, \n      offset, col_index, motif_position, ssc;\n  ssc = false;\n  draw_name = (typeof show_names === \"boolean\" ? show_names : (logo.get_rows() > 1));\n  draw_finetext = (logo.fine_text.length > 0);\n  ctx = canvas.getContext('2d');\n  //assume that the user wants the canvas scaled equally so calculate what the best width for this image should be\n  metrics = new LogoMetrics(ctx, logo.get_xlate_columns(), logo.get_rows(), draw_name, draw_finetext, logo.x_axis, logo.y_axis);\n  if (typeof scale == \"number\") {\n    //resize the canvas to fit the scaled logo\n    canvas.width = metrics.summed_width * scale;\n    canvas.height = metrics.summed_height * scale;\n  } else {\n    if (canvas.width === 0 && canvas.height === 0) {\n      scale = 1;\n      canvas.width = metrics.summed_width;\n      canvas.height = metrics.summed_height;\n    } else if (canvas.width === 0) {\n      scale = canvas.height / metrics.summed_height;\n      canvas.width = metrics.summed_width * scale;\n    } else if (canvas.height === 0) {\n      scale = canvas.width / metrics.summed_width;\n      canvas.height = metrics.summed_height * scale;\n    } else {\n      scale = Math.min(canvas.width / metrics.summed_width, canvas.height / metrics.summed_height);\n    }\n  }\n  // cache the raster based on the assumption that we will be drawing a lot\n  // of logos the same size and alphabet\n  if (typeof draw_logo_on_canvas.raster_cache === \"undefined\") {\n    draw_logo_on_canvas.raster_cache = [];\n  }\n  for (i = 0; i < draw_logo_on_canvas.raster_cache.length; i++) {\n    raster = draw_logo_on_canvas.raster_cache[i];\n    if (raster.get_alphabet().equals(logo.alphabet) &&\n        Math.abs(raster.get_scale() - scale) < 0.1) break;\n    raster = null;\n  }\n  if (raster == null) {\n    raster = new RasterizedAlphabet(logo.alphabet, scale, metrics.stack_font, metrics.stack_width);\n    draw_logo_on_canvas.raster_cache.push(raster);\n  }\n  ctx = canvas.getContext('2d');\n  ctx.save();//s1\n  ctx.scale(scale, scale);\n  ctx.save();//s2\n  ctx.save();//s7\n  //create margin\n  ctx.translate(Math.round(metrics.pad_left), Math.round(metrics.pad_top));\n  for (pspm_i = 0; pspm_i < logo.get_rows(); ++pspm_i) {\n    pspm = logo.get_pspm(pspm_i);\n    offset = logo.get_offset(pspm_i);\n    //optionally draw name if this isn't the last row or is the only row \n    if (draw_name && (logo.get_rows() == 1 || pspm_i != (logo.get_rows()-1))) {\n      ctx.save();//s4\n      ctx.translate(Math.round(metrics.summed_width/2), Math.round(metrics.name_height));\n      ctx.font = metrics.name_font;\n      ctx.textAlign = \"center\";\n      ctx.fillText(pspm.name, 0, 0);\n      ctx.restore();//s4\n      ctx.translate(0, Math.round(metrics.name_height + \n          Math.min(0, metrics.name_spacer - metrics.y_num_height/2)));\n    }\n    //draw scale\n    if (logo.y_axis) draw_scale(ctx, metrics, logo.alphabet.get_ic(), raster);\n    ctx.save();//s5\n    //translate across past the scale\n    if (logo.y_axis) {\n      ctx.translate(Math.round(metrics.y_label_height + metrics.y_label_spacer + \n        metrics.y_num_width + metrics.y_tic_width), Math.round(metrics.y_num_height / 2));\n    }\n    //draw the trimming background\n    if (pspm.get_left_trim() > 0 || pspm.get_right_trim() > 0) {\n      var left_start = offset * logo.get_xlate_nsyms();\n      var left_end = (offset + pspm.get_left_trim()) * logo.get_xlate_nsyms();\n      var left_divider = true;\n      if (left_end < logo.get_xlate_start() || left_start > logo.get_xlate_end()) {\n        // no overlap\n        left_start = 0;\n        left_end = 0;\n        left_divider = false;\n      } else {\n        if (left_start < logo.get_xlate_start()) {\n          left_start = logo.get_xlate_start();\n        }\n        if (left_end > logo.get_xlate_end()) {\n          left_end = logo.get_xlate_end();\n          left_divider = false;\n        }\n        left_start -= logo.get_xlate_start();\n        left_end -= logo.get_xlate_start();\n        if (left_end < left_start) {\n          left_start = 0;\n          left_end = 0;\n          left_divider = false;\n        }\n      }\n      var right_end = (offset + pspm.get_motif_length()) * logo.get_xlate_nsyms();\n      //var right_start = right_end - (pspm.get_left_trim() * logo.get_xlate_nsyms());\n      var right_start = right_end - (pspm.get_right_trim() * logo.get_xlate_nsyms());\n      var right_divider = true;\n      if (right_end < logo.get_xlate_start() || right_start > logo.get_xlate_end()) {\n        // no overlap\n        right_start = 0;\n        right_end = 0;\n        right_divider = false;\n      } else {\n        if (right_start < logo.get_xlate_start()) {\n          right_start = logo.get_xlate_start();\n          right_divider = false;\n        }\n        if (right_end > logo.get_xlate_end()) {\n          right_end = logo.get_xlate_end();\n        }\n        right_start -= logo.get_xlate_start();\n        right_end -= logo.get_xlate_start();\n        if (right_end < right_start) {\n          right_start = 0;\n          right_end = 0;\n          right_divider = false;\n        }\n      }\n      draw_trim_background(ctx, metrics, left_start, left_end, left_divider, right_start, right_end, right_divider);\n    }\n    //draw letters\n    var xlate_col;\n    for (xlate_col = logo.get_xlate_start(); xlate_col < logo.get_xlate_end(); xlate_col++) {\n      ctx.translate(metrics.stack_pad_left,0);\n      col_index = Math.floor(xlate_col / logo.get_xlate_nsyms());\n      if (xlate_col % logo.get_xlate_nsyms() == 0) {\n        if (col_index >= offset && col_index < (offset + pspm.get_motif_length())) {\n          motif_position = col_index - offset;\n          draw_stack_num(ctx, metrics, motif_position, raster);\n          draw_stack(ctx, metrics, pspm.get_stack(motif_position, logo.alphabet, ssc), raster);\n        }\n      } else {\n        if (col_index >= offset && col_index < (offset + pspm.get_motif_length())) {\n          ctx.save();// s5.1\n          ctx.translate(0, Math.round(metrics.stack_height));\n          // TODO draw a dot or dash or something to indicate continuity of the motif\n          ctx.restore(); //s5.1\n        }\n      }\n      ctx.translate(Math.round(metrics.stack_width), 0);\n    }\n    ctx.restore();//s5\n    ////optionally draw name if this is the last row but isn't the only row \n    if (draw_name && (logo.get_rows() != 1 && pspm_i == (logo.get_rows()-1))) {\n      //translate vertically past the stack and axis's        \n      ctx.translate(0, metrics.y_num_height/2 + metrics.stack_height + \n          Math.max(metrics.y_num_height/2, metrics.x_num_above + metrics.x_num_width + metrics.name_spacer));\n\n      ctx.save();//s6\n      ctx.translate(metrics.summed_width/2, metrics.name_height);\n      ctx.font = metrics.name_font;\n      ctx.textAlign = \"center\";\n      ctx.fillText(pspm.name, 0, 0);\n      ctx.restore();//s6\n      ctx.translate(0, metrics.name_height);\n    } else {\n      //translate vertically past the stack and axis's        \n      ctx.translate(0, metrics.y_num_height/2 + metrics.stack_height + \n          Math.max(metrics.y_num_height/2, metrics.x_num_above + metrics.x_num_width));\n    }\n    //if not the last row then add middle padding\n    if (pspm_i != (logo.get_rows() -1)) {\n      ctx.translate(0, metrics.pad_middle);\n    }\n  }\n  ctx.restore();//s7\n  if (logo.fine_text.length > 0) {\n    ctx.translate(metrics.summed_width - metrics.pad_right, metrics.summed_height - metrics.pad_bottom);\n    ctx.font = metrics.fine_txt_font;\n    ctx.textAlign = \"right\";\n    ctx.fillText(logo.fine_text, 0,0);\n  }\n  ctx.restore();//s2\n  ctx.restore();//s1\n}\n\nfunction create_canvas(c_width, c_height, c_id, c_title, c_display) {\n  \"use strict\";\n  var canvas = document.createElement(\"canvas\");\n  //check for canvas support before attempting anything\n  if (!canvas.getContext) {\n    return null;\n  }\n  var ctx = canvas.getContext('2d');\n  //check for html5 text drawing support\n  if (!supports_text(ctx)) {\n    return null;\n  }\n  //size the canvas\n  canvas.width = c_width;\n  canvas.height = c_height;\n  canvas.id = c_id;\n  canvas.title = c_title;\n  canvas.style.display = c_display;\n  return canvas;\n}\n\nfunction logo_1(alphabet, fine_text, pspm) {\n  \"use strict\";\n  var logo = new Logo(alphabet, fine_text);\n  logo.add_pspm(pspm);\n  return logo;\n}\n\nfunction logo_2(alphabet, fine_text, target, query, query_offset) {\n  \"use strict\";\n  var logo = new Logo(alphabet, fine_text);\n  if (query_offset < 0) {\n    logo.add_pspm(target, -query_offset);\n    logo.add_pspm(query);\n  } else {\n    logo.add_pspm(target);\n    logo.add_pspm(query, query_offset);\n  }      \n  return logo;\n}\n\n/*\n * Specifies an alternate source for an image.\n * If the image with the image_id specified has\n * not loaded then a generated logo will be used \n * to replace it.\n *\n * Note that the image must either have dimensions\n * or a scale must be set.\n */\nfunction alternate_logo(logo, image_id, scale) {\n  \"use strict\";\n  var image = document.getElementById(image_id);\n  if (!image) {\n    alert(\"Can't find specified image id (\" +  image_id + \")\");\n    return;\n  }\n  //if the image has loaded then there is no reason to use the canvas\n  if (image_ok(image)) {\n    return;\n  }\n  //the image has failed to load so replace it with a canvas if we can.\n  var canvas = create_canvas(image.width, image.height, image_id, image.title, image.style.display);\n  if (canvas === null) {\n    return;\n  }\n  //draw the logo on the canvas\n  draw_logo_on_canvas(logo, canvas, null, scale);\n  //replace the image with the canvas\n  image.parentNode.replaceChild(canvas, image);\n}\n\n/*\n * Specifes that the element with the specified id\n * should be replaced with a generated logo.\n */\nfunction replace_logo(logo, replace_id, scale, title_txt, display_style) {\n  \"use strict\";\n  var element = document.getElementById(replace_id);\n  if (!replace_id) {\n    alert(\"Can't find specified id (\" + replace_id + \")\");\n    return;\n  }\n  //found the element!\n  var canvas = create_canvas(50, 120, replace_id, title_txt, display_style);\n  if (canvas === null) {\n    return;\n  }\n  //draw the logo on the canvas\n  draw_logo_on_canvas(logo, canvas, null, scale);\n  //replace the element with the canvas\n  element.parentNode.replaceChild(canvas, element);\n}\n\n/*\n * Fast string trimming implementation found at\n * http://blog.stevenlevithan.com/archives/faster-trim-javascript\n *\n * Note that regex is good at removing leading space but\n * bad at removing trailing space as it has to first go through\n * the whole string.\n */\nfunction trim (str) {\n  \"use strict\";\n  var ws, i;\n  str = str.replace(/^\\s\\s*/, '');\n  ws = /\\s/; i = str.length;\n  while (ws.test(str.charAt(--i)));\n  return str.slice(0, i + 1);\n}\n</script>\n    <script>\nvar current_motif = 0;\nvar dreme_alphabet = new Alphabet(data.alphabet, data.control_db.freqs);\n\n/*\n * Create a pspm for the given motif data\n */\nfunction motif_pspm(m) {\n  return new Pspm(m.pwm, m.id, 0, 0, m.nsites, m.evalue);\n}\n\n/*\n * Create a count matrix from the given motif data\n */\nfunction motif_count_matrix(motif) {\n  return motif_pspm(motif).as_count_matrix();\n}\n\n/*\n * Create a probablity matrix from the given motif data\n */\nfunction motif_prob_matrix(motif) {\n  return motif_pspm(motif).as_probability_matrix();\n}\n\n/*\n * Create a minimal meme format motif from the given motif data\n */\nfunction motif_minimal_meme(motif) {\n  return motif_pspm(motif).as_meme({\n    \"with_header\": true, \n    \"with_pspm\": true,\n    \"with_pssm\": false,\n    \"version\": data[\"version\"],\n    \"alphabet\": dreme_alphabet,\n    \"strands\": (data.options.revcomp ? 2 : 1)\n  });\n}\n\n/*\n * Fill in a template variable\n */\nfunction set_tvar(template, tvar, value) {\n  var node;\n  node = find_child(template, tvar);\n  if (node === null) {\n    throw new Error(\"Template does not contain variable \" + tvar);\n  }\n  node.innerHTML = \"\";\n  if (typeof value !== \"object\") {\n    node.appendChild(document.createTextNode(value));\n  } else {\n    node.appendChild(value);\n  }\n}\n\n/*\n * Make a canvas with the motif logo drawn on it. \n */\nfunction make_logo(motif, height, rc) {\n  var pspm = new Pspm(motif[\"pwm\"]);\n  if (rc) pspm = pspm.copy().reverse_complement(dreme_alphabet);\n  var logo = new Logo(dreme_alphabet);\n  logo.add_pspm(pspm, 0);\n  var canvas = document.createElement('canvas');\n  canvas.height = height;\n  canvas.width = 0;\n  draw_logo_on_canvas(logo, canvas, false);\n  return canvas;\n}\n\n/*\n * Create a button designed to contain a single symbol\n */\nfunction make_sym_btn(symbol, title, action) {\n  var box, sbox;\n  box = document.createElement(\"div\");\n  box.tabIndex = 0;\n  box.className = \"sym_btn\";\n  sbox = document.createElement(\"span\");\n  if (typeof symbol == \"string\") {\n    sbox.appendChild(document.createTextNode(symbol));\n  } else {\n    sbox.appendChild(symbol);\n  }\n  box.appendChild(sbox);\n  box.title = title;\n  box.addEventListener('click', action, false);\n  box.addEventListener('keydown', action, false);\n  return box;\n}\n\n/*\n * Create a pair of text spans with different classes.\n * This is useful when using CSS to only display one of them.\n */\nfunction text_pair(txt1, cls1, txt2, cls2) {\n  var container, part1, part2;\n  container = document.createElement(\"span\");\n  part1 = document.createElement(\"span\");\n  part1.appendChild(document.createTextNode(txt1));\n  part1.className = cls1;\n  container.appendChild(part1);\n  part2 = document.createElement(\"span\");\n  part2.appendChild(document.createTextNode(txt2));\n  part2.className = cls2;\n  container.appendChild(part2);\n  return container;\n}\n\n/*\n * Make a colourised sequence.\n */\nfunction make_seq(seq) {\n  var i, j, letter, lbox, sbox;\n  sbox = document.createElement(\"span\");\n  for (i = 0; i < seq.length; i = j) {\n    letter = seq.charAt(i);\n    for (j = i+1; j < seq.length; j++) {\n      if (seq.charAt(j) !== letter) {\n        break;\n      }\n    }\n    lbox = document.createElement(\"span\");\n    lbox.style.color = dreme_alphabet.get_colour(dreme_alphabet.get_index(letter));\n    lbox.appendChild(document.createTextNode(seq.substring(i, j)));\n    sbox.appendChild(lbox);\n  }\n  return sbox;\n}\n\n/*\n * Create a description element taking into account the newlines in the source text.\n */\nfunction make_description(text) {\n  var i, j, lines, p;\n  var container = document.createElement(\"div\");\n  var paragraphs = text.split(/\\n\\n+/);\n  for (i = 0; i < paragraphs.length; i++) {\n    lines = paragraphs[i].split(/\\n/);\n    p = document.createElement(\"p\");\n    p.appendChild(document.createTextNode(lines[0]));\n    for (j = 1; j < lines.length; j++) {\n      p.appendChild(document.createElement(\"br\"));\n      p.appendChild(document.createTextNode(lines[j]));\n    }\n    container.appendChild(p);\n  }\n  return container;\n}\n\n/*\n * Make the table header for the discovered motifs.\n */\nfunction make_motif_header() {\n  var row = document.createElement(\"tr\");\n  add_text_header_cell(row, \"\", \"\", \"motif_ordinal\");\n  add_text_header_cell(row, \"Motif\", \"pop_motifs_word\", \"motif_word\");\n  add_text_header_cell(row, \"Logo\", \"pop_motifs_logo\", \"motif_logo\");\n  if (data.options.revcomp) {\n    add_text_header_cell(row, \"RC Logo\", \"pop_motifs_rc_logo\", \"motif_logo\");\n  }\n  add_text_header_cell(row, \"E-value\", \"pop_motifs_evalue\", \"motif_evalue\");\n  add_text_header_cell(row, \"Unerased E-value\", \"pop_motifs_uevalue\", \"motif_evalue\");\n  add_text_header_cell(row, \"More\", \"pop_more\", \"motif_more\");\n  add_text_header_cell(row, \"Submit/Download\", \"pop_submit_dl\", \"motif_submit\");\n  row.className = \"more\";\n  return row;\n}\n\n/*\n * Make a compact motif summary row for the discovered motifs.\n */\nfunction make_motif_row(tbody, ordinal, motif) {\n  var row = document.createElement(\"tr\");\n  add_text_cell(row, \"\" + ordinal + \".\", \"motif_ordinal\");\n  add_text_cell(row, motif[\"id\"], \"motif_word\");\n  add_cell(row, make_logo(motif, 50, false), \"motif_logo\");\n  if (data.options.revcomp) {\n    add_cell(row, make_logo(motif, 50, true), \"motif_logo\");\n  }\n  add_text_cell(row, motif[\"evalue\"], \"motif_evalue\");\n  add_text_cell(row, motif[\"unerased_evalue\"], \"motif_evalue\");\n  add_cell(row, make_sym_btn(text_pair(\"\\u21A7\", \"less\", \"\\u21A5\", \"more\"), \"Show more information.\", function(e) { toggle_class(tbody, \"collapsed\"); }, \"\\u21A5\", \"\"), \"motif_more\");\n  add_cell(row, make_sym_btn(\"\\u21E2\", \"Submit the motif to another MEME Suite program or download it.\", function(e) { action_show_outpop(e, ordinal); }), \"motif_submit\");\n  return row;\n}\n\n/*\n * Make a sortable table of enriched matching rows.\n */\nfunction make_motif_words(motif) {\n  var row, i, match;\n  var table = document.createElement(\"table\");\n  var thead = document.createElement(\"thead\");\n  row = document.createElement(\"tr\");\n  add_text_header_cell(row, \"Word\", \"pop_match_word\", \"match_word\", function(e) {sort_table(this, compare_words);});\n  add_text_header_cell(row, \"Positives\", \"pop_match_pos\", \"match_count\", function(e) {sort_table(this, compare_counts);});\n  add_text_header_cell(row, \"Negatives\", \"pop_match_neg\", \"match_count\", function(e) {sort_table(this, compare_counts);});\n  add_text_header_cell(row, \"P-value\", \"pop_match_pval\", \"match_evalue\", function(e) {sort_table(this, compare_evalues);});\n  add_text_header_cell(row, \"E-value\", \"pop_match_eval\", \"match_evalue\", function(e) {sort_table(this, compare_evalues);});\n  thead.appendChild(row);\n  table.appendChild(thead);\n  var tbody = document.createElement(\"tbody\");\n  for (i = 0; i < motif.matches.length; i++) {\n    match = motif.matches[i];\n    row = document.createElement(\"tr\");\n    add_cell(row, make_seq(match.seq), \"match_word\");\n    add_text_cell(row, match.p + \" / \" + data.sequence_db.count, \"match_count\");\n    add_text_cell(row, match.n + \" / \" + data.control_db.count, \"match_count\");\n    add_text_cell(row, match.pvalue, \"match_evalue\");\n    add_text_cell(row, match.evalue, \"match_evalue\");\n    tbody.appendChild(row);\n  }\n  table.appendChild(tbody);\n  return table;\n}\n\n/*\n * Make an expanded view of a discovered motif.\n */\nfunction make_motif_exp(tbody, ordinal, motif) {\n  \"use strict\";\n  var box, pspm, logo_box;\n  box = $(\"tmpl_motif_expanded\").cloneNode(true);\n  toggle_class(box, \"template\", false);\n  box.id = \"\";\n  find_child(box, \"tvar_logo\").appendChild(make_logo(motif, 150, false));\n  if (data.options.revcomp) {\n    find_child(box, \"tvar_rclogo\").appendChild(make_logo(motif, 150, true));\n  }\n  set_tvar(box, \"tvar_p\", motif[\"p\"]);\n  set_tvar(box, \"tvar_p_total\", data.sequence_db.count);\n  set_tvar(box, \"tvar_n\", motif[\"n\"]);\n  set_tvar(box, \"tvar_n_total\", data.control_db.count);\n  set_tvar(box, \"tvar_pvalue\", motif[\"pvalue\"]);\n  set_tvar(box, \"tvar_evalue\", motif[\"evalue\"]);\n  set_tvar(box, \"tvar_uevalue\", motif[\"unerased_evalue\"]);\n  set_tvar(box, \"tvar_words\", make_motif_words(motif));\n  var cell = document.createElement(\"td\");\n  cell.colSpan = 8;\n  cell.appendChild(box);\n  var row = document.createElement(\"tr\");\n  row.className = \"more\";\n  row.appendChild(cell);\n  return row;\n}\n\n/*\n * Convert a string containing a scientific number into the log of that number\n * without having an intermediate representation of the number.\n * This is intended to avoid underflow problems with the tiny evalues that\n * MEME and DREME can create.\n */\nfunction sci2log(scinum) {\n  \"use strict\";\n  var ev_re, match, sig, exp;\n  ev_re = /^(.*)e(.*)$/;\n  if (match = ev_re.exec(scinum)) {\n    sig = parseFloat(match[1]);\n    exp = parseInt(match[2]);\n    return Math.log(sig) + (exp * Math.log(10));\n  }\n  return 0;\n}\n\n/*\n * Create a table of discovered motifs. A fresh table body is used for each\n * motif to make hiding/showing rows with css easier.\n */\nfunction make_motifs() {\n  \"use strict\";\n  var i, row, tbody, motif, ordinal;\n  // make the motifs table\n  var container = $(\"motifs\");\n  container.innerHTML = \"\"; // clear content\n  var table = document.createElement(\"table\");\n  // add a header that is always shown\n  var thead = document.createElement(\"thead\");\n  thead.appendChild(make_motif_header());\n  table.appendChild(thead);\n  for (i = 0; i < data.motifs.length; i++) {\n    ordinal = i + 1;\n    motif = data.motifs[i];\n    tbody = document.createElement(\"tbody\");\n    tbody.className = \"collapsed\";\n    tbody.appendChild(make_motif_row(tbody, ordinal, motif));\n    tbody.appendChild(make_motif_exp(tbody, ordinal, motif));\n    // create a following header for every row except the last one\n    if ((i + 1) < data.motifs.length) tbody.appendChild(make_motif_header());\n    table.appendChild(tbody);\n  }\n  container.appendChild(table);\n}\n\n/*\n * Create a table showing all the alphabet symbols, their names and frequencies.\n */\nfunction make_alpha_bg(alph, freqs) {\n  function colour_symbol(index) {\n    var span = document.createElement(\"span\");\n    span.appendChild(document.createTextNode(alph.get_symbol(index)));\n    span.style.color = alph.get_colour(index);\n    span.className = \"alpha_symbol\";\n    return span;\n  }\n  var table, thead, tbody, row, th, span, i;\n  // create table\n  table = document.createElement(\"table\");\n  table.className = \"inputs\";\n  // create header\n  thead = document.createElement(\"thead\");\n  table.appendChild(thead);\n  row = thead.insertRow(thead.rows.length);\n  if (alph.has_complement()) {\n    add_text_header_cell(row, \"Name\", \"pop_alph_name\");\n    add_text_header_cell(row, \"Bg.\", \"pop_alph_control\");\n    add_text_header_cell(row, \"\");\n    add_text_header_cell(row, \"\");\n    add_text_header_cell(row, \"\");\n    add_text_header_cell(row, \"Bg.\", \"pop_alph_control\");\n    add_text_header_cell(row, \"Name\", \"pop_alph_name\");\n  } else {\n    add_text_header_cell(row, \"\");\n    add_text_header_cell(row, \"Name\", \"pop_alph_name\");\n    add_text_header_cell(row, \"Bg.\", \"pop_alph_control\");\n  }\n  // add alphabet entries\n  tbody = document.createElement(\"tbody\");\n  table.appendChild(tbody);\n  if (alph.has_complement()) {\n    for (i = 0; i < alph.get_size_core(); i++) {\n      var c = alph.get_complement(i);\n      if (i > c) continue;\n      row = tbody.insertRow(tbody.rows.length);\n      add_text_cell(row, alph.get_name(i));\n      add_text_cell(row, \"\" + freqs[i].toFixed(3));\n      add_cell(row, colour_symbol(i)); \n      add_text_cell(row, \"~\");\n      add_cell(row, colour_symbol(c)); \n      add_text_cell(row, \"\" + freqs[c].toFixed(3));\n      add_text_cell(row, alph.get_name(c));\n    }\n  } else {\n    for (i = 0; i < alph.get_size_core(); i++) {\n      row = tbody.insertRow(tbody.rows.length);\n      add_cell(row, colour_symbol(i)); \n      add_text_cell(row, alph.get_name(i));\n      add_text_cell(row, \"\" + freqs[i].toFixed(3));\n    }\n  }\n  return table;\n}\n\n/*\n * Updates the format download text in the popup.\n * This is called when either the format or current motif changes.\n */\nfunction update_outpop_format(index) {\n  var motif = data.motifs[index];\n  var fn = [motif_count_matrix, motif_prob_matrix, motif_minimal_meme];\n  var suffix = [\"_counts.txt\", \"_freqs.txt\", \".meme\"];\n  var format = parseInt($(\"text_format\").value);\n  var text = fn[format](motif);\n  prepare_download(text, \"text/plain\", motif.id + suffix[format], $(\"outpop_text_dl\"));\n  $(\"outpop_text\").value = text;\n}\n\n/*\n * Updates the motif logos and format download text in the popup.\n * This is called whenever the current motif changes.\n */\nfunction update_outpop_motif(index) {\n  \"use strict\";\n  var motifs, motif, pspm, logo, canvas, num;\n  motifs = data[\"motifs\"];\n  if (index < 0 || index >= motifs.length) {return;}\n  current_motif = index;\n  motif = motifs[index];\n  pspm = new Pspm(motif[\"pwm\"]);\n  logo = new Logo(dreme_alphabet, \"\");\n  logo.add_pspm(pspm, 0);\n  canvas = $(\"outpop_logo\");\n  canvas.width = canvas.width; // clear canvas\n  draw_logo_on_canvas(logo, canvas, false);\n  canvas = $(\"outpop_logo_rc\");\n  canvas.width = canvas.width; // clear rc canvas\n  if (data.options.revcomp) {\n    pspm.reverse_complement(dreme_alphabet);\n    logo = new Logo(dreme_alphabet, \"\");\n    logo.add_pspm(pspm, 0);\n    draw_logo_on_canvas(logo, canvas, false);\n  }\n  num = $(\"outpop_num\");\n  num.innerHTML = \"\";\n  num.appendChild(document.createTextNode(\"\" + (index + 1)));\n  update_outpop_format(index);\n}\n\n\n/*\n * Initialise and display the download popup.\n */\nfunction action_show_outpop(e, ordinal) {\n  \"use strict\";\n  function init() {\n    \"use strict\";\n    var close_btn, next_btn, prev_btn, cancel_btn, do_btn;\n    var tab1, tab2, tab3;\n    var pnl1, pnl2, pnl3;\n    var format_list;\n    var tbl_submit, inputs, i, default_prog;\n    close_btn = $(\"outpop_close\");\n    close_btn.addEventListener(\"click\", action_hide_outpop, false);\n    close_btn.addEventListener(\"keydown\", action_hide_outpop, false);\n    next_btn = $(\"outpop_next\");\n    next_btn.addEventListener(\"click\", action_outpop_next, false);\n    next_btn.addEventListener(\"keydown\", action_outpop_next, false);\n    prev_btn = $(\"outpop_prev\");\n    prev_btn.addEventListener(\"click\", action_outpop_prev, false);\n    prev_btn.addEventListener(\"keydown\", action_outpop_prev, false);\n    cancel_btn = $(\"outpop_cancel\");\n    cancel_btn.addEventListener(\"click\", action_hide_outpop, false);\n    do_btn = $(\"outpop_do\");\n    do_btn.addEventListener(\"click\", action_outpop_submit, false);\n    tab1 = $(\"outpop_tab_1\");\n    tab1.tabIndex = 0;\n    tab1.addEventListener(\"click\", action_outpop_tab, false);\n    tab1.addEventListener(\"keydown\", action_outpop_tab, false);\n    tab2 = $(\"outpop_tab_2\");\n    tab2.tabIndex = 0;\n    tab2.addEventListener(\"click\", action_outpop_tab, false);\n    tab2.addEventListener(\"keydown\", action_outpop_tab, false);\n    tab3 = $(\"outpop_tab_3\");\n    tab3.tabIndex = 0;\n    tab3.addEventListener(\"click\", action_outpop_tab, false);\n    tab3.addEventListener(\"keydown\", action_outpop_tab, false);\n    pnl1 = $(\"outpop_pnl_1\");\n    pnl2 = $(\"outpop_pnl_2\");\n    pnl3 = $(\"outpop_pnl_3\");\n    toggle_class(tab1, \"activeTab\", true);\n    toggle_class(tab2, \"activeTab\", false);\n    toggle_class(tab3, \"activeTab\", false);\n    pnl1.style.display = \"block\";\n    pnl2.style.display = \"none\";\n    pnl3.style.display = \"none\";\n    format_list = $(\"text_format\");\n    format_list.addEventListener(\"change\", action_outpop_format, false);\n    // setup program selection\n    tbl_submit = $(\"programs\");\n    // when not dna, hide the inputs for programs that require dna motifs\n    toggle_class(tbl_submit, \"alphabet_dna\", dreme_alphabet.has_complement());//TODO FIXME alphabet_dna is a bad name for a field when allowing custom alphabets\n    // add a click listener for the radio buttons\n    inputs = tbl_submit.querySelectorAll(\"input[type='radio']\");\n    for (i = 0; i < inputs.length; i++) {\n      inputs[i].addEventListener(\"click\", action_outpop_program, false);\n    }\n    // ensure that a default program option is selected for DNA and Protein\n    default_prog = document.getElementById(dreme_alphabet.has_complement() ? \"submit_tomtom\" : \"submit_fimo\");\n    default_prog.checked = true;\n    action_outpop_program.call(default_prog);\n    // disable reverse-complement when not DNA\n    $(\"logo_rc_option\").disabled = !dreme_alphabet.has_complement(); \n    // set errorbars on when ssc is on\n    $(\"logo_ssc\").addEventListener(\"change\", action_outpop_ssc, false);\n  }\n  // store the focused element\n  action_hide_outpop.last_active = document.activeElement;\n  if (!e) e = window.event;\n  if (e.type === \"keydown\") {\n    if (e.keyCode !== 13 && e.keyCode !== 32) {\n      return;\n    }\n    // stop a submit or something like that\n    e.preventDefault();\n  }\n  // hide the help popup\n  help_popup();\n  // on first load initilize the popup\n  if (!action_show_outpop.ready) {\n    init();\n    action_show_outpop.ready = true;\n  }\n  update_outpop_motif(ordinal - 1);\n  // display the download popup\n  $(\"grey_out_page\").style.display = \"block\";\n  $(\"download\").style.display = \"block\";\n  $(\"outpop_close\").focus();\n}\n\n/*\n * Hide the download popup.\n */\nfunction action_hide_outpop(e) {\n  if (!e) e = window.event;\n  if (e.type === \"keydown\") {\n    if (e.keyCode !== 13 && e.keyCode !== 32) {\n      return;\n    }\n    // stop a submit or something like that\n    e.preventDefault();\n  }\n  $(\"download\").style.display = \"none\";\n  $(\"grey_out_page\").style.display = \"none\";\n  if (typeof action_hide_outpop.last_active !== \"undefined\") {\n    action_hide_outpop.last_active.focus();\n  }\n}\n\n/*\n * Show the next motif in the download popup.\n */\nfunction action_outpop_next(e) {\n  if (!e) e = window.event;\n  if (e.type === \"keydown\") {\n    if (e.keyCode !== 13 && e.keyCode !== 32) {\n      return;\n    }\n    // stop a submit or something like that\n    e.preventDefault();\n  }\n  update_outpop_motif(current_motif + 1);\n}\n\n/*\n * Show the previous motif in the download popup.\n */\nfunction action_outpop_prev(e) {\n  if (!e) e = window.event;\n  if (e.type === \"keydown\") {\n    if (e.keyCode !== 13 && e.keyCode !== 32) {\n      return;\n    }\n    // stop a submit or something like that\n    e.preventDefault();\n  }\n  update_outpop_motif(current_motif - 1);\n}\n\n/*\n * Highlight the selected row in the program list.\n */\nfunction action_outpop_program() {\n  \"use strict\";\n  var table, tr, rows, i;\n  tr = find_parent_tag(this, \"TR\");\n  table = find_parent_tag(tr, \"TABLE\");\n  rows = table.querySelectorAll(\"tr\");\n  for (i = 0; i < rows.length; i++) {\n    toggle_class(rows[i], \"selected\", rows[i] === tr);\n  }\n}\n\n/*\n * Enable error bars when small sample correction is enabled.\n */\nfunction action_outpop_ssc() {\n  \"use strict\";\n  $(\"logo_err\").value = $(\"logo_ssc\").value;\n}\n\n/*\n * Submit the motif to the selected program.\n */\nfunction action_outpop_submit(e) {\n  \"use strict\";\n  var form, input, program, motifs;\n  // find out which program is selected\n  var radios, i;\n  radios = document.getElementsByName(\"program\");\n  program = \"fimo\"; // default to fimo, since it works with all alphabet types\n  for (i = 0; i < radios.length; i++) {\n    if (radios[i].checked) program = radios[i].value;\n  }\n\n  motifs = motif_minimal_meme(data.motifs[current_motif]);\n  form = document.createElement(\"form\");\n  form.setAttribute(\"method\", \"post\");\n  form.setAttribute(\"action\", site_url + \"/tools/\" + program);\n  \n  input = document.createElement(\"input\");\n  input.setAttribute(\"type\", \"hidden\");\n  input.setAttribute(\"name\", \"motifs_embed\");\n  input.setAttribute(\"value\", motifs);\n  form.appendChild(input);\n\n  document.body.appendChild(form);\n  form.submit();\n  document.body.removeChild(form);\n}\n\n/*\n * Download the format text.\n * Wire the link containing the data URI text to a download button so it looks\n * the same as the server submit stuff.\n */\nfunction action_outpop_download_motif(e) {\n  $(\"outpop_text_dl\").click();\n}\n\n/*\n * Download the motif logo.\n * The EPS format can be calculated locally in Javascript\n */\nfunction action_outpop_download_logo(e) {\n  \"use strict\";\n  var pspm, logo, eps;\n  var logo_rc, logo_ssc, logo_width, logo_height;\n  var motif = data.motifs[current_motif];\n  if ($(\"logo_format\").value == \"0\") { // EPS\n    logo_rc = ($(\"logo_rc\").value == \"1\");\n    logo_ssc = ($(\"logo_ssc\").value == \"1\");\n    logo_width = parseFloat($(\"logo_width\").value);\n    if (isNaN(logo_width) || !isFinite(logo_width) || logo_width <= 0) logo_width = null;\n    logo_height = parseFloat($(\"logo_height\").value);\n    if (isNaN(logo_height) || !isFinite(logo_height) || logo_height <= 0) logo_height = null;\n    // create a PSPM from the motif\n    pspm = motif_pspm(motif);\n    if (logo_rc) pspm.reverse_complement(dreme_alphabet);\n    logo = new Logo(dreme_alphabet);\n    logo.add_pspm(pspm, 0);\n    eps = logo.as_eps({\"ssc\": logo_ssc, \"logo_width\": logo_width, \"logo_height\": logo_height});\n    prepare_download(eps, \"application/postscript\", motif.id + \".eps\");\n  } else {\n    $(\"logo_motifs\").value = motif_minimal_meme(motif);\n    $(\"logo_form\").submit();\n  }\n}\n\n/*\n * Change the selected tab in the download popup.\n */\nfunction action_outpop_tab(e) {\n  \"use strict\";\n  var tab1, tab2, tab3, pnl1, pnl2, pnl3, do_btn;\n  if (!e) e = window.event;\n  if (e.type === \"keydown\") {\n    if (e.keyCode !== 13 && e.keyCode !== 32) {\n      return;\n    }\n    // stop a submit or something like that\n    e.preventDefault();\n  }\n  tab1 = $(\"outpop_tab_1\");\n  tab2 = $(\"outpop_tab_2\");\n  tab3 = $(\"outpop_tab_3\");\n  pnl1 = $(\"outpop_pnl_1\");\n  pnl2 = $(\"outpop_pnl_2\");\n  pnl3 = $(\"outpop_pnl_3\");\n  do_btn = $(\"outpop_do\");\n\n  toggle_class(tab1, \"activeTab\", (this === tab1));\n  toggle_class(tab2, \"activeTab\", (this === tab2));\n  toggle_class(tab3, \"activeTab\", (this === tab3));\n  pnl1.style.display = ((this === tab1) ? \"block\" : \"none\");\n  pnl2.style.display = ((this === tab2) ? \"block\" : \"none\");\n  pnl3.style.display = ((this === tab3) ? \"block\" : \"none\");\n  do_btn.value = ((this === tab1) ? \"Submit\" : \"Download\");\n  do_btn.removeEventListener(\"click\", action_outpop_submit, false);\n  do_btn.removeEventListener(\"click\", action_outpop_download_logo, false);\n  do_btn.removeEventListener(\"click\", action_outpop_download_motif, false);\n  if (this === tab1) {\n    do_btn.addEventListener(\"click\", action_outpop_submit, false);\n  } else if (this === tab2) {\n    do_btn.addEventListener(\"click\", action_outpop_download_motif, false);\n  } else {\n    do_btn.addEventListener(\"click\", action_outpop_download_logo, false);\n  }\n}\n\n/*\n * Update the text in the download format popup.\n */\nfunction action_outpop_format() {\n  update_outpop_format(current_motif);\n}\n\n/*\n * Find all text nodes in the given container.\n */\nfunction text_nodes(container) {\n  var textNodes = [];\n  var stack = [container];\n  // depth first search to maintain ordering when flattened \n  while (stack.length > 0) {\n    var node = stack.pop();\n    if (node.nodeType == Node.TEXT_NODE) {\n      textNodes.push(node);\n    } else {\n      for (var i = node.childNodes.length-1; i >= 0; i--) {\n        stack.push(node.childNodes[i]);\n      }\n    }\n  }\n  return textNodes;\n}\n\n/*\n * Get the text out of a specific text node.\n */\nfunction node_text(node) {\n  if (node === undefined) {\n    return '';\n  } else if (node.textContent) {\n    return node.textContent;\n  } else if (node.innerText) {\n    return node.innerText;\n  } else {\n    return '';\n  }\n}\n\n/*\n * Get the text contained within the element.\n */\nfunction elem_text(elem, separator) {\n  if (separator === undefined) separator = '';\n  return text_nodes(elem).map(node_text).join(separator);\n}\n\n/*\n * Sort all rows in the first table body based on the column of the given element and the comparison function.\n * The sort is not very fast and is intended for small tables only.\n */\nfunction sort_table(colEle, compare_function) {\n  //find the parent of colEle that is either a td or th\n  var i, j;\n  var cell = colEle;\n  while (true) {\n    if (cell == null) return;\n    if (cell.nodeType == Node.ELEMENT_NODE && \n        (cell.tagName.toLowerCase() == \"td\" || cell.tagName.toLowerCase() == \"th\")) {\n      break;\n    }\n    cell = cell.parentNode;\n  }\n  //find the parent of cell that is a tr\n  var row = cell;\n  while (true) {\n    if (row == null) return;\n    if (row.nodeType == Node.ELEMENT_NODE && row.tagName.toLowerCase() == \"tr\") {\n      break;\n    }\n    row = row.parentNode;\n  }\n  //find the parent of row that is a table\n  var table = row;\n  while (true) {\n    if (table == null) return;\n    if (table.nodeType == Node.ELEMENT_NODE && table.tagName.toLowerCase() == \"table\") {\n      break;\n    }\n    table = table.parentNode;\n  }\n  var column_index = cell.cellIndex;\n  // do a bubble sort, because the tables are so small it doesn't matter\n  var change;\n  var trs = table.tBodies[0].getElementsByTagName('tr');\n  var already_sorted = true;\n  var reverse = false;\n  while (true) {\n    do {\n      change = false;\n      for (i = 0; i < trs.length -1; i++) {\n        var v1 = elem_text(trs[i].cells[column_index]);\n        var v2 = elem_text(trs[i+1].cells[column_index]);\n        if (reverse) {\n          var tmp = v1;\n          v1 = v2;\n          v2 = tmp;\n        }\n        if (compare_function(v1, v2) > 0) {\n          exchange(trs[i], trs[i+1], table);\n          change = true;\n          already_sorted = false;\n          trs = table.tBodies[0].getElementsByTagName('tr');\n        }\n      }\n    } while (change);\n    if (reverse) break;// we've sorted twice so exit\n    if (!already_sorted) break;// sort did something so exit\n    // when it's sorted one way already then sort the opposite way\n    reverse = true;\n  }\n  // put arrows on the headers\n  var headers = table.tHead.getElementsByTagName('tr');\n  for (i = 0; i < headers.length; i++) {\n    for (j = 0; j < headers[i].cells.length; j++) {\n      var cell = headers[i].cells[j];\n      var arrows = cell.getElementsByClassName(\"sort_arrow\");\n      var arrow;\n      if (arrows.length == 0) {\n        arrow = document.createElement(\"span\");\n        arrow.className = \"sort_arrow\";\n        cell.insertBefore(arrow, cell.firstChild);\n      } else {\n        arrow = arrows[0];\n      }\n      arrow.innerHTML = \"\";\n      if (j == column_index) {\n        arrow.appendChild(document.createTextNode(reverse ? \"\\u25B2\" : \"\\u25BC\"));\n      }\n    }\n  }\n}\n\n/*\n * Swap two rows in a table.\n */\nfunction exchange(oRowI, oRowJ, oTable) {\n  var i = oRowI.rowIndex;\n  var j = oRowJ.rowIndex;\n   if (i == j+1) {\n    oTable.tBodies[0].insertBefore(oRowI, oRowJ);\n  } if (j == i+1) {\n    oTable.tBodies[0].insertBefore(oRowJ, oRowI);\n  } else {\n    var tmpNode = oTable.tBodies[0].replaceChild(oRowI, oRowJ);\n    if(typeof(oRowI) != \"undefined\") {\n      oTable.tBodies[0].insertBefore(tmpNode, oRowI);\n    } else {\n      oTable.appendChild(tmpNode);\n    }\n  }\n}\n\n/*\n * Compare two E-values which may be very small.\n */\nfunction compare_evalues(v1, v2) {\n  var e1 = sci2log(v1);\n  var e2 = sci2log(v2);\n  if (e1 < e2) return -1;\n  else if (e1 > e2) return 1;\n  return 0;\n}\n\n/*\n * Compare two counts.\n */\nfunction compare_counts(v1, v2) {\n  var re = /(\\d+)\\s*\\/\\s*\\d+/;\n  var m1 = re.exec(v1);\n  var m2 = re.exec(v2);\n  if (m1 == null && m2 == null) return 0;\n  if (m1 == null) return -1;\n  if (m2 == null) return 1;\n  return parseInt(m2[1]) - parseInt(m1[1]);\n}\n\n/*\n * Compare two sequence words.\n */\nfunction compare_words(v1, v2) {\n  return v1.localeCompare(v2);\n}\n\n\n</script>\n    <style>\n/* The following is the content of meme.css */\nbody { background-color:white; font-size: 12px; font-family: Verdana, Arial, Helvetica, sans-serif;}\n\ndiv.help {\n  display: inline-block;\n  margin: 0px;\n  padding: 0px;\n  width: 12px;\n  height: 13px;\n  cursor: pointer;\n  background-image: url(data:image/gif;base64,R0lGODlhDAANAIABANR0AP///yH5BAEAAAEALAAAAAAMAA0AAAIdhI8Xy22MIFgv1DttrrJ7mlGNNo4c+aFg6SQuUAAAOw==);\n}\n\ndiv.help:hover {\n  background-image: url(data:image/gif;base64,R0lGODlhDAANAKEAANR0AP///9R0ANR0ACH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEAAAIALAAAAAAMAA0AAAIdDGynCe3PgoxONntvwqz2/z2K2ImjR0KhmSIZUgAAOw==);\n}\n\np.spaced { line-height: 1.8em;}\n\nspan.citation { font-family: \"Book Antiqua\", \"Palatino Linotype\", serif; color: #004a4d;}\n\np.pad { padding-left: 30px; padding-top: 5px; padding-bottom: 10px;}\n\ntd.jump { font-size: 13px; color: #ffffff; background-color: #00666a;\n  font-family: Georgia, \"Times New Roman\", Times, serif;}\n\na.jump { margin: 15px 0 0; font-style: normal; font-variant: small-caps;\n  font-weight: bolder; font-family: Georgia, \"Times New Roman\", Times, serif;}\n\nh2.mainh {font-size: 1.5em; font-style: normal; margin: 15px 0 0;\n  font-variant: small-caps; font-family: Georgia, \"Times New Roman\", Times, serif;}\n\nh2.line {border-bottom: 1px solid #CCCCCC; font-size: 1.5em; font-style: normal;\n  margin: 15px 0 0; padding-bottom: 3px; font-variant: small-caps;\n  font-family: Georgia, \"Times New Roman\", Times, serif;}\n\nh4 {border-bottom: 1px solid #CCCCCC; font-size: 1.2em; font-style: normal;\n  margin: 10px 0 0; padding-bottom: 3px; font-family: Georgia, \"Times New Roman\", Times, serif;}\n\nh5 {margin: 0px}\n\na.help { font-size: 9px; font-style: normal; text-transform: uppercase;\n  font-family: Georgia, \"Times New Roman\", Times, serif;}\n\ndiv.pad { padding-left: 30px; padding-top: 5px; padding-bottom: 10px;}\n\ndiv.pad1 { margin: 10px 5px;}\n\ndiv.pad2 { margin: 25px 5px 5px;}\nh2.pad2 { padding: 25px 5px 5px;}\n\ndiv.pad3 { padding: 5px 0px 10px 30px;}\n\ndiv.box { border: 2px solid #CCCCCC; padding:10px; overflow: hidden;}\n\ndiv.bar { border-left: 7px solid #00666a; padding:5px; margin-top:25px; }\n\ndiv.subsection {margin:25px 0px;}\n\nimg {border:0px none;}\n\nth.majorth {text-align:left;}\nth.minorth {font-weight:normal; text-align:left; width:8em; padding: 3px 0px;}\nth.actionth {font-weight:normal; text-align:left;}\n\n.explain h5 {font-size:1em; margin-left: 1em;}\n\ndiv.doc {margin-left: 2em; margin-bottom: 3em;}\n\nth.trainingset {\n  border-bottom: thin dashed black; \n  font-weight:normal; \n  padding:0px 10px;\n}\ndiv.pop_content {\n  position:absolute;\n  z-index:50;\n  width:300px;\n  padding: 5px;\n  background: #E4ECEC;\n  font-size: 12px;\n  font-family: Arial;\n  border-style: double;\n  border-width: 3px;\n  border-color: #AA2244;\n  display:none;\n}\n\ndiv.pop_content > *:first-child {\n  margin-top: 0px;\n}\n\ndiv.pop_content h1, div.pop_content h2, div.pop_content h3, div.pop_content h4, \ndiv.pop_content h5, div.pop_content h6, div.pop_content p {\n  margin: 0px;\n}\n\ndiv.pop_content p + h1, div.pop_content p + h2, div.pop_content p + h3, \ndiv.pop_content p + h4, div.pop_content p + h5, div.pop_content p + h6 {\n  margin-top: 5px;\n}\n\ndiv.pop_content p + p {\n  margin-top: 5px;\n}\n\ndiv.pop_content > *:last-child {\n  margin-bottom: 0px;\n}\n\ndiv.pop_content div.pop_close {\n  /* old definition */\n  float:right;\n  bottom: 0;\n}\n\ndiv.pop_content span.pop_close, div.pop_content span.pop_back {\n  display: inline-block;\n  border: 2px outset #661429;\n  background-color: #CCC;\n  padding-left: 1px;\n  padding-right: 1px;\n  padding-top: 0px;\n  padding-bottom: 0px;\n  cursor: pointer;\n  color: #AA2244; /*#661429;*/\n  font-weight: bold;\n}\n\ndiv.pop_content span.pop_close:active, div.pop_content span.pop_back:active {\n  border-style: inset;\n}\n\ndiv.pop_content span.pop_close {\n  float:right;\n  /*border: 2px outset #AA002B;*/\n  /*color: #AA2244;*/\n}\n\ndiv.pop_content:not(.nested) .nested_only {\n  display: none;\n}\n\ndiv.pop_back_sec {\n  margin-bottom: 5px;\n}\n\ndiv.pop_close_sec {\n  margin-top: 5px;\n}\n\ntable.hide_advanced tr.advanced {\n  display: none;\n}\nspan.show_more {\n  display: none;\n}\ntable.hide_advanced span.show_more {\n  display: inline;\n}\ntable.hide_advanced span.show_less {\n  display: none;\n}\n\n\n/*****************************************************************************\n * Program logo styling\n ****************************************************************************/\ndiv.prog_logo {\n  border-bottom: 0.25em solid #0f5f60;\n  height: 4.5em;\n  width: 24em;\n  display:inline-block;\n}\ndiv.prog_logo img {\n  float:left;\n  width: 4em;\n  border-style: none;\n  margin-right: 0.2em;\n}\ndiv.prog_logo h1, div.prog_logo h1:hover, div.prog_logo h1:active, div.prog_logo h1:visited {\n  margin:0;\n  padding:0;\n  font-family: Arial, Helvetica,  sans-serif;\n  font-size: 3.2em;\n  line-height: 1em;\n  vertical-align: top;\n  display: block;\n  color: #026666;\n  letter-spacing: -0.06em;\n  text-shadow: 0.04em 0.06em 0.05em #666;\n}\ndiv.prog_logo h2, div.prog_logo h2:hover, div.prog_logo h2:active, div.prog_logo h2:visited {\n  display: block;\n  margin:0;\n  padding:0;\n  font-family: Helvetica, sans-serif;\n  font-size: 0.9em;\n  line-height: 1em;\n  letter-spacing: -0.06em;\n  color: black;\n}\n\ndiv.big.prog_logo {\n  font-size: 18px;\n}\n\n</style>\n    <style>\n/* dreme output specific css */\ndiv.header {\n  position: relative;\n  overflow: hidden;\n  margin-top: 15px;\n  margin-bottom: 5px;\n  margin-right: 3px;\n  margin-left: 3px;\n}\ndiv.header > h2 {\n  font-size: 1.5em;\n  font-style: normal;\n  margin: 0;\n  font-variant: small-caps; \n  font-family: Georgia, \"Times New Roman\", Times, serif;\n}\ndiv.header > span {\n  position: absolute;\n  right: 0;\n  bottom: 0;\n}\n\ndiv.template {\n  position: absolute;\n  z-index: 1;\n  left: 0;\n  top: 0;\n  visibility: hidden;\n}\n\ndiv.sym_btn {\n  display:inline-block;\n  text-decoration: underline;\n  cursor: pointer;\n  font-size: 20px;\n  line-height:20px; \n  text-align: center;\n  width: 20px;\n  height: 20px;\n  color: blue;\n}\ndiv.sym_btn:hover {\n  color: white;\n  background-color: blue;\n}\n\ndiv.sym_btn.positioned {\n  position: absolute;\n  top: 0px;\n}\n\ndiv.box + div.box {\n  margin-top: 5px;\n}\n\nth.motif_ordinal {\n\n}\ntd.motif_ordinal {\n  text-align: right;\n  padding-right: 10px;\n  font-weight: bold;\n  font-size: large;\n}\nth.motif_word {\n  padding-right: 10px;\n}\ntd.motif_word {\n  font-size:15px; \n  font-family: 'Courier New', Courier, monospace;\n  padding-right: 10px;\n}\nth.motif_logo {\n  padding-right: 10px;\n}\ntd.motif_logo {\n  padding-right: 10px;\n}\nth.motif_evalue {\n  text-align:right;\n  padding-right: 10px;\n}\ntd.motif_evalue {\n  text-align: right;\n  white-space: nowrap;\n  padding-right: 20px;\n}\nth.motif_more {\n  padding: 0 5px;\n}\ntd.motif_more {\n  text-align: center;\n  padding: 0 5px;\n}\nth.motif_submit {\n  padding: 0 5px;\n}\ntd.motif_submit {\n  text-align: center;\n  padding: 0 5px;\n}\nth.match_word {\n  padding-right: 10px;\n}\ntd.match_word {\n  padding-right: 10px;\n  font-weight: bold;\n  font-size: large; \n  font-family: 'Courier New', Courier, monospace;\n}\nth.match_evalue, th.match_count {\n  text-align: right;\n  padding-right: 10px;\n}\ntd.match_evalue, td.match_count {\n  text-align: right;\n  white-space: nowrap;\n  padding-right: 20px;\n}\n\ndiv.tabArea {\n  font-size: 80%;\n  font-weight: bold;\n}\n\n.norc div.tabArea {\n  display: none;\n}\n\nspan.tab, span.tab:visited {\n  cursor: pointer;\n  color: #888;\n  background-color: #ddd;\n  border: 2px solid #ccc;\n  padding: 2px 1em;\n  text-decoration: none;\n}\nspan.tab.middle {\n  border-left-width: 0px;\n}\ndiv.tabArea.base span.tab {\n  border-top-width: 0px;\n}\ndiv.tabArea.top span.tab {\n  border-bottom-width: 0px;\n}\n\nspan.tab:hover {\n  background-color: #bbb;\n  border-color: #bbb;\n  color: #666;\n}\nspan.tab.activeTab, span.tab.activeTab:hover, span.tab.activeTab:visited {\n  background-color: white;\n  color: black;\n  cursor: default;\n}\ndiv.tabMain {\n  border: 2px solid #ccc;\n  background-color: white;\n  padding: 10px;\n}\ndiv.tabMain.base {\n  margin-top: 5px;\n  display: inline-block;\n  max-width: 98%;\n}\n\ndiv.tabMain.top {\n  margin-bottom: 5px;\n}\n\ndiv.grey_background {\n  position:fixed; \n  z-index: 8;\n  background-color: #000;\n  -ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)\";\n  opacity: 0.5;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n}\n\ndiv.popup_wrapper {\n  position:fixed; \n  z-index:9;\n  width:100%; \n  height:0; \n  top:50%; \n  left:0;\n}\n\ndiv.popup {\n  width: 600px; \n  z-index:9;\n  margin-left: auto;\n  margin-right: auto;\n  padding: 5px;\n  background-color: #FFF;\n  border-style: double;\n  border-width: 5px;\n  border-color: #00666a;\n  position:relative; \n}\ndiv.close {\n  cursor: pointer;\n  border: 1px solid black; \n  width:15px; \n  height:15px; \n  line-height:15px; /* this causes vertical centering */\n  text-align:center; \n  background-color:#FFF; \n  color:#000; \n  font-size:15px;\n  font-family:monospace;\n}\n\ndiv.close:hover {\n  color:#FFF;\n  background-color:#000; \n}\n\ndiv.navnum {\n  width:100%; \n  height:20px; \n  line-height:20px; \n  text-align:center; \n  font-size:medium;\n}\n\ndiv.navarrow {\n  font-size: 30px;\n  text-decoration:none;\n  cursor: pointer;\n  -moz-user-select: none;  \n  -webkit-user-select: none;  \n  -ms-user-select: none;\n}\n\ndiv.navarrow > span.inactive {\n  display: inline;\n}\ndiv.navarrow > span.active {\n  display: none;\n}\n\ndiv.navarrow:hover > span.active {\n  display: inline;\n}\ndiv.navarrow:hover > span.inactive {\n  display: none;\n}\n\ntable.programs {\n  width: 100%;\n}\n\ntable.programs tr {\n  background-color: #EFE;\n}\n\ntable.programs tr.selected {\n  background-color: #262;\n  color: #FFF;\n}\n\ntable.programs tr.dna_only {\n  display: none;\n}\n\ntable.programs.alphabet_dna tr.dna_only {\n  display: table-row;\n}\n\ntable.inputs {\n  margin-top: 20px;\n  border-collapse:collapse;\n}\ntable.inputs * td, table.inputs * th {\n  padding-left: 15px;\n  padding-right: 15px;\n  padding-top: 1px;\n  padding-bottom: 1px;\n}\n\n/* program settings */\nspan.strand_none, span.strand_given, span.strand_both {\n  display: none;\n}\ntd.none span.strand_none, td.given span.strand_given, td.both span.strand_both {\n  display: inline;\n}\n\n/* show the expanded motif only when the collapsed one is hidden */\ntbody *.less, tbody.collapsed *.more {\n  display: none;\n}\n\ntbody.collapsed *.less {\n  display: inline;\n}\n\n</style>\n  </head>\n  <body data-scrollpad=\"true\">\n    <!--  -->\n    <div id=\"grey_out_page\" class=\"grey_background\" style=\"display:none;\">\n    </div>\n\n    <!-- Help popups -->\n    <div class=\"pop_content\" id=\"pop_\">\n      <p>Help poup.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n\n    <div class=\"pop_content\" id=\"pop_motifs_word\">\n      <p>\n        The name of the motif uses the IUPAC codes for nucleotides which has \n        a different letter to represent each of the 15 possible combinations.\n      </p>\n      <p>\n        The name is itself a representation of the motif though the position\n        weight matrix is not directly equalivant as it is generated from the\n        sites found that matched the letters given in the name.\n      </p>\n      <p>\n        <a id=\"doc_alphabets_url\" href=\"#\">\n        Read more about the MEME suite's use of the IUPAC alphabets.\n        </a>\n        <script>$(\"doc_alphabets_url\").href = site_url + \"/doc/alphabets.html\";</script>\n      </p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_motifs_logo\">\n      <p>The logo of the motif.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_motifs_rc_logo\">\n      <p>The logo of the reverse complement motif.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_motifs_evalue\">\n      <p>The E-value is the enrichment p-value times the number of candidate \n        motifs tested.</p>\n      <p>The enrichment p-value is calculated using Fisher's Exact Test for \n        enrichment of the motif in the positive sequences.</p>\n      <p>Note that the counts used in Fisher's Exact Test are made after \n        erasing sites that match previously found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_motifs_uevalue\">\n      <p>The E-value of the motif calculated without erasing the sites of \n        previously found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_more\">\n      <p>Show more information on the motif.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_submit_dl\">\n      <p>Submit your motif to another MEME Suite program or download your motif.</p>\n      <h5>Supported Programs</h5>\n      <dl>\n        <dt>Tomtom</dt>\n        <dd>Tomtom is a tool for searching for similar known motifs. \n          </dd>\n        <dt>MAST</dt>\n        <dd>MAST is a tool for searching biological sequence databases for \n          sequences that contain one or more of a group of known motifs.\n          </dd>\n        <dt>FIMO</dt>\n        <dd>FIMO is a tool for searching biological sequence databases for \n          sequences that contain one or more known motifs.\n          </dd>\n        <dt>GOMO</dt>\n        <dd>GOMO is a tool for identifying possible roles (Gene Ontology \n          terms) for DNA binding motifs.\n          </dd>\n        <dt>SpaMo</dt>\n        <dd>SpaMo is a tool for inferring possible transcription factor\n          complexes by finding motifs with enriched spacings.\n          </dd>\n      </dl>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_motif_positives\">\n      <p># positive sequences matching the motif / # positive sequences.</p>\n      <p>Note these counts are made after erasing sites that match previously\n        found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_motif_negatives\">\n      <p># negative sequences matching the motif / # negative sequences.</p>\n      <p>Note these counts are made after erasing sites that match previously\n        found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_motif_pvalue\">\n      <p>The p-value of Fisher's Exact Test for enrichment of the motif in \n        the positive sequences.</p>\n      <p>Note that the counts used in Fisher's Exact Test are made after \n        erasing sites that match previously found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_motif_evalue\">\n      <p>The E-value is the motif p-value times the number of candidate motifs \n        tested.</p>\n      <p>Note that the p-value was calculated with counts made after \n        erasing sites that match previously found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_motif_uevalue\">\n      <p>The E-value of the motif calculated without erasing the sites of \n        previously found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_match_word\">\n      <p>All words matching the motif whose uncorrected p-value is less than\n      <span id=\"help_add_pv_thresh\"></span>.</p>\n      <script>$(\"help_add_pv_thresh\").innerHTML = data.options.add_pv_thresh;</script>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_match_pos\">\n      <p># positive sequences with matches to the word / # positive sequences.</p>\n      <p>Note these counts are made after erasing sites that match previously\n        found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_match_neg\">\n      <p># negative sequences with matches to the word / # negative sequences.</p>\n      <p>Note these counts are made after erasing sites that match previously\n        found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_match_pval\">\n      <p>The p-value of Fisher's Exact Test for enrichment of the word in \n        the positive sequences.</p>\n      <p>Note that the counts used in Fisher's Exact Test are made after \n        erasing sites that match previously found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_match_eval\">\n      <p>The word p-value times the number of candidates tested.</p>\n      <p>Note that the p-value was calculated with counts made after \n        erasing sites that match previously found motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n\n    <div class=\"pop_content\" id=\"pop_seq_source\">\n      <p>The sequence file used by DREME to find the motifs.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_seq_alph\">\n      <p>The alphabet of the sequences.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n    <div class=\"pop_content\" id=\"pop_seq_count\">\n      <p>The count of the sequences.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n\n    <div class=\"pop_content\" id=\"pop_alph_name\">\n      <p>The name of the alphabet symbol.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n\n    <div class=\"pop_content\" id=\"pop_alph_control\">\n      <p>The frequency of the alphabet symbol in the control dataset.</p>\n      <div class=\"pop_close\">[<a href=\"javascript:help_popup()\">close</a> ]</div>\n    </div>\n\n    <!-- templates -->\n\n    <div class=\"template box expanded_motif\" id=\"tmpl_motif_expanded\">\n      <div>\n        <span class=\"tvar_logo\"></span>\n        <span class=\"tvar_rclogo\"></span>\n      </div>\n      <h4>Details</h4>\n      <table class=\"details\">\n        <thead>\n          <tr>\n            <th class=\"match_count\">Positives <div class=\"help\" data-topic=\"pop_motif_positives\"></div></th>\n            <th class=\"match_count\">Negatives <div class=\"help\" data-topic=\"pop_motif_negatives\"></div></th>\n            <th class=\"match_evalue\">P-value <div class=\"help\" data-topic=\"pop_motif_pvalue\"></div></th>\n            <th class=\"match_evalue\">E-value <div class=\"help\" data-topic=\"pop_motif_evalue\"></div></th>\n            <th class=\"match_evalue\">Unerased E-value <div class=\"help\" data-topic=\"pop_motif_uevalue\"></div></th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td class=\"match_count\">\n              <span class=\"tvar_p\"></span> / <span class=\"tvar_p_total\"></span>\n            </td>\n            <td class=\"match_count\">\n              <span class=\"tvar_n\"></span> / <span class=\"tvar_n_total\"></span>\n            </td>\n            <td class=\"tvar_pvalue match_evalue\"></td>\n            <td class=\"tvar_evalue match_evalue\"></td>\n            <td class=\"tvar_uevalue match_evalue\"></td>\n          </tr>\n        </tbody>\n      </table>\n      <h4>Enriched Matching Words</h4>\n      <div class=\"tvar_words\"></div>\n    </div>\n\n\n    <div class=\"popup_wrapper\">\n      <div class=\"popup\" style=\"display:none; top: -150px;\" id=\"download\">\n        <div>\n          <div style=\"float:right; \">\n            <div id=\"outpop_close\" class=\"close\" tabindex=\"0\">x</div>\n          </div>\n          <h2 class=\"mainh\" style=\"margin:0; padding:0;\">Submit or Download</h2>\n          <div style=\"clear:both\"></div>\n        </div>\n          <div style=\"height:100px\">\n            <div style=\"float:right; width: 30px;\">\n              <div id=\"outpop_prev\" class=\"navarrow\" tabindex=\"0\">\n                <span class=\"inactive\">&#8679;</span><span class=\"active\">&#11014;</span>\n              </div>\n              <div id=\"outpop_num\" class=\"navnum\"></div>\n              <div id=\"outpop_next\" class=\"navarrow\" tabindex=\"0\">\n                <span class=\"inactive\">&#8681;</span><span class=\"active\">&#11015;</span>\n              </div>\n            </div>\n            <div id=\"logo_box\" style=\"height: 100px; margin-right: 40px;\">\n              <canvas id=\"outpop_logo\" height=\"100\" width=\"250\"></canvas>\n              <canvas id=\"outpop_logo_rc\" height=\"100\" width=\"250\"></canvas>\n            </div>\n          </div>\n          <div>\n            <!-- tabs start -->\n            <div class=\"tabArea top\">\n              <span id=\"outpop_tab_1\" class=\"tab\">Submit Motif</span><span\n                id=\"outpop_tab_2\" class=\"tab middle\">Download Motif</span><span \n                id=\"outpop_tab_3\" class=\"tab middle\">Download Logo</span>\n            </div>\n            <div class=\"tabMain top\">\n              <!-- Submit to another program -->\n              <div id=\"outpop_pnl_1\">\n                <h4 class=\"compact\">Submit to program</h4>\n                <table id=\"programs\" class=\"programs\">\n                  <tr class=\"dna_only\">\n                    <td><input type=\"radio\" name=\"program\" value=\"tomtom\" id=\"submit_tomtom\"></td>\n                    <td><label for=\"submit_tomtom\">Tomtom</label></td>\n                    <td><label for=\"submit_tomtom\">Find similar motifs in\n                        published libraries or a library you supply.</label></td>\n                  </tr>\n                  <tr>\n                    <td><input type=\"radio\" name=\"program\" value=\"fimo\" id=\"submit_fimo\"></td>\n                    <td><label for=\"submit_fimo\">FIMO</label></td>\n                    <td><label for=\"submit_fimo\">Find motif occurrences in\n                        sequence data.</label></td>\n                  </tr>\n                  <tr>\n                    <td><input type=\"radio\" name=\"program\" value=\"mast\" id=\"submit_mast\"></td>\n                    <td><label for=\"submit_mast\">MAST</label></td>\n                    <td><label for=\"submit_mast\">Rank sequences by affinity to\n                        groups of motifs.</label></td>\n                  </tr>\n                  <tr class=\"dna_only\">\n                    <td><input type=\"radio\" name=\"program\" value=\"gomo\" id=\"submit_gomo\"></td>\n                    <td><label for=\"submit_gomo\">GOMo</label></td>\n                    <td><label for=\"submit_gomo\">Identify possible roles (Gene\n                        Ontology terms) for motifs.</label></td>\n                  </tr>\n                  <tr class=\"dna_only\">\n                    <td><input type=\"radio\" name=\"program\" value=\"spamo\" id=\"submit_spamo\"></td>\n                    <td><label for=\"submit_spamo\">SpaMo</label></td>\n                    <td><label for=\"submit_spamo\">Find other motifs that are\n                        enriched at specific close spacings which might imply the existance of a complex.</label></td>\n                  </tr>\n                </table>\n              </div>\n              <!-- download text format  -->\n              <div id=\"outpop_pnl_2\">\n                <div>\n                  <label for=\"text_format\">Format:</label>\n                  <select id=\"text_format\">\n                    <option value=\"0\">Count Matrix</option>\n                    <option value=\"1\">Probability Matrix</option>\n                    <option value=\"2\">Minimal MEME</option>\n                  </select>\n                </div>\n                <textarea id=\"outpop_text\" name=\"content\"\n                  style=\"width:99%; white-space: pre; word-wrap: normal; overflow-x: scroll;\" \n                  rows=\"8\" readonly=\"readonly\" wrap=\"off\"></textarea>\n                <a id=\"outpop_text_dl\" download=\"meme.txt\" href=\"\"></a>\n              </div>\n              <!-- download logo format -->\n              <div id=\"outpop_pnl_3\">\n                <form id=\"logo_form\" method=\"post\" action=\"\">\n                  <script>$(\"logo_form\").action = site_url + \"/utilities/generate_logo\";</script>\n                  <input type=\"hidden\" name=\"program\" value=\"DREME\"/>\n                  <input type=\"hidden\" id=\"logo_motifs\" name=\"motifs\" value=\"\"/>\n                  <table>\n                    <tr>\n                      <td><label for=\"logo_format\">Format:</label></td>\n                      <td>\n                        <select id=\"logo_format\" name=\"png\">\n                          <option value=\"1\">PNG (for web)</option>\n                          <option value=\"0\">EPS (for publication)</option>\n                        </select>\n                      </td>\n                    </tr>\n                    <tr>\n                      <td><label for=\"logo_rc\">Orientation:</label></td>\n                      <td>\n                        <select id=\"logo_rc\" name=\"rc1\">\n                          <option value=\"0\">Normal</option>\n                          <option value=\"1\" id=\"logo_rc_option\">Reverse Complement</option>\n                        </select>\n                      </td>\n                    </tr>\n                    <tr>\n                      <td><label for=\"logo_ssc\">Small Sample Correction:</label></td>\n                      <td>\n                        <input type=\"hidden\" id=\"logo_err\" name=\"errbars\" value=\"0\"/>\n                        <select id=\"logo_ssc\" name=\"ssc\">\n                          <option value=\"0\">Off</option>\n                          <option value=\"1\">On</option>\n                        </select>\n                      </td>\n                    </tr>\n                    <tr>\n                      <td><label for=\"logo_width\">Width:</label></td>\n                      <td>\n                        <input type=\"text\" id=\"logo_width\" size=\"4\" placeholder=\"default\" name=\"width\"/>&nbsp;cm\n                      </td>\n                    </tr>\n                    <tr>\n                      <td><label for=\"logo_height\">Height:</label></td>\n                      <td>\n                        <input type=\"text\" id=\"logo_height\" size=\"4\" placeholder=\"default\" name=\"height\"/>&nbsp;cm\n                      </td>\n                    </tr>\n                  </table>\n                </form>\n              </div>\n              <!-- Buttons -->\n              <div>\n                <div style=\"float:left;\">\n                  <input type=\"button\" id=\"outpop_do\" value=\"Submit\" />\n                </div>\n                <div style=\"float:right;\">\n                  <input id=\"outpop_cancel\" type=\"button\" value=\"Cancel\" />\n                </div>\n                <div style=\"clear:both;\"></div>\n              </div>\n            </div>\n        </div>\n      </div>\n    </div>\n\n\n\n    <!-- Page starts here -->\n    <div id=\"top\" class=\"pad1\">\n      <div class=\"prog_logo big\">\n        <img src=\"data:image/png;base64,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\" alt=\"DREME Logo\"/>\n        <h1>DREME</h1>\n        <h2>Discriminative Regular Expression Motif Elicitation</h2>\n      </div>\n      <p class=\"spaced\">\n        For further information on how to interpret these results or to get a \n        copy of the MEME software please access \n        <a href=\"http://meme.nbcr.net/\">http://meme.nbcr.net</a>. \n      </p>\n      <p>\n        If you use DREME in your research please cite the following paper:<br />\n        <span class=\"citation\">\n          Timothy L. Bailey, \"DREME: Motif discovery in transcription factor ChIP-seq data\", <i>Bioinformatics</i>, <b>27</b>(12):1653-1659, 2011.\n          <a href=\"http://bioinformatics.oxfordjournals.org/content/27/12/1653\">[full text]</a>\n        </span>\n      </p>\n    </div>\n    <!-- navigation -->\n    <div class=\"pad2\">\n      <a class=\"jump\" href=\"#motifs_sec\">Discovered Motifs</a>\n      &nbsp;&nbsp;|&nbsp;&nbsp;\n      <a class=\"jump\" href=\"#inputs_sec\">Inputs &amp; Settings</a>\n      &nbsp;&nbsp;|&nbsp;&nbsp;\n      <a class=\"jump\" href=\"#info_sec\">Program information</a>\n    </div>\n    <!-- alert the user when their browser is not up to the task -->\n    <noscript><h1 style=\"color:red\">Javascript is required to view these results!</h1></noscript>\n    <h1 id=\"html5_warning\" style=\"color:red; display:none;\">Your browser does not support canvas!</h1>\n    <script>\n      if (!window.HTMLCanvasElement) $(\"html5_warning\").style.display = \"block\";\n    </script>\n    <!-- description -->\n    <div id=\"description_section\" style=\"display:none\">\n      <div id=\"description\" class=\"header\">\n        <h2>Description</h2>\n      </div>\n      <div id=\"description_text\" class=\"box\">\n      </div>\n    </div>\n    <script>\n      if (data.description) {\n        $(\"description_text\").innerHTML = \"\";\n        $(\"description_text\").appendChild(make_description(data.description));\n        $(\"description_section\").style.display = \"block\";\n      }\n    </script>\n    <!-- motifs -->\n    <div id=\"motifs_sec\" class=\"header\">\n      <h2>Discovered Motifs</h2>\n      <span><a href=\"#inputs_sec\">Next</a>&nbsp;<a href=\"#\">Top</a></span>\n    </div>\n    <div id=\"motifs\" class=\"box\">\n      <p>No motifs were discovered!</p>\n    </div>\n    <script>make_motifs();</script>\n    <!-- inputs and settings -->\n    <div id=\"inputs_sec\" class=\"header\">\n      <h2>Inputs &amp; Settings</h2>\n      <span><a href=\"#motifs_sec\">Previous</a>&nbsp;<a href=\"#info_sec\">Next</a>&nbsp;<a href=\"#\">Top</a></span>\n    </div>\n    <div class=\"box\">\n      <h4>Sequences</h4>\n      <table id=\"seq_info\" class=\"inputs\">\n        <tr><th>Source <div class=\"help\" data-topic=\"pop_seq_source\"></div></th>\n          <th>Alphabet <div class=\"help\" data-topic=\"pop_seq_alph\"></div></th>\n          <th>Sequence Count <div class=\"help\" data-topic=\"pop_seq_count\"></div></th>\n        </tr>\n        <tr>\n          <td id=\"ins_seq_source\"></td>\n          <td id=\"ins_seq_alphabet\"></td>\n          <td id=\"ins_seq_count\"></td>\n        </tr>\n      </table>\n      <script>\n      {\n        var db = data.sequence_db;\n        $(\"ins_seq_source\").innerHTML = db.file;\n        $(\"ins_seq_alphabet\").innerHTML = dreme_alphabet.get_alphabet_name();\n        $(\"ins_seq_count\").innerHTML = db.count;\n      }\n      </script>\n      <h4>Control Sequences</h4>\n      <table id=\"seq_info\" class=\"inputs\">\n        <tr><th>Source <div class=\"help\" data-topic=\"pop_seq_source\"></div></th>\n          <th>Sequence Count <div class=\"help\" data-topic=\"pop_seq_count\"></div></th>\n        </tr>\n        <tr>\n          <td id=\"ins_cseq_source\"></td>\n          <td id=\"ins_cseq_count\"></td>\n        </tr>\n      </table>\n      <script>\n      {\n        var db = data.control_db;\n        if (db.from == \"shuffled\") {\n          $(\"ins_cseq_source\").innerHTML = \"Shuffled Sequences\";\n        } else {\n          $(\"ins_cseq_source\").innerHTML = db.file;\n        }\n        $(\"ins_cseq_count\").innerHTML = db.count;\n      }\n      </script>\n      <h4>Background</h4>\n      <span id=\"alpha_bg\"></span>\n      <script>\n      {\n        $(\"alpha_bg\").appendChild(make_alpha_bg(dreme_alphabet, data.control_db.freqs));\n      }\n      </script>\n      <h4>Other Settings</h4>\n      <table id=\"tbl_settings\" class=\"inputs hide_advanced\">\n        <tr>\n          <th>Strand Handling</th>\n          <td id=\"opt_strand\">\n            <span class=\"strand_none\">This alphabet only has one strand</span>\n            <span class=\"strand_given\">Only the given strand is processed</span>\n            <span class=\"strand_both\">Both the given and reverse complement strands are processed</span>\n          </td>\n        </tr>\n        <tr><th># REs to Generalize</th><td id=\"opt_ngen\"></td></tr>\n        <tr><th>Shuffle Seed</th><td id=\"opt_seed\"></td></tr>\n        <tr><th>E-value Threshold</th><td id=\"opt_stop_evalue\"></td></tr>\n        <tr><th>Max Motif Count</th><td id=\"opt_stop_count\"></td></tr>\n        <tr><th>Max Run Time</th><td id=\"opt_stop_time\"></td></tr>\n      </table>\n      <script>\n      {\n        $(\"opt_strand\").className = (dreme_alphabet.has_complement() ? (data.options.revcomp ? \"both\" : \"given\") : \"none\");\n        $(\"opt_ngen\").innerHTML = data.options.ngen;\n        $(\"opt_seed\").innerHTML = data.options.seed;\n        $(\"opt_stop_evalue\").innerHTML = data.options.stop.evalue;\n        $(\"opt_stop_count\").innerHTML = (typeof data.options.stop.count == \"number\" ? data.options.stop.count : \"No maximum motif count.\");\n        $(\"opt_stop_time\").innerHTML = (typeof data.options.stop.time == \"number\" ? data.options.stop.time + \" seconds.\" : \"No maximum running time.\");\n      }\n      </script>\n    </div>\n    <!-- list information on this program -->\n    <div id=\"info_sec\" class=\"bar\" style=\"position:relative\">\n      <div style=\"position: absolute; right: 0;\"><a href=\"#inputs_sec\">Previous</a> <a href=\"#\">Top</a></div>\n      <div class=\"subsection\">\n        <h5 id=\"version\">DREME version</h5>\n        <span id=\"ins_version\"></span> \n        (Release date: <span id=\"ins_release\"></span>)<br>\n      </div>\n      <script>\n        $(\"ins_version\").innerHTML = data[\"version\"];\n        $(\"ins_release\").innerHTML = data[\"release\"];\n      </script>\n      <div class=\"subsection\">\n        <h5 id=\"reference\">Reference</h5>\n        <span class=\"citation\">\n          Timothy L. Bailey, \"DREME: Motif discovery in transcription factor ChIP-seq data\", <i>Bioinformatics</i>, <b>27</b>(12):1653-1659, 2011.\n          <a href=\"http://bioinformatics.oxfordjournals.org/content/27/12/1653\">[full text]</a>\n        </span>\n      </div>\n      <div class=\"subsection\">\n        <h5 id=\"command\">Command line</h5>\n        <textarea id=\"cmd\" rows=\"3\" style=\"width:100%;\" readonly=\"readonly\">\n        </textarea>\n        <script>$(\"cmd\").value = data[\"cmd\"].join(\" \");</script>\n      </div>\n    </div>\n    \n  </body>\n</html>\n", "encoding": "ascii"}