{"url": "http://flamingo.ics.uci.edu/toolkit/docs/UdfDoc.html", "content": "<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:html=\"http://www.w3.org/1999/xhtml\">\n<head>\n<title>UdfDoc - Chen Li -- Group - Trac</title>\n<style type=\"text/css\">\n           @import url(media/trac.css);\n          </style>\n</head>\n<body>\n<p>\n<a href=\"index.html\">Back to Index</a>\n</p>\n<hr/>\n<div class=\"wikipage\">\n<div id=\"searchable\">\n<div class=\"wiki-toc\">\n<ol>\n<li>\n<a href=\"#UDFDocumentation\" shape=\"rect\">UDF Documentation</a>\n<ol>\n<li>\n<a href=\"#Compatibility\" shape=\"rect\">Compatibility</a>\n</li>\n<li>\n<a href=\"#MySQL\" shape=\"rect\">MySQL</a>\n<ol>\n<li>\n<a href=\"#EditDistance\" shape=\"rect\">Edit Distance</a>\n</li>\n<li>\n<a href=\"#CompilationandInstallation\" shape=\"rect\">Compilation and\nInstallation</a>\n</li>\n</ol>\n</li>\n<li>\n<a href=\"#Contributors\" shape=\"rect\">Contributors</a>\n</li>\n</ol>\n</li>\n</ol>\n</div>\n<h1 id=\"UDFDocumentation\">UDF Documentation</h1>\n<p>This document describes the use of the <a class=\"ext-link\" href=\"http://en.wikipedia.org/wiki/User_Defined_Function\" shape=\"rect\">\n<span class=\"icon\">User Defined Functions</span>\n</a> (UDF) provided in the\nFlamingo Toolkit.</p>\n<h2 id=\"Compatibility\">Compatibility</h2>\n<p>The code has been tested on <a class=\"ext-link\" href=\"http://www.ubuntu.com/\" shape=\"rect\">\n<span class=\"icon\">Ubuntu 8.04\nLTS</span>\n</a>.</p>\n<h2 id=\"MySQL\">MySQL</h2>\n<p>The UDFs discussed bellow are provided for the <a class=\"ext-link\" href=\"http://mysql.com/\" shape=\"rect\">\n<span class=\"icon\">MySQL</span>\n</a> database software.</p>\n<h3 id=\"EditDistance\">Edit Distance</h3>\n<p>The module provides the implementation of three UDF functions\nbased on edit distance (aka <a class=\"ext-link\" href=\"http://en.wikipedia.org/wiki/Levenstein_Distance\" shape=\"rect\">\n<span class=\"icon\">Levenshtein distance</span>\n</a>) function:</p>\n<ul>\n<li>\n<strong>\n<tt>ed</tt>\n</strong>: <tt>integer ed(string s1, string\ns1)</tt>: returns the edit distance between <tt>s1</tt> and\n<tt>s2</tt>. The function assumes that the strings have the same\ncase (i.e., both strings are lower case or both are upper\ncase).</li>\n<li>\n<strong>\n<tt>edth</tt>\n</strong>: <tt>boolean edth(string s1,\nstring s1, integer th)</tt>: returns true if the edit distance\nbetween <tt>s1</tt> and <tt>s2</tt> is smaller or equal than\n<tt>th</tt>. This function might be slightly faster than\n<tt>ed</tt> as it can stop as soon as the edit distance goes above\nthe threshold. The function assumes that the strings have the same\ncase (i.e., both strings are lower case or both are upper\ncase).</li>\n<li>\n<strong>\n<tt>edrec</tt>\n</strong>: <tt>boolean edrec(string s,\nstring rec, integer th)</tt>: returns true if there is a token in\n<tt>rec</tt> that has an edit distance from <tt>s</tt> smaller or\nequal to <tt>th</tt>. The string in <tt>rec</tt> is tokenized using\nthe following separators: \" \" (white space), \",\" (comma), and \".\"\n(dot). The function assumes that the query string is in lower\ncase.</li>\n</ul>\n<p>Bellow there is one SQL examples for each function:</p>\n<pre class=\"wiki\" xml:space=\"preserve\">\nmysql&gt; SELECT ed('abc', 'ad');\n2\nmysql&gt; SELECT edth('abc', 'abcd', 1);\n1\nmysql&gt; SELECT edrec('ab', 'xx ad xx', 1);\n1\n</pre>\n<p>The boolean values are returned as 0 and 1.</p>\n<p>The implementations are in C language and are according to the\nUDF specifications for the MySQL database software. Each function\nis defined in a separate file called\n<i>\n<tt>function_name</tt>\n</i>\n<tt>.c</tt>. Besides the actual\nfunctions there are additional helper functions defined (some of\nthem required by the MySQL UDF specification). For each function\nthere is an <i>\n<tt>function_name</tt>\n</i>\n<tt>.sql</tt> file which\nshows how to <i>CREATE</i> and <i>DROP</i> the function from MySQL\nand plenty of examples of using that function.</p>\n<h3 id=\"CompilationandInstallation\">Compilation and\nInstallation</h3>\n<p>The following packages are needed for compiling the code: gcc,\nmake, mysql-server, and libmysqlclient-dev. They can be installed\nusing:</p>\n<pre class=\"wiki\" xml:space=\"preserve\">\n&gt; sudo apt-get install gcc make mysql-server libmysqlclient-dev\n</pre>\n<p>A <a class=\"ext-link\" href=\"http://en.wikipedia.org/wiki/Makefile\" shape=\"rect\">\n<span class=\"icon\">Makefile</span>\n</a> is provided for compiling and testing\nthe code. To compile the code do the following:</p>\n<pre class=\"wiki\" xml:space=\"preserve\">\n&gt; cd toolkit/src/udf/mysql/ed\ntoolkit/src/udf/mysql/ed&gt; make\ngcc -Wall -O3 -I/usr/include/mysql -shared -o libed.so ed.c\ngcc -Wall -O3 -I/usr/include/mysql -shared -o libedth.so edth.c\ngcc -Wall -O3 -I/usr/include/mysql -shared -o libedrec.so edrec.c\ntoolkit/src/udf/mysql/ed&gt;\n</pre>\n<p>The Makefile creates a shared library file for each function.\nNow the libraries need to be copied in <tt>/usr/lib/mysql/plugin/</tt> so that\nMySQL sees then and MySQL needs to be restarted:</p>\n<pre class=\"wiki\" xml:space=\"preserve\">\ntoolkit/src/udf/mysql/ed&gt; sudo cp libed*.so /usr/lib/mysql/plugin/\ntoolkit/src/udf/mysql/ed&gt; sudo /etc/init.d/mysql restart\n * Stopping MySQL database server mysqld                                 [ OK ] \n * Starting MySQL database server mysqld                                 [ OK ] \n * Checking for corrupt, not cleanly closed and upgrade needing tables.\n</pre>\n<p>Now we can add the functions to MySQL and test them. To do that\nwe can connect to MySQL and Copy-and-Paste the SQL statements\nprovided for each function in their respective <tt>.sql</tt> file.\nAlternatively, we can use:</p>\n<pre class=\"wiki\" xml:space=\"preserve\">\ntoolkit/src/udf/mysql/ed&gt; make test\ncat ed.sql edth.sql edrec.sql | mysql --database=mysql --password\nEnter password:\n</pre>\n<p>By default we can type ENTER when prompted for MySQL password.\nIn case the current user is not a valid MySQL user or it does not\nhave privileges to install UDFs, you can add <tt>--user=root</tt>\nto the <tt>mysql</tt> line and provide the MySQL root password. The\noutput will show what function was called, which parameters were\nused, and, on the next line, the returned value of the\nfunction.</p>\n<p>For more details about the UDFs in MySQL see <a class=\"ext-link\" href=\"http://dev.mysql.com/doc/refman/5.0/en/adding-functions.html\" shape=\"rect\">\n<span class=\"icon\">\nMySQL Manual - 20.2. Adding New Functions to MySQL</span>\n</a>.</p>\n<h2 id=\"Contributors\">Contributors</h2>\n<ul>\n<li>Rares Vernica</li>\n</ul>\n</div>\n</div>\n<div class=\"footer\">\n<hr/>\n<p>\n<a href=\"index.html\">Back to Index</a>\n</p>\n</div>\n</body>\n</html>\n", "encoding": "ascii"}