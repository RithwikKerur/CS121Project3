{"url": "https://grape.ics.uci.edu/wiki/asterix/raw-attachment/wiki/stats170ab-2018/HW4-Solution-Queries.txt", "content": "SELECT COUNT(*) FROM Users;\n count \n-------\n  7997\n(1 row)\n\nSELECT (SELECT COUNT(*)::float FROM Tweets) / (SELECT COUNT(*)::float FROM Users) AS tweets_per_user;\n tweets_per_user  \n------------------\n 1.25046892584719\n(1 row)\n\nWITH num_originals AS (SELECT COUNT(*)::float AS num FROM Tweets WHERE in_reply_to_status_id IS NULL),\n     num_replies AS (SELECT COUNT(*)::float AS num FROM Tweets WHERE in_reply_to_status_id IS NOT NULL)\nSELECT o.num / (o.num + r.num) AS original_fraction,\n       r.num / (o.num + r.num) AS reply_fraction\nFROM num_originals o, num_replies r;\n original_fraction | reply_fraction \n-------------------+----------------\n            0.9944 |         0.0056\n(1 row)\n\nWITH TopTweeters AS\n   (SELECT user_id, COUNT(*) AS num_tweets\n    FROM Tweets\n    GROUP BY user_id\n    ORDER BY num_tweets DESC\n    LIMIT 20)\nSELECT u.id, u.name, u.screen_name, t.num_tweets,\n       CURRENT_TIMESTAMP - u.created_at AS how_long,\n       s.statuses_count, s.followers_count\nFROM TopTweeters t, Users u, UserStats s\nWHERE t.user_id = u.id AND t.user_id = s.user_id\nORDER BY t.num_tweets DESC;\n         id         |         name          |   screen_name   | num_tweets |         how_long          | statuses_count | followers_count \n--------------------+-----------------------+-----------------+------------+---------------------------+----------------+-----------------\n 790963434351394816 | SportsRadio 740       | SportsRadio_740 |         37 | 480 days 22:16:27.783238  |          72877 |             189\n 85484566           | NFL Fan               | NFL_Commentary  |         36 | 3036 days 12:27:21.783238 |          58292 |             119\n 144894717          | Chicago Bears         | bearspress      |         35 | 2833 days 23:31:24.783238 |          92136 |            1166\n 2887568169         | az sports             | azsportscene    |         30 | 1184 days 11:58:59.783238 |          52854 |             523\n 928924128          | NFL World             | NFLWrld         |         26 | 1930 days 10:48:06.783238 |         184895 |           58479\n 900428774          | NBA World             | NBAWorldNewz    |         25 | 1943 days 20:06:28.783238 |         161336 |           58083\n 47859478           | JON K BRENT           | jonkbrent       |         24 | 3168 days 10:37:22.783238 |         328978 |            2085\n 32337061           | Championship Rings    | ChampionsRings  |         20 | 3229 days 08:23:57.783238 |           2358 |            1045\n 927587894981812225 | Breaking News         | 9033SolNews     |         19 | 103 days 20:59:37.783238  |           7183 |             178\n 752756937842831360 | Christian Pittmann    | ChrisPittmann   |         19 | 586 days 08:35:25.783238  |           8432 |              87\n 856647177581477888 | Ashley DSouza         | imashleydsouza  |         14 | 299 days 16:12:42.783238  |          57941 |            1866\n 34985745           | Coshocton Tribune     | coshtribune     |         13 | 3221 days 21:46:55.783238 |          33991 |            2724\n 17187236           | 12 News               | 12News          |         13 | 3392 days 02:09:57.783238 |         283612 |          198461\n 2336949294         | JUST PURE INFORMATION | Monitor_sur     |         13 | 1468 days 21:50:29.783238 |         845286 |            8299\n 767499419335950336 | Social Life In Miami  | SocialLifeMiami |         13 | 545 days 16:14:04.783238  |         234856 |             540\n 16116116           | Chillicothe Gazette   | ChilliGaz       |         12 | 3454 days 22:03:22.783238 |          40801 |            7865\n 28489820           | MansfieldNewsJournal  | MansfieldNJ     |         12 | 3243 days 12:10:34.783238 |          42316 |            7982\n 21004741           | NewarkAdvocate.com    | NewarkAdvocate  |         12 | 3288 days 21:01:28.783238 |          47642 |           10323\n 388440415          | 18d.Media             | 18dMedia        |         12 | 2322 days 20:21:05.783238 |         316996 |           13090\n 15673261           | Zanesville News       | TimesRecorder   |         12 | 3489 days 04:19:56.783238 |          37903 |            8532\n(20 rows)\n\nSELECT COUNT(DISTINCT text) FROM Hashtags;\n count \n-------\n   365\n(1 row)\n\nSELECT (SELECT COUNT(*)::float FROM Hashtags) / (SELECT COUNT(*)::float FROM Tweets) AS hashtags_per_tweet;\n hashtags_per_tweet \n--------------------\n             0.2413\n(1 row)\n\nSELECT text, COUNT(*) AS freq\nFROM Hashtags\nGROUP BY text\nORDER BY freq DESC\nLIMIT 20;\n      text       | freq \n-----------------+------\n Olympics        |  386\n WinterOlympics  |  297\n PyeongChang2018 |  192\n medalmania      |   82\n gold            |   61\n TeamUSA         |   57\n olympics        |   57\n USA             |   56\n TeamCanada      |   45\n NFL             |   36\n NOR             |   30\n dog             |   30\n TV              |   28\n FoxNews         |   25\n ShaunWhite      |   25\n USRC            |   25\n TeamLGBTQ       |   22\n Pyeongchang2018 |   20\n OLYMPICS        |   19\n silver          |   17\n(20 rows)\n\n", "encoding": "ascii"}