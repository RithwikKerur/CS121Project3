{"url": "http://seal.ics.uci.edu/projects/obfuscation/index.html", "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<title>SEAL - DELDroid</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<meta http-equiv=\"Reply-to\" content=\"hammadm at uci dot edu\">\n<meta http-equiv=\"Owner\" content=\"Mahmoud Hammad\">\n<meta name=\"Author\" content=\"Mahmoud Hammad\">\n<meta name=\"Generator\" content=\"Emacs\">\n<link rev=\"MADE\" href=\"mailto:hammadm at uci dot edu\">\n<link href=\"../../seal.css\" rel=\"stylesheet\" type=\"text/css\">\n\n<style>\nh1 {\n    background-color: #cbe1f4;\n}\n\nh2 {\n    background-color: lightblue;\n}\nh3 {\n    background-color: lightgreen;\n}\nh4 {\n    background-color: lightgreen;\n}\n\n.box {\n  width: 70%;\n    padding: 10px;\n    border: 5px solid #ff4040;\n    margin: 0;\n}\n.tooltip {\n    position: relative;\n    display: inline-block;\n    border-bottom: 1px dotted black;\n}\n\n.tooltip .tooltiptext {\n    visibility: hidden;\n    width: 520px;\n    background-color: black;\n    color: #fff;\n    text-align: center;\n    border-radius: 10px;\n    font-size: 14px;\n    padding: 5px 0;\n\n    /* Position the tooltip */\n    position: absolute;\n    z-index: 1;\n}\n\n.tooltip:hover .tooltiptext {\n    visibility: visible;\n}\n\n</style>\n\n</head>\n\n<body>\n\n\n\n<div class=\"wrapper\">\n<!-- *************** Beginning of content ****************** -->\n\n<div alighn=\"center\">\n<h1><center>A Large-Scale Empirical Study on the Effects of Code Obfuscations on Android Apps and Anti-Malware Products</center></h1>\n</div>\n\n<b>Jump to ...</b>\n<ul>\n  <li><a href=\"#pub\">Publication</a></li>\n  <li><a href=\"#slides\">Presentation</a></li>\n  <li><a href=\"#intro\">Introduction</a></li>\n  <li><a href=\"#strategy\">Leveraged Obfuscation Strategies</a></li>\n  <li><a href=\"#methodology\">Research Methodology</a></li>\n  <li><a href=\"#framework\">Evaluation Framework </a></li>\n  <li><a href=\"#studied_anti_malware\">Studied Anti-Malware Products</a></li>\n  <li><a href=\"#rqs\">Research Questions</a></li>\n  <li><a href=\"#analysis\">Data Analysis and Results</a></li>\n  <ul>\n  <li><a href=\"#rq1\">RQ1. Obfuscation Strategies</a></li>\n  <li><a href=\"#rq2\">RQ2: Obfuscation Tools</a></li>\n  <li><a href=\"#rq3\">RQ3: Time-aware analysis</a></li>\n  <li><a href=\"#rq4\">RQ4. Valid, installable, and runnable apps</a></li>\n</ul>\n</ul>\n\n<div class=\"box\"> \n  <center>\n    <b class=\"tooltip\">Finding 1 <span class=\"tooltiptext\">Code obfuscation significantly impacts Android anti-malware products. The average detection rate for the top anti-malware products decreases from 87% to 67% -- 20% decrease.</span></b>, \n    <b class=\"tooltip\">Finding 2<span class=\"tooltiptext\">\nMajority of the Android anti-malware products are severely impacted by certain trivial obfuscation strategies, such as MAN. On average, MAN obfuscation decreases a product's detection rate by 28%.\n    </span></b>, \n    <b class=\"tooltip\">Finding 3<span class=\"tooltiptext\">\n  REF transformations make apps look suspicious, increasing the chance of an app being labeled as malicious. \n    </span></b>, \n    <b class=\"tooltip\">Finding 4<span class=\"tooltiptext\">\nIn general, combined transformations do not affect detection rates more than single transformations: The average detection rate of anti-malware products is 61% for single nontrivial obfuscations, and 61% for combined obfuscations.\n    </span></b>, \n    <b class=\"tooltip\">Finding 5<span class=\"tooltiptext\">\nENC_IDR and CF_ENC_IDR are the most successful transformations for evading anti-malware products.\n    </span></b>, \n    <b class=\"tooltip\">Finding 6<span class=\"tooltiptext\">\nADAM and Apktool/Jarsigner result in obfuscations that reduce anti-malware product accuracy the least, which is useful for benign authors, but works against the goals of malware authors.\n    </span></b>, \n    <b class=\"tooltip\">Finding 7<span class=\"tooltiptext\">\nDashO reduces the accuracy of anti-malware products more than other obfuscation tools in our study.\n    </span></b>, \n    <b class=\"tooltip\">Finding 8<span class=\"tooltiptext\">\nThe average detection rates of anti-malware products tend to decrease over time, indicating that such products are slow to adopt signatures of malicious apps.\n    </span></b>, \n    <b class=\"tooltip\">Finding 9<span class=\"tooltiptext\">\nThe percentage of obfuscated apps that are both installable and runnable in an order-aware fashion varies from 0%-62%. These results suggest a significant need for improving obfuscation tools so that applying their transformations retain an app's original behavior.\n    </span></b>\n\n  </center>\n</div>\n\n<div id=\"pub\"><center><h2>Publication</h2></center></div>\n\nMahmoud Hammad, Joshua Garcia, and Sam Malek.<br/>\nA Large-Scale Empirical Study on the Effects of Code Obfuscations on Android Apps and Anti-Malware Products.<br/>\nInternational Conference of Software Engineering (ICSE), May 2018, Gothenburg, Sweden. (20% acceptance rate) <a href=\"../../publications/2018ICSE_Hammad.pdf\">[PDF]</a>\n\n<div id=\"slides\"><center><h2>Presentation</h2></center></div>\n<center>\n  <iframe src=\"//www.slideshare.net/slideshow/embed_code/key/GOjAJyNEQHLUQl\" width=\"595\" height=\"485\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\" style=\"border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;\" allowfullscreen> </iframe> <div style=\"margin-bottom:5px\"> <strong> <a href=\"//www.slideshare.net/MahmoudHammad23/icse2018-obfuscation-v5\" title=\"A Large-Scale Empirical Study on the Effects of Code Obfuscations on Android Apps and Anti-Malware Products\" target=\"_blank\">A Large-Scale Empirical Study on the Effects of Code Obfuscations on Android Apps and Anti-Malware Products</a> </strong> from <strong><a href=\"https://www.slideshare.net/MahmoudHammad23\" target=\"_blank\">Mahmoud Hammad</a></strong> </div>\n</center>\n\n<div id=\"intro\"><center><h2>Introduction</h2></center></div>\n<div>\n<p>Android is the dominant mobile platform with 85% market share, as of the first quarter of 2017. At the same time, the number and sophistication of malicious Android apps are increasin. \n<p>Many reasons contribute to this meteoric rise of malware apps including: (1) the relative ease of creating a piggybacked app, i.e., a mutated version of a legitimate app injected with either malicious code or embedded advertisements; and (2) the prevalence of alternative Android app stores (i.e., app stores other than the official Android app store, Google Play), on which malicious apps may be distributed to users.\n<p>To protect mobile devices, users often rely on anti-malware products, which scan apps to determine if they are benign or malicious. However, many malware apps have previously evaded detection by these products. Examples of such malicious apps include Brain Test, VikingHorde, FalseGuide, and DressCode. These apps have infected millions of users before they were detected. To evade detection, malware authors often rely on code obfuscation, i.e., transforming a code into a form that is more difficult for humans, and possibly machines, to read, understand, and reverse engineer. These transformations change the syntax of code but not their semantics.\n<p>To better protect the intellectual property of benign app developers and prevent cloning of their apps, several companies have developed obfuscation tools, or obfuscators for short, that implement different code transformations (e.g., identifier renaming, string encryption, reflection, etc.). Given the use of obfuscations by malware authors, the goal of this study is to assess the performance of commercial anti-malware products against various obfuscation tools and strategies. In addition, this study assesses to evaluate the ability of obfuscation tools to generate valid, installable, and runnable obfuscated Android apps.\n</div>\n\n<div  id=\"strategy\"><center><h2>Leveraged Obfuscation Strategies</h2></center></div>\n<div>\n\t<table style=\"width:100%\">\n  <tr >\n  \t<td width=\"50%\"><p>To study the effectiveness of anti-malware products, we applied several different obfuscation strategies on each Android app. Table 1 shows the obfuscation strategies applied in this study along with their abbreviations. In addition to these 11 obfuscation strategies, we also applied 18 combined obfuscation strategies.</td>\n  \t<td width=\"50%\"><img src=\"./res/obfuscationStudyTable.png\" alt=\"Obfuscation Study\"></td>\n  </tr>\n</table>\n</div>\n\n<div  id=\"methodology\"><center><h2>Research Methodology</h2></center></div>\n<div>\n\t<table style=\"width:100%\">\n  <tr >\n  \t<td width=\"50%\">\n  \t\t<p> Study subjects\n  \t\t<ul>\n  \t\t\t<li>3,000 Google Play apps</li>\n  \t\t\t<li>3,000 Malicious apps</li>\n\t\t</ul>\n  \t\t<p> Obfuscation Tools\n  \t\t<ul>\n  \t\t\t<li>Commercial tools</li>\n  \t\t\t<ul>\n  \t\t\t\t<li><a href=\"http://www.allatori.com\">Allatori</a></li>\n  \t\t\t\t<li><a href=\"https://www.preemptive.com/products/dasho/overview\">DashO</a></li>\n  \t\t\t</ul>\n  \t\t\t<li>Open-source tools</li>\n  \t\t\t<ul>\n  \t\t\t\t<li><a href=\"https://www.guardsquare.com/en/proguard\">ProGuard</a></li>\n  \t\t\t\t<li><a href=\"https://ibotpeaches.github.io/Apktool/\">Apktool</a></li>\n  \t\t\t\t<li><a href=\"https://docs.oracle.com/javase/7/docs/technotes/tools/windows/jarsigner.html\">Jarsigner</a></li>\n  \t\t\t</ul>\n  \t\t\t<li>Academia tools</li>\n  \t\t\t<ul>\n  \t\t\t\t<li><a href=\"https://scholar.google.com/citations?view_op=view_citation&hl=en&user=ODCUXBgAAAAJ&sortby=pubdate&citation_for_view=ODCUXBgAAAAJ:zYLM7Y9cAGgC\">DroidChameleon</a></li>\n  \t\t\t\t<li><a href=\"https://link.springer.com/chapter/10.1007/978-3-642-37300-8_5\">ADAM</a></li>\n  \t\t\t</ul>\n\t\t</ul>\n\n  \t\t</td>\n  \t<td width=\"50%\">\n  \t\t<img src=\"./res/supported_obfuscations.png\" >\n  \t</td>\n  </tr>\n</table>\n</div>\n<div id=\"framework\"><center><h2>Evaluation Framework</h2></center></div>\n<div width=\"100%\">\n\t<p> Available on <a href=\"https://github.com/mhammad2/obfuscation_study\">GitHub</a>\n\t<img width=\"100%\" src=\"./res/methodology.png\" alt=\"Evaluation framework\"></div>\n\n<div  id=\"studied_anti_malware\"><center><h2>Studied Anti-malware Products</h2></center></div>\n<div>\n  <table style=\"width:100%\">\n  <tr >\n    <td width=\"50%\"><p>\n      To perform our analysis on anti-malware products, we have evaluated the performance and the resiliency of 61 commercial anti-malware products against obfuscations. In the paper, we included the top 21 products, shown in Table 3. In this website, we will include the results of all products.\n    </td>\n    <td width=\"50%\"><img align=\"left\" width=\"100%\" src=\"./res/anti_malware_products.png\" alt=\"Anti-malware products\"></td>\n  </tr>\n</table>\n</div>\n\n<div id=\"rqs\"><center><h2>Research Questions</h2></center></div>\n<div>\n<p>Our study answers the following research questions:\n  <ul>\n<li> RQ1. How is the accuracy of anti-malware products affected by obfuscation strategies? </li>\n<li>RQ2. How is the accuracy of anti-malware products affected by obfuscation tools? </li>\n<li>RQ3. How is the accuracy of anti-malware products affected by the year an app is created? </li>\n<li>RQ4. To what extent do obfuscation tools result in valid, installable, and runnable apps? </li>\n</ul>\n</div>\n\n<div id=\"analysis\"><center><h2>Data Analysis and Results</h2></center></div>\n<p>\n  To conduct this study, we have utilized our framework to obfuscated the 6,000 original apps. Table 4 shows the number of obfuscated apps resulted from applying the 29 obfuscation strategies leveraged by the obfuscation tools. Each empty cell indicates that we did not apply the corresponding obfuscation strategy from a particular obfuscation tool. In total, we have generated 73,362 obfuscated apps\n<div>\n<img width=\"100%\" src=\"./res/obfuscated_apps.png\" alt=\"Obfuscated apps\"></div>\n<div>\n  <table style=\"width:100%\">\n  <tr >\n    <td width=\"50%\">\n      <p>\n<i>Detection rate on original and obfuscated apps. </i>\n<p>Figure 2 shows the detection rate of 21 anti-malware products on the original dataset of 6,000 apps, depicted as black bars, and the obfuscated dataset of 73,362 apps, depicted as gray bars. Figure 2 demonstrates that the detection rate of anti-malware products on the original dataset is above 85% for 16 products, and between 75% and 85% for 4 anti-malware products.\n      </td>\n    <td width=\"50%\">\n      <img src=\"./res/fscore_anti_malware.png\" alt=\"\"></td>    \n  </tr>\n</table>\n<img width=\"100%\" src=\"./res/anti_malware_products_all.png\" alt=\"\">\n</div>\n\n<div><center><h4>Finding 1: Code obfuscation significantly impacts Android anti-malware products. The average detection rate for the top anti-malware products decreases from 87% to 67% -- 20% decrease.</h4></center></div>\n\n<div id=\"rq1\"><center><h2>RQ1. Obfuscation Strategies</h2></center></div>\n<p> Figure 3 contains box-and-whisker plots illustrating the impact of each obfuscation strategy on all 21 anti-malware products.\n\n<img width=\"100%\" src=\"./res/fscore_obf_strategy.png\" alt=\"\">\n\n<p> The figure below shows the impact of each obfuscation strategy on all 61 anti-malware products.\n<img width=\"100%\" src=\"./res/fscore_obf_strategy_all.png\" alt=\"\">  \n\n\n<div><center><h4>Finding 2: Majority of the Android anti-malware products are severely impacted by certain trivial obfuscation strategies, such as MAN. On average, MAN obfuscation decreases a product's detection rate by 28%.</h4></center></div>\n\n<div><center><h4>Finding 3: REF transformations make apps look suspicious, increasing the chance of an app being labeled as malicious.</h4></center></div>\n\n<div><center><h4>Finding 4: In general, combined transformations do not affect detection rates more than single transformations: The average detection rate of anti-malware products is 61% for single nontrivial obfuscations, and 61% for combined obfuscations.</h4></center></div>\n\n<div><center><h4>Finding 5: ENC_IDR and CF_ENC_IDR are the most successful transformations for evading anti-malware products.</h4></center></div>\n\n<div id=\"rq2\"><center><h2>RQ2: Obfuscation Tools</h2></center></div>\n\n\n<div>\n  <table style=\"width:100%\">\n  <tr >\n    <td width=\"50%\">\n      <p>\n<p>Figure 4 contains box-and-whisker plots illustrating the impact of each obfuscation tool on all 21 anti-malware products.\n      </td>\n    <td width=\"50%\">\n      <img width=\"100%\" src=\"./res/fscore_obf_tools.png\" alt=\"\"></td>    \n  </tr>\n</table>\n</div>\n<div>\n  <table style=\"width:100%\">\n  <tr >\n    <td width=\"50%\">\n      <p>\n<p>The Figure on the right contains box-and-whisker plots illustrating the impact of each obfuscation tool on all 61 anti-malware products.\n      </td>\n    <td width=\"50%\">\n      <img width=\"100%\" src=\"./res/fscore_obf_tools_all.png\" alt=\"\"></td>    \n  </tr>\n  </table>\n</div>\n<br/>\n\n</table>\n\n\n<div><center><h4>Finding 6: ADAM and Apktool/Jarsigner result in obfuscations that reduce anti-malware product accuracy the least, which is useful for benign authors, but works against the goals of malware authors.</h4></center></div>\n\n<div><center><h4>Finding 7: DashO reduces the accuracy of anti-malware products more than other obfuscation tools in our study.</h4></center></div>\n\n\n<div id=\"rq3\"><center><h2>RQ3: Time-aware analysis</h3></center></div>\n<div>\n  <table style=\"width:100%\">\n  <tr >\n    <td width=\"50%\">\n      <p>\n<p>\n  A significant factor that may interact with the effect of obfuscations on anti-malware product accuracy is time. For RQ3, we conducted a time-aware analysis that studies the accuracy of anti-malware products on original and obfuscated apps that belong to the same time period for the past 10 years. Figure 5 depicts the results of this analysis. \nTo conduct this experiment, we grouped apps to two-year time periods. Each time period contains all apps developed during that time period along with their obfuscated apps.\n      </td>\n    <td width=\"50%\">\n      <img width=\"100%\" src=\"./res/time_aware.png\" alt=\"\"></td>    \n  </tr>\n</table>\n</div>\n\n<div><center><h4>Finding 8: The average detection rates of anti-malware products tend to decrease over time, indicating that such products are slow to adopt signatures of malicious apps.</h4></center></div>\n\n\n<div id=\"rq4\"><center><h2>RQ4. Valid, installable, and runnable apps</h2></center></div>\n\n<div>\n  <table style=\"width:100%\">\n  <tr >\n    <td width=\"50%\">\n      <img width=\"100%\" src=\"./res/valid.png\" alt=\"\">\n    </td>    \n    <td width=\"50%\">\n      <img width=\"100%\" src=\"./res/runnable.png\" alt=\"\">\n    </td>    \n  </tr>\n</table>\n\n\n<div><center><h4>Finding 9: The percentage of obfuscated apps that are both installable and runnable in an order-aware fashion varies from 0%-62%. These results suggest a significant need for improving obfuscation tools so that applying their transformations retain an app's original behavior.</h4></center></div>\n\n\n<div>\n  <table style=\"width:100%\">\n  <tr >\n    <td width=\"50%\">\n      <p>\n<p>\n  Figure 6 compares the ability of obfuscation tools to produce installable and runnable apps with the detection rate of anti-malware products against obfuscated apps by each obfuscation tool.\n      </td>\n    <td width=\"50%\">\n      <img width=\"100%\" src=\"./res/detection_to_runnability.png\" alt=\"\"></td>    \n  </tr>\n</table>\n</div>\n\n\n\n\n\n\n\n\n\n\n<hr/>\n<!-- ***************** End of content ****************** -->\n<br><br><br><br>\n<div style=\"float:left\">\n            <a href=\"http://www.ics.uci.edu/~seal/\"><img ALT=\"[seal's logo]\" height=\"200\" src=../../seal.png></a>\n</div>\n<div style=\"float:right\">\n            <a href=\"http://www.ics.uci.edu\"><img ALT=\"[uci's logo]\" style=\"padding-top: 40px\" height=\"100\" src=../../uci.jpg></a>\n</div> \n</div>\n</body>\n", "encoding": "ascii"}