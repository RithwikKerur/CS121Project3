{"url": "https://seal.ics.uci.edu/projects/terminator/tla_module.html", "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<title>SEAL - Terminator</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<meta http-equiv=\"Reply-to\" content=\"malek at uci dot edu\">\n<meta http-equiv=\"Owner\" content=\"Sam Malek\">\n<meta name=\"Author\" content=\"Sam Malek\">\n<meta name=\"Generator\" content=\"Emacs\">\n<link rev=\"MADE\" href=\"mailto:malek at uci dot edu\">\n<link href=\"../../seal.css\" rel=\"stylesheet\" type=\"text/css\">\n<style type=\"text/css\">\n.tg  {border-collapse:collapse;border-spacing:0;}\n.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}\n.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}\n.tg .tg-5cbg{font-size:16px;font-family:\"Courier New\";background-color:#efefef}\n</style>\n</head>\n\n<body>\n<div class=\"wrapper\">\n    \n<!-- *************** Beginning of content ****************** -->\n\n<h2>TLA+ Android Module</h2>\n\n<table class=\"tg\" width=\"1200px\" align=\"center\">\n<colgroup>\n<col style=\"width: 1200px\">\n</colgroup>\n  <tr>\n      <th class=\"tg-5cbg\" align=\"left\">\n          --------------------------- MODULE AndroidRuntime ---------------------------\n          <br>\nCONSTANT Apps,          \\* The set of all apps installed in the device.\n<br>\n         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Perms,         \\* The set of all permissions defined in Android or by App develoeprs (i.e. custom permissions).\n         <br>\n         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SinkPerms, SourcePerms, \\* Only to distinguish sink and source perms\n         <br>\n         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CustomPerms,   \\* A Set of custom permissons defined by app developers\n         <br>\n         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AppReqPerms,   \\* A function, where AppReqPerms[app] is the set of permissions requested by App app\n         <br>\n         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AppDecPerms,   \\* A function, where AppReqPerms[app] is the set of permissions declared by App app\n         <br>\n         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnprotectedDB,          \\* The set of apps with unprotected DBS\n         <br>\n         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnprotectedIntentFilter \\* A function, where AppIntentFilter[app, perm] determines whether app intentFilter that exposed a perm-required capability is protected\n         <br>\n         <br>\n\nASSUME AppReqPerms \\in [Apps -> SUBSET Perms]\n<br>\nASSUME AppDecPerms \\in [Apps -> SUBSET CustomPerms]\n<br>\nASSUME UnprotectedDB \\in SUBSET Apps\n<br>\nASSUME UnprotectedIntentFilter \\in SUBSET (Apps \\X Perms)\n<br>\nASSUME SinkPerms \\subseteq Perms\n<br>\nASSUME SourcePerms \\subseteq Perms\n<br>\nASSUME CustomPerms \\subseteq Perms\n<br>\n<br>\n\n-----------------------------------------------------------------------------\n<br>\nVARIABLES appStat,    \\* The state of an application \n<br>\n          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permStat,   \\* The state of a permission\n          <br>\n          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dbStat,      \\* The state of the phone db\n          <br>\n          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;collidingPerms \\* The state of permission \n          <br>\n          <br>\n          \nTypeInvariant == \n<br>\n          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat \\in [Apps -> {\"Uninstalled\", \"Terminated\", \"Running\"}]\n          <br>\n          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ permStat \\in [(Apps \\X Perms) -> {\"Granted\", \"Revoked\"}]\n          <br>\n          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ dbStat \\in [Apps -> {\"Sensitive\", \"Clear\"}]\n          <br>\n          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ collidingPerms \\in [Apps -> {\"Unique\", \"Colliding\"}]\n          <br>\n          <br>\n\nInit == \n<br>\n        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat = [app \\in Apps |-> \"Uninstalled\"]    \\* App apps are not installed initially\n        <br>\n        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ permStat = [<<app, perm>> \\in (Apps \\X Perms) |-> \"Revoked\"] \\* No permission is granted initially\n            <br>\n        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ dbStat = [app \\in Apps |-> \"Clear\"]  \\* All app DBs are initially empty\n        <br>\n        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ collidingPerms = [app \\in (Apps) |-> \"Unique\"]\n        <br>\n        <br>\n-----------------------------------------------------------------------------\n<br>\n\n\nCollidePerm(app) == \n<br>\n                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF \\E perm \\in AppDecPerms[app], oldApp \\in Apps: /\\ appStat[oldApp] # \"Uninstalled\" \n                    <br>\n                                                                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ perm \\in AppDecPerms[oldApp] \\intersect AppDecPerms[app] \n                                                                      <br>\n                                                                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ perm \\in AppReqPerms[oldApp]\n                                                                      <br>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEN /\\ collidingPerms' = [collidingPerms EXCEPT ![app]= \"Colliding\"] \n                      <br>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE /\\ UNCHANGED collidingPerms\n                      <br>\n\n<br>\nInstall(app) == \n<br>\n               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat[app] = \"Uninstalled\"\n               <br>\n               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat' = [appStat EXCEPT ![app]=\"Terminated\"]\n               <br>\n               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ CollidePerm(app)\n               <br>\n               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ UNCHANGED <<permStat, dbStat>>\n                   <br>\n\n<br>\nUninstall(app) == \n<br>\n               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat[app] # \"Uninstalled\"\n               <br>\n               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat' = [appStat EXCEPT ![app]=\"Uninstalled\"]\n               <br>\n               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ UNCHANGED <<permStat, dbStat, collidingPerms>>\n                   <br>\n                   <br>\n\nRun(app) == \n<br>\n               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat[app] = \"Terminated\"\n               <br>\n               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat' = [appStat EXCEPT ![app]=\"Running\"]\n               <br>\n               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ UNCHANGED <<permStat, dbStat, collidingPerms>>\n                   <br>\n<br>\nTerminate(app) == \n<br>\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat[app] = \"Running\"\n              <br>\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat' = [appStat EXCEPT ![app]=\"Terminated\"]\n              <br>\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ UNCHANGED <<permStat, dbStat, collidingPerms>>\n                  <br>\n<br>\nGrant(app, perm) == \n<br>\n                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat[app] # \"Uninstalled\"\n                    <br>\n                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ permStat[<<app, perm>>] = \"Revoked\"\n                        <br>\n                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ perm \\in AppReqPerms[app]\n                    <br>\n                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ permStat' = [permStat EXCEPT ![<<app, perm>>]=\"Granted\"]\n                        <br>\n                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ UNCHANGED <<appStat, dbStat, collidingPerms>>\n                        <br>\n<br>\nRevoke(app, perm) == \n<br>\n                     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat[app] # \"Uninstalled\"\n                     <br>\n                     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ permStat[<<app, perm>>] = \"Granted\"\n                         <br>\n                     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ perm \\in AppReqPerms[app]\n                     <br>\n                     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ permStat' = [permStat EXCEPT ![<<app, perm>>]=\"Revoked\"]\n                         <br>\n                     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ UNCHANGED <<appStat, dbStat, collidingPerms>>\n                         <br>\n<br>\nStoreUnprotected(app, perm) ==\n<br>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat[app] = \"Running\"\n                      <br>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ permStat[<<app, perm>>] = \"Granted\"\n                          <br>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ perm \\in SourcePerms\n                      <br>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ app \\in UnprotectedDB\n                      <br>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ dbStat' = [dbStat EXCEPT ![app]=\"Sensitive\"]\n                      <br>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ UNCHANGED <<appStat, permStat, collidingPerms>>\n                          <br>\n<br>\nNext == \n<br>\n    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\E app \\in Apps :     \n    <br>\n    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\/ Install(app) \\/ Run(app) \\/ Terminate(app) \\/ Uninstall(app)\n    <br>\n    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\/ \\E perm \\in Perms: Grant(app, perm) \\/ Revoke (app, perm) \\/ StoreUnprotected(app, perm)\n    <br>\n<br>\n-----------------------------------------------------------------------------\n<br>\nSpec == Init /\\ [][Next]_<<appStat, permStat, dbStat, collidingPerms>>\n    <br>\n    <br>\n-----------------------------------------------------------------------------\n<br>\nNoPDL == \\A app \\in Apps: \n<br>\n         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\/ dbStat[app] = \"Clear\"\n         <br>\n         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\/ ~ (\\E malApp \\in Apps, perm \\in Perms: /\\ perm \\in AppReqPerms[malApp] \n         <br>\n                                                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ perm \\in SinkPerms\n                                                   <br>\n                                                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ app # malApp \n                                                   <br>\n                                                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat[malApp] = \"Running\" \n                                                   <br>\n                                                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ permStat[<<malApp, perm>>] = \"Granted\")\n                                                       <br><br>\n\nNoPE == \\A filter \\in UnprotectedIntentFilter: \n<br>\n        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\/ appStat[filter[1]] # \"Running\"\n        <br>\n        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\/ permStat[filter] # \"Granted\"\n        <br>\n        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\/ ~ (\\E malApp \\in Apps, perm \\in Perms: /\\ perm \\in AppReqPerms[malApp] \n        <br>\n                                                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ perm = filter[2] \n                                                  <br>\n                                                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ malApp # filter[1] \n                                                  <br>\n                                                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat[malApp] = \"Running\" \n                                                  <br>\n                                                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ permStat[<<malApp, perm>>] = \"Granted\")\n                                                      <br>\n                                                      <br>\n\nNoICP == ~ (\\E app \\in Apps, malApp \\in Apps, perm \\in Perms: /\\ app # malApp \n<br>\n                                                              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ collidingPerms[app] = \"Colliding\"\n                                                              <br>\n                                                              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ perm \\in AppDecPerms[app] \n                                                              <br>\n                                                              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ perm \\in AppDecPerms[malApp] \n                                                              <br>\n                                                              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ perm \\in AppReqPerms[malApp]\n                                                              <br>\n                                                              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ appStat[malApp] = \"Running\" \n                                                              <br>\n                                                              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\\ permStat[<<malApp, perm>>] = \"Granted\")\n                                                                  <br>\n                                                                  <br>\nTHEOREM Spec => TypeInvariant /\\ NoPDL /\\ NoPE /\\ NoICP\n<br><br>\n=============================================================================\n      </th>\n  </tr>\n</table>\n\n\n<!-- ***************** End of content ****************** -->\n<br><br>\n<div style=\"float:left\">\n            <a href=\"http://www.ics.uci.edu/~seal/\"><img ALT=\"[seal's logo]\" height=\"200\" src=../../seal.png></a>\n</div>\n<div style=\"float:right\">\n            <a href=\"http://www.ics.uci.edu\"><img ALT=\"[uci's logo]\" style=\"padding-top: 40px\" height=\"100\" src=../../uci.jpg></a>\n</div>\n</div>\n</body>", "encoding": "ascii"}