{"url": "https://www.ics.uci.edu/~majumder/VC/211HW3/vlfeat/make/doc.mak", "content": "# file: doc.mak\n# description: Makefile submodule to build the documentation\n# author: Andrea Vedaldi\n\n# Copyright (C) 2013-14 Andrea Vedaldi.\n# Copyright (C) 2007-12 Andrea Vedaldi and Brian Fulkerson.\n# All rights reserved.\n#\n# This file is part of the VLFeat library and is made available under\n# the terms of the BSD license (see the COPYING file).\n\ninfo: doc-info\nclean: doc-clean\ndistclean: doc-distclean\narchclean: doc-archclean\n\n# --------------------------------------------------------------------\n#                                                        Configuration\n# --------------------------------------------------------------------\n\nDOXYGEN    ?= doxygen\n\nPDFLATEX   ?= pdflatex\nFIG2DEV    ?= fig2dev\nCONVERT    ?= convert\n\nPYTHON     ?= python\nGROFF      ?= groff\nTIDY       ?= tidy\n\nMV         ?= mv\nSED        ?= sed\n\n# 95 DPI makes a letter page 808 pixels large\nscreen_dpi := 95\n\ndoc: doc-api doc-man doc-matlab\n\n# generate doc-dir: target\n$(eval $(call gendir, doc, \\\n\t doc \\\n\t doc/build doc/build/api doc/build/man doc/build/figures \\\n         doc/demo doc/figures doc/matlab doc/api))\n\n# generate results-dir: target\n$(eval $(call gendir, results, results))\n\n# --------------------------------------------------------------------\n#                                                               MATLAB\n# --------------------------------------------------------------------\n\n.PHONY: doc-deep\n\nifdef MATLAB_PATH\nifeq ($(call gt,$(MATLAB_VER),80300),)\ndoc-matlab: doc/matlab/helpsearch-v2/segments.gen\nelse\ndoc-matlab: doc/matlab/helpsearch/deletable\nendif\nendif\n\n# use MATLAB to create the figures for the tutorials\ndoc-deep: all $(doc-dir) $(results-dir)\n\tcd toolbox ; \\\n\tVL_DEMO_PRINT=y $(MATLAB_EXE) \\\n\t    -$(ARCH) -nodesktop -nosplash \\\n\t    -r \"clear mex;vl_setup demo;vl_demo;exit\"\n\t@echo \"Trimming images ...\"\n\tfind doc/demo -name \"*.jpg\" -exec $(CONVERT) -trim \"{}\" \"{}\" \";\"\n\t@echo \"Done trimming\"\n\t$(MAKE) doc\n\n# make documentation searchable in MATLAB\ndoc/matlab/helpsearch-v2/segments.gen : doc/build/matlab/helpsearch-v2/segments.gen $(doc-dir)\n\tcp -v doc/build/matlab/helptoc.xml doc/matlab/\n\tcp -rv doc/build/matlab/helpsearch-v2 doc/matlab/\n\ndoc/build/matlab/helpsearch-v2/segments.gen: doc/build/matlab/helptoc.xml\n\t$(MATLAB_EXE) -$(ARCH) -nodisplay -r \"builddocsearchdb('doc/build/matlab/') ; exit\"\n\n# for older MATLABs\ndoc/matlab/helpsearch/deletable : doc/build/matlab/helpsearch/deletable $(doc-dir)\n\tcp -v doc/build/matlab/helptoc.xml doc/matlab/\n\tcp -rv doc/build/matlab/helpsearch doc/matlab/\n\ndoc/build/matlab/helpsearch/deletable: doc/build/matlab/helptoc.xml\n\t$(MATLAB_EXE) -$(ARCH) -nodisplay -r \"builddocsearchdb('doc/build/matlab/') ; exit\"\n\n# --------------------------------------------------------------------\n#                                                                 MDoc\n# --------------------------------------------------------------------\n\ndoc-matlab: doc/build/matlab/mdoc.html\n\n#\n# Use mdoc.py to create the toolbox documentation that will be\n# embedded in the website.\n#\n\ndoc/build/matlab/mdoc.html doc/build/matlab/helptoc.xml: \\\n\t$(m_src) \\\n\tdocsrc/mdoc.py #make/doc.mak\n\t$(PYTHON) docsrc/mdoc.py toolbox doc/build/matlab \\\n\t          --format=web \\\n\t          --exclude='noprefix/.*' \\\n                  --exclude='xtune/.*' \\\n                  --exclude='xtest/.*' \\\n\t          --exclude='.*/vl_test_.*' \\\n\t          --exclude='.*/vl_demo_.*' \\\n\t          --exclude='.*/vl_tune_.*' \\\n\t          --helptoc \\\n\t          --helptoc-toolbox-name VLFeat \\\n\t          --verbose\n\n# --------------------------------------------------------------------\n#                                            Auto-include demo m-files\n# --------------------------------------------------------------------\n\nm_demo_src=$(wildcard toolbox/demo/vl_demo_*.m)\n\n# Convert the various man pages\ndoc/build/matlab/demo.xml : $(m_demo_src) $(doc-dir) make/doc.mak\n\t@echo \"Indexing demo files -> $@\"\n\t@( \\\n\t  echo '<!DOCTYPE group PUBLIC ' ; \\\n\t  echo '  \"-//W3C//DTD XHTML 1.0 Transitional//EN\"' ; \\\n\t  echo '  \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">' ; \\\n\t  echo \"<group>\" ; \\\n\t  for fullName in $(m_demo_src) ; \\\n\t  do  \\\n\t  fileName=$${fullName#toolbox/demo/} ; \\\n\t  stem=$${fileName%.*} ; \\\n\t  ( \\\n\t    echo \"<page id='$${stem}' name='$${stem}' title='$${stem}' hide='yes'>\" ; \\\n\t    printf \"<h1>Source code for <code>%s.m</code></h1>\" \"$${stem}\"; \\\n\t    echo \"<p>This file is located in the <code>toolbox/demo</code> folder in VLFeat package.</p>\" ; \\\n\t    echo \"<precode type='matlab'>\" ; \\\n\t    echo \"<include src='toolbox/demo/$${fileName}' type='text'/>\" ; \\\n\t    echo \"</precode>\" ; \\\n\t    echo \"</page>\" \\\n\t  ) ; \\\n\t  done ; \\\n\t  echo \"</group>\" ; \\\n\t)  > \"$@\"\n\n# --------------------------------------------------------------------\n#                                                                  Man\n# --------------------------------------------------------------------\n\ndoc-man: doc/build/man/xman.xml doc/build/man/xman.html\nman_src := $(wildcard src/*.1) $(wildcard src/*.7)\nman_tgt := $(subst src/,doc/build/man/,$(addsuffix .html,$(man_src)))\n\ndoc/build/man/index.html : $(doc-dir)\n\n# Integrate in Webdoc\ndoc/build/man/xman.xml : $(man_tgt) $(doc-dir)\n\t@echo \"Generating MAN XML webdooc document $@\"\n\t@echo \"<group>\" > \"$@\"\n\t@for fullName in $(man_src) ; \\\n\tdo  \\\n\t  fileName=$${fullName#src/} ; \\\n\t  stem=$${fileName%.*} ; \\\n\t  ( \\\n\t    echo \"<page id='man.$${stem}' name='$${stem}' title='$${stem}'>\" ; \\\n\t    echo \"<include src='doc/build/man/$${fileName}.html'/>\" ; \\\n\t    echo \"</page>\" \\\n\t  ) >> \"$@\" ; \\\n\tdone\n\techo \"</group>\" >> \"$@\"\n\n# Index page\ndoc/build/man/xman.html : $(man_tgt) $(doc-dir)\n\t@echo \"Generating MAN HTML index page $@\"\n\t@echo \"<ul>\" > \"$@\"\n\t@for fullName in $(man_src) ; \\\n\tdo  \\\n\t  fileName=$${fullName#src/} ; \\\n\t  stem=$${fileName%.*} ; \\\n\t  echo \"<li><a href='%pathto:man.$${stem};'>$${stem}</a></li>\" >> \"$@\" ; \\\n\tdone\n\techo \"</ul>\" >> \"$@\"\n\n# Convert the various man pages\ndoc/build/man/%.html : src/% $(doc-dir)\n\t@echo MAN2HTML \"$(@)\"\n\t@( \\\n\t  echo '<!DOCTYPE group PUBLIC ' ; \\\n\t  echo '  \"-//W3C//DTD XHTML 1.0 Transitional//EN\"' ; \\\n\t  echo '  \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">' ; \\\n\t  echo \"<group>\" ; \\\n\t  $(GROFF) -mandoc -Thtml < \"$<\" | \\\n\t    $(TIDY) -asxhtml 2>/dev/null | \\\n\t    sed -e '1,/<body>/ d' -e '/<\\/body>/,$$ d' ; \\\n\t  echo \"</group>\" \\\n\t)  > \"$@\"\n\n# --------------------------------------------------------------------\n#                                       FIG and SVG figures and images\n# --------------------------------------------------------------------\n\ndoc_fig_src := $(wildcard docsrc/figures/*.fig)\ndoc_svg_src := $(wildcard docsrc/figures/*.svg)\ndoc_fig_tgt += \\\n$(subst docsrc/,doc/,$(doc_fig_src:.fig=.png)) \\\n$(subst docsrc/,doc/,$(doc_svg_src:.svg=.png))\n\n.PRECIOUS: doc/build/figures/%.pdf\n.PRECIOUS: doc/build/figures/%.tex\n\ndoc/figures/%.png : doc/build/figures/%.pdf\n\t$(call C,CONVERT) -units PixelsPerInch -density $(screen_dpi) -resample $(screen_dpi) -trim \"$<\" \"$@\"\n\ndoc/figures/%.png : docsrc/figures/%.svg\n\t$(call C,CONVERT) -units PixelsPerInch -density $(screen_dpi) -resample $(screen_dpi) -trim \"$<\" \"$@\"\n\n# Fig\ndoc/build/figures/%-raw.tex : docsrc/figures/%.fig $(doc-dir)\n\t$(call C,FIG2DEV) -L pdftex_t -p doc/build/figures/$*-raw.pdf \"$<\" \"$@\"\n\ndoc/build/figures/%-raw.pdf : docsrc/figures/%.fig $(doc-dir)\n\t$(call C,FIG2DEV) -L pdftex \"$<\" \"$@\"\n\ndoc/build/figures/%.pdf doc/build/figures/%.aux doc/build/figures/%.log : \\\n  doc/build/figures/%.tex doc/build/figures/%-raw.tex doc/build/figures/%-raw.pdf $(doc-dir)\n\t$(call C,PDFLATEX) -shell-escape -interaction=batchmode -output-directory=\"$(dir $@)\" \"$<\" 2>/dev/null\n\ndoc/build/figures/%.tex : $(doc-dir)\n\t@echo GEN \"$(@)\"\n\t@/bin/echo '\\documentclass[landscape]{article}'                 >$@\n\t@/bin/echo '\\usepackage[paper=a2paper,margin=0pt]{geometry}'\t>>$@\n\t@/bin/echo '\\usepackage{graphicx,color}'\t\t\t>>$@\n\t@/bin/echo '\\begin{document}'\t\t\t\t\t>>$@\n\t@/bin/echo '\\pagestyle{empty}'\t\t\t\t\t>>$@\n\t@/bin/echo '\\input{doc/build/figures/$(*)-raw.tex}'\t\t>>$@\n\t@/bin/echo '\\end{document}'\t\t\t\t\t>>$@\n\n# --------------------------------------------------------------------\n#                                                              Doxygen\n# --------------------------------------------------------------------\n\ndoc-api: doc/api/index.html\n\ndoc/api/index.html: docsrc/doxygen.conf docsrc/vlfeat.bib VERSION \\\n  $(dll_src) $(dll_hdr) $(doc_fig_tgt) toolbox/mexutils.h \\\n  doc/build/doxygen_header.html doc/build/doxygen_footer.html\n\tln -sf docsrc/vlfeat.bib vlfeat.bib\n\t$(DOXYGEN) $< 2>&1 | sed -e 's/Warning:/warning: /g'\n\trm vlfeat.bib\n\tcp -fv docsrc/doxygen.css doc/api/doxygen.css\n\n# --------------------------------------------------------------------\n#                                                               Webdoc\n# --------------------------------------------------------------------\n\nwebdoc_src = $(wildcard docsrc/*.xml) $(wildcard docsrc/*.html) $(wildcard docsrc/tutorials/*.html)\n\ndoc: doc/index.html doc/vlfeat.css doc/pygmentize.css $(doc_fig_tgt)\n\n# prebuild to generate doxygen header and footer\ndoc/build/doxygen_header.html doc/build/doxygen_footer.html: $(webdoc_src) $(doc-dir)\n\tVERSION=$(VER) $(PYTHON) docsrc/webdoc.py \\\n\t     --outdir=doc/build/ \\\n             --verbose \\\n\t     docsrc/vlfeat-website-preproc.xml\n\tcat doc/build/api/index.html | \\\n\t    sed -n '/<!-- Doc Here -->/q;p'  > doc/build/doxygen_header.html\n\techo '<div id=\"top\">' >> doc/build/doxygen_header.html\n\tcat doc/build/api/index.html | \\\n\t    sed -n '/<!-- Doc Here -->/,$$p' > doc/build/doxygen_footer.html\n\ndoc/vlfeat.css : docsrc/vlfeat.css\n\tcp -fv \"$<\" \"$@\"\n\ndoc/pygmentize.css : docsrc/pygmentize.css\n\tcp -fv \"$<\" \"$@\"\n\n# build: this is the last step integrating all documentation\ndoc/index.html: $(webdoc_src) $(doc-dir) \\\n doc/api/index.html \\\n doc/build/matlab/mdoc.html \\\n doc/build/man/xman.xml \\\n doc/build/man/xman.html \\\n doc/build/matlab/demo.xml \\\n docsrc/webdoc.py \\\n $(html_src)\n\tcp doc/api/index.html doc/api/index.html.bak\n\tVERSION=$(VER) $(PYTHON) docsrc/webdoc.py \\\n             --outdir=doc \\\n\t     --verbose \\\n\t     --indexfile=doc/index.txt \\\n\t     --doxytag=doc/doxygen.tag \\\n\t     --doxydir=api \\\n\t     docsrc/vlfeat-website.xml\n\tmv doc/api/index.html.bak doc/api/index.html\n\trsync -r docsrc/images doc/\n\n# --------------------------------------------------------------------\n#                                               Maintenance and others\n# --------------------------------------------------------------------\n\n.PHONY: doc-clean, doc-archclean, doc-distclean\nno_dep_targets += doc-clean doc-archclean doc-distclean\n\nVERSION: vl/generic.h\n\techo \"$(VER)\" > VERSION\n\ndoc-clean:\n\trm -rf doc/build\n\ndoc-archclean:\ndoc-distclean:\n\trm -f  docsrc/*.pyc\n\trm -rf doc\n\n# --------------------------------------------------------------------\n#                                                       Debug Makefile\n# --------------------------------------------------------------------\n\n.PHONY: doc-info\ndoc-info :\n\t$(call echo-title,Documentation)\n\t$(call dump-var,man_src)\n\t$(call dump-var,fig_src)\n\t$(call dump-var,demo_src)\n\t$(call dump-var,pdf_tgt)\n\t$(call dump-var,eps_tgt)\n\t$(call dump-var,png_tgt)\n\t$(call dump-var,jpg_tgt)\n\t$(call dump-var,man_tgt)\n\t$(call dump-var,DOXYGEN)\n\t@echo\n\n# --------------------------------------------------------------------\n#                                                        Xcode Support\n# --------------------------------------------------------------------\n\n.PHONY: dox-\ndox- : dox\n\n.PHONY: dox-clean\ndox-clean:\n\n# Local variables:\n# mode: Makefile\n# End:\n", "encoding": "ascii"}