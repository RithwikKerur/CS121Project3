{"url": "https://www.ics.uci.edu/~sternh/courses/210/bank.R", "content": "# load tidyverse library (must be installed first)\r\n# install.packages(\"tidyverse\")\r\nlibrary(tidyverse)\r\n\r\n#\r\n# generate normally distributed data with specified mean/s.d.)\r\n#\r\nnofee <- round(scale(rnorm(25,0,1))*272 + 1871)\r\nrebate <- round(scale(rnorm(25,0,1))*360 + 2061)\r\n\r\n#\r\n# build a function to describe a data vector\r\ndescribe <- function(x){c(n=length(x),mn=mean(x),sd=sqrt(var(x)),quantile(x))}\r\n\r\n#\r\n# exploratory data analysis \r\n#\r\ndescribe(nofee)\r\ndescribe(rebate)\r\nhist(nofee)\r\nqqnorm(nofee)\r\nhist(rebate)\r\nqqnorm(rebate)\r\n#\r\n# t-test function to compare population means\r\n#\r\nt.test(nofee,rebate,var.equal=TRUE)\r\nt.test(nofee,rebate,var.equal=FALSE)\r\n\r\n#\r\n# code to carry out randomization-based inference\r\n#\r\ndata <- c(nofee, rebate)\r\ntotn <- length(data)\r\nnsims <- 10000\r\nrandomdist <- rep(0,nsims)\r\nfor (i in (1:nsims)) {\r\n  a <- sample(data,totn/2)\r\n  suma <- sum(a)\r\n  sumb <- sum(data) - suma\r\n  randomdist[i] <- sumb/length(rebate) - suma/length(nofee)\r\n}\r\ndescribe(randomdist)\r\nhist(randomdist)\r\nsum(abs(randomdist) > (mean(rebate)-mean(nofee)))/nsims\r\n\r\n", "encoding": "ascii"}