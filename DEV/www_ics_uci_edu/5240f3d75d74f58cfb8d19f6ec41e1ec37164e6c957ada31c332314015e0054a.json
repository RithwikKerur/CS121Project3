{"url": "https://www.ics.uci.edu/~yamingy/bayesD_demo2.r", "content": "source(\"bayesD_cocktail.r\")\n\n## setting up information matrices for a Michaelis-Menten-type model\nn=30\nm=3\nX=matrix(nrow=n, ncol=m)\nX[,1]=1\ns=3*(1:n)/n\n\nA=array(dim=c(10, n, m, m));\nfor(i in 1:10){\n  theta=i/5;\n  X[,2]=s/(s+theta)\n  X[,3]=s/(s+theta)^2\n  for(k in 1:n)\n    A[i, k, ,]=X[k,]%*% t(X[k,]);\n}\nprior=rep(1/10, 10);\n\nprint(\"Bayesian D-optimal design for a Michaelis-Menten-type model\");\nprint(\"model: y ~ b1 + b3/(b2+x) + N(0, sig^2)\");\nprint(\"design variable: 0<=x<=3 discretized\");\nprint(\"prior on b2: uniform on {i/5: i=1,2,...,10}\"); \n\n## use cocktail algorithm (alg=1)\nw=bayesD(A, prior, maxiter=10000, small=1e-4, alpha=0, alg=1)\n\nprint(\"output:\");\nprint(\"optimal support points x(i)\");\nprint(s[w>0]);\nprint(\"optimal weights w(i)\");\nprint(w[w>0]);\n\n", "encoding": "ascii"}