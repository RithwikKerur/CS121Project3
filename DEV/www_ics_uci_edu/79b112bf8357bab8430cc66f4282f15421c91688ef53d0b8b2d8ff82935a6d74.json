{"url": "https://www.ics.uci.edu/~wjohnson/BIDA/Ch11/Ch11SAScode.txt", "content": "/**************************************************************************************************\nBayesian Ideas and Data Analysis\nChapter 11: Count Data\nSAS code for the FMD example in the ZIP subsection\n*****************************************************************************************************/\n\nproc import out=FMDdata1\n  datafile='G:\\MyDocuments\\BAYES\\PoissonRegression\\FMDdata\\FMDData.xls'\n  dbms=excel replace;\n  getnames=yes;\n  sheet=\"Sheet1\";\nrun;\nproc print data=FMDdata1;\nrun;\n\nproc means data=FMDdata1;   \n var Cattle;\nrun;\n\n\ndata FMDdata;\n  set FMDdata1;\n  stdcattle=(Cattle-162667.88)/ 112105.31;\nrun;\nproc print data=FMDdata;\nrun;\n\n\n\n/* 1. MLEs for ordinary Poisson regression of the FMD 1998 data.  \n      Response: yi = FMD count in province i\n      Covariates:  EasternTurkey (1=east; 0=west);  standardized cattle population \n      AIC=231.2    BIC=237.8\n*/\nproc genmod data=FMDdata;\n  model FMD1998=stdcattle EasternTurkey / dist=Poisson;\nrun;\n\n\n\n\n/* 2. Bayesian ordinary Poisson regression of the FMD 1998 data.  \n      Response: yi = FMD count in province i\n      Covariates:  EasternTurkey (1=east; 0=west);  standardized cattle population  \n      DIC=231.2.  Estimates similar to MLEs\n*/\nproc mcmc data=FMDdata nbi=15000 nmc=1000000 dic propcov=quanew;\nparms beta1 0 beta2 0 beta3 0;\nprior beta: ~ normal(0,var=1000);\nmu = exp(beta1 + beta2*stdcattle + beta3*EasternTurkey);\nmodel FMD1998 ~ poisson(mu);\nrun;\n\n\n\n\n\n/* 3. Bayesian ZIP regression of the FMD 1998 data.  \n      Response: yi = FMD count in province i\n      Covariates:  EasternTurkey (1=east; 0=west);  standardized cattle population \n      DIC=172.3\n*/\nproc mcmc data=FMDdata nbi=15000 nmc=1000000 dic propcov=quanew;\nparms beta1 0 beta2 0 beta3 0 pi 0.5;\nprior beta: ~ normal(0,var=1000);\nmu = exp(beta1 + beta2*stdcattle + beta3*EasternTurkey);\nprior pi ~ uniform(0,1);\nllike=log(pi*(FMD1998 eq 0) + (1-pi)*pdf(\"poisson\",FMD1998,mu));\nmodel general(llike);\nrun;\n\n\n\n\n", "encoding": "ascii"}