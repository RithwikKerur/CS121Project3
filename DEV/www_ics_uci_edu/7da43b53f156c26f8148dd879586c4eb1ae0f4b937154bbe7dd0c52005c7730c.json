{"url": "https://www.ics.uci.edu/~dechter/courses/ics-275a/fall-99/slides/node239.html", "content": "<!DOCTYPE HTML PUBLIC \"-//W3O//DTD W3 HTML 2.0//EN\">\r\n<!Converted with LaTeX2HTML 95.1 (Fri Jan 20 1995) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds >\r\n<HEAD>\r\n<TITLE> Using the Statistics Facility</TITLE>\r\n</HEAD>\r\n<BODY>\r\n<meta name=\"description\" value=\" Using the Statistics Facility\">\r\n<meta name=\"keywords\" value=\"umsroot\">\r\n<meta name=\"resource-type\" value=\"document\">\r\n<meta name=\"distribution\" value=\"global\">\r\n<P>\r\n <BR> <HR><A NAME=tex2html5112 HREF=\"node240.html\"><IMG ALIGN=BOTTOM ALT=\"next\" SRC=\"http://www.ecrc.de/eclipse/new_icons//next_motif.gif\"></A>   <A NAME=tex2html5110 HREF=\"node236.html\"><IMG ALIGN=BOTTOM ALT=\"up\" SRC=\"http://www.ecrc.de/eclipse/new_icons//up_motif.gif\"></A>   <A NAME=tex2html5106 HREF=\"node238.html\"><IMG ALIGN=BOTTOM ALT=\"previous\" SRC=\"http://www.ecrc.de/eclipse/new_icons//previous_motif.gif\"></A>      <A NAME=tex2html5114 HREF=\"node321.html\"><IMG ALIGN=BOTTOM ALT=\"index\" SRC=\"http://www.ecrc.de/eclipse/new_icons//index_motif.gif\"></A>   <BR>\r\n<B> Next:</B> <A NAME=tex2html5113 HREF=\"node240.html\"> Exhaustive Collection</A>\r\n<B>Up:</B> <A NAME=tex2html5111 HREF=\"node236.html\"> Profiling Prolog Execution</A>\r\n<B> Previous:</B> <A NAME=tex2html5107 HREF=\"node238.html\"> Using the Profiling </A>\r\n<BR> <HR> <P>\r\n<H1><A NAME=SECTION002030000000000000000> Using the Statistics Facility</A></H1>\r\n<P>\r\nThe statistics tool is predicate based.\r\nThe user can switch on statistics collection\r\nfor all predicates or for selected ones.\r\n<P>\r\nThe statistics tool is closely related to the debugger.\r\nIn order to apply it to a program, this program must be\r\ncompiled in <b> dbgcomp</b>-mode and it must be run with the debugger\r\nswitched on.\r\n<P>\r\nA sample output from the statistics tool looks like this:\r\n<PRE> PROCEDURE         #    MODULE    #CALL   #EXIT    #TRY    #CUT   #NEXT   #FAIL\r\ntrue               /0   sepia_k       2       2       0       0       0       0\r\nfail               /0   sepia_k      27       0       0       0       0      27\r\nset_flag           /3   sepia_k       1       1       0       0       0       0\r\nenv                /0   sepia_k       1       1       1       0       2       0\r\nspaces             /1   sepia_k     309     309     309     286      23       0\r\n!                  /0   sepia_k     286     286       0       0       0       0\r\nopen               /3   sepia_k       1       1       0       0       0       0\r\n|TOTAL:     PROCEDURES: 7           627     600     310     286      25      27\r\n</PRE>\r\n<P>\r\nThe numbers show how often the execution passed the various predicate ports\r\n(for a description of the ports see <A HREF=\"#chapdebug\"><IMG ALIGN=BOTTOM ALT=\"gif\" SRC=\"http://www.ecrc.de/eclipse/new_icons//cross_ref_motif.gif\"></A>).\r\nIn coroutine mode the table has 2 more columns for DELAY and WAKE ports.\r\nThe relation between the debugger ports and the statistics counters is as\r\nfollows:\r\n<P>\r\n<DL ><DT>CALL -\r\n<DD> counts CALL ports\r\n<DT>EXIT -\r\n<DD> counts EXIT and *EXIT ports\r\n<DT>TRY -\r\n<DD> there is no corresponding port, it stands for entering the\r\nfirst of several matching clauses or a disjunction (choicepoint creation)\r\n<DT>CUT -\r\n<DD> counts CUT ports\r\n<DT>NEXT -\r\n<DD> counts NEXT ports\r\n<DT>FAIL -\r\n<DD> counts FAIL and *FAIL ports\r\n<DT>DELAY -\r\n<DD> counts DELAY ports (in coroutine mode only)\r\n<DT>WAKE -\r\n<DD> counts WAKE ports (in coroutine mode only)\r\n<P>\r\n </DL>\r\n<P>\r\nPorts that can not be displayed by the debugger are not available for\r\nthe statistics tool either, ie.\r\n<UL><LI> subgoals of predicates that are set to <tt> skipped</tt> (user predicates\r\nare not skipped by default)\r\n<LI> subgoals of predicates that are compiled in <b> nodbgcomp</b>-mode\r\n<LI> untraceable predicates (user predicates and all built-ins are\r\ntraceable by default)\r\n</UL>\r\n<P>\r\nThere is a global flag <tt> statistics</tt> (accessed with <b> set_flag/2</b>,\r\n<b> get_flag/2</b>) that can take four possible values:\r\n<UL><LI> <b> off</b> - no procedure is counted\r\n<LI> <b> some</b> - some specified (using <b> set_flag/3</b> or\r\n<b> set_statistics/2</b>) procedures are counted\r\n<LI> <b> all</b> - all traceable procedures are counted\r\n<LI> <b> mode</b> - like <b> all</b>, but the mode usage is also collected\r\n</UL>\r\n<P>\r\nThe output of the statistics tool goes to the <tt> output</tt> stream.\r\nMost of the time it is useful to write it into a file using\r\n<blockquote> <PRE>?- open(table, write, output), print_statistics, close(output).\r\n</PRE></blockquote>\r\nwhere it can be further processed.\r\nThe statistics table can be sorted on  a specified column\r\nwith the Unix <i> sort(2)</i> command, e.g.\r\n<blockquote> <PRE>sort -n -r +4 table\r\n</PRE></blockquote>\r\nwill sort with procedures that exited most frequently first.\r\n<P>\r\nTo improve the performance of a program, the following\r\nconsiderations might apply:\r\n<P>\r\n<UL><LI> The <b> CALL</b> ports show how often a procedure is called\r\nand hence procedures with many CALLS are crucial to the program's\r\nperformance.\r\n<P>\r\n<LI> Many <b> TRY</b> ports show that either the procedure\r\nis really nondeterministic, or that it is written in such a manner\r\nthat the compiler cannot decide which clause will match a given\r\ncall and so it has to create a choice point and try several clauses\r\nin sequence.\r\n<P>\r\n<LI> <b> NEXT</b> ports mean most often that the compiler did not\r\nsucceed to pick up the right clause at the first try\r\nand so another one had to be tried.\r\nRewriting the procedure might help, as well as providing mode\r\ndeclarations.\r\n<P>\r\n<LI> If there are much less <b> CUT</b> ports than <b> CALL</b> ports\r\nof the procedure <b> !/0</b>, it means that some cuts in\r\nthe program source are redundant.\r\n</UL><BR> <HR>\r\n<UL> \r\n<LI> <A NAME=tex2html5115 HREF=\"node240.html#SECTION002031000000000000000\"> Exhaustive Collection</A>\r\n<LI> <A NAME=tex2html5116 HREF=\"node241.html#SECTION002032000000000000000\"> Selective Collection</A>\r\n<LI> <A NAME=tex2html5117 HREF=\"node242.html#SECTION002033000000000000000\"> Obtaining mode information</A>\r\n</UL>\r\n<BR> <HR><A NAME=tex2html5112 HREF=\"node240.html\"><IMG ALIGN=BOTTOM ALT=\"next\" SRC=\"http://www.ecrc.de/eclipse/new_icons//next_motif.gif\"></A>   <A NAME=tex2html5110 HREF=\"node236.html\"><IMG ALIGN=BOTTOM ALT=\"up\" SRC=\"http://www.ecrc.de/eclipse/new_icons//up_motif.gif\"></A>   <A NAME=tex2html5106 HREF=\"node238.html\"><IMG ALIGN=BOTTOM ALT=\"previous\" SRC=\"http://www.ecrc.de/eclipse/new_icons//previous_motif.gif\"></A>      <A NAME=tex2html5114 HREF=\"node321.html\"><IMG ALIGN=BOTTOM ALT=\"index\" SRC=\"http://www.ecrc.de/eclipse/new_icons//index_motif.gif\"></A>   <BR>\r\n<B> Next:</B> <A NAME=tex2html5113 HREF=\"node240.html\"> Exhaustive Collection</A>\r\n<B>Up:</B> <A NAME=tex2html5111 HREF=\"node236.html\"> Profiling Prolog Execution</A>\r\n<B> Previous:</B> <A NAME=tex2html5107 HREF=\"node238.html\"> Using the Profiling </A>\r\n<BR> <HR> <P>\r\n<BR> <HR>\r\n<P><ADDRESS>\r\n<I>Micha Meier <BR>\r\nMon Mar  4 12:11:45 MET 1996</I>\r\n</ADDRESS>\r\n</BODY>\r\n", "encoding": "ascii"}