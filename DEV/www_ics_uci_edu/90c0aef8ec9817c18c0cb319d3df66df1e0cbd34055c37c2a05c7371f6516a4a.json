{"url": "https://www.ics.uci.edu/~wjohnson/BIDA/Ch7/Ch7Rcode.txt", "content": "# Ch 7: Basic concepts of regression\n# R code\n\n\n##  Figure 7.1.  Examples of interaction patterns\n\npar(mfrow=c(2,2))\nx11 <- 10\nx21 <- 20\ny11 <- .05\ny12 <- .10\ny21 <- .10\ny22 <- .15\nplot(c(x11,x21),c(y11,y12),xlab=expression(x[1]),ylab=\"Mean\", main=\"No Interaction\", type=\"l\", ylim=c(0,.20), lwd=2, cex=2)\nlines(c(x11,x21),c(y21,y22),type=\"l\",lty=2, lwd=2, cex=2)\n#legend(16,.05, c(\"x2=0\", \"x2=1\"), lty=c(1,2),bty=\"n\")\n\nx11 <- 10\nx21 <- 20\ny11 <- .10\ny12 <- .15\ny21 <- .05\ny22 <- .20\nplot(c(x11,x21),c(y11,y12),xlab=expression(x[1]),ylab=\"Mean\", main=\"Interaction\", type=\"l\", ylim=c(0,.20), lwd=2)\nlines(c(x11,x21),c(y21,y22),type=\"l\",lty=2, lwd=2)\n#legend(16,.05, c(\"x2=0\", \"x2=1\"), lty=c(1,3),bty=\"n\")\n\nx11 <- 10\nx21 <- 20\ny11 <- .10\ny12 <- .20\ny21 <- .05\ny22 <- .10\nplot(c(x11,x21),c(y11,y12),xlab=expression(x[1]),ylab=\"Mean\", main=\"Interaction\", type=\"l\", ylim=c(0,.20), lwd=2)\nlines(c(x11,x21),c(y21,y22),type=\"l\",lty=2, lwd=2)\n#legend(16,.05, c(\"x2=0\", \"x2=1\"), lty=c(1,3),bty=\"n\")\n\nx11 <- 10\nx21 <- 20\ny11 <- .05\ny12 <- .10\ny21 <- .20\ny22 <- .15\nplot(c(x11,x21),c(y11,y12),xlab=expression(x[1]),ylab=\"Mean\", main=\"Interaction\", type=\"l\", ylim=c(0,.20), lwd=2)\nlines(c(x11,x21),c(y21,y22),type=\"l\",lty=2, lwd=2)\n#legend(16,.05, c(\"x2=0\", \"x2=1\"), lty=c(1,3),bty=\"n\")\n\n\n\n\n\n\n## FEV data\n\nFEVdata <- read.table(file=\"F:\\\\MyDocuments\\\\BAYES\\\\LinearRegression\\\\CodeandData\\\\FEVdataAge10to19.txt\",header=T, sep=\"\\t\")\nattach(FEVdata)\noptions(contrasts=c(\"contr.treatment\",\"contr.poly\"))\n\n\n## Interaction plot\nplot(Age,FEV,xlab=\"Age\", ylab=\"FEV\")\nlines(lowess(Age[Smoke==1],FEV[Smoke==1],f=.95),lwd=2,cex=1.2)\nlines(lowess(Age[Smoke==0],FEV[Smoke==0],f=.95),lty=3,lwd=2,cex=1.2)\nlegend(\"bottomright\", c(\"Smoker\", \"Nonsmoker\"), lty=c(1,3))\n\n## Interaction plot.  LOWESS plot for the FEV data  \nplot(Age,FEV,xlab=\"Age\", ylab=\"FEV\")\nlines(lowess(Age[Smoke==1],FEV[Smoke==1],f=.95),lwd=2,cex=1.2)\nlines(lowess(Age[Smoke==0],FEV[Smoke==0],f=.95),lty=2,lwd=2,cex=1.2)\nlegend(\"bottomright\", c(\"Smoker\", \"Nonsmoker\"), lty=c(1,2))\n\n\n\n## Figure 7.2.  Plot of Bayesian posterior means from a linear regression with interaction term and diffuse prior for the FEV data\nBayesSmoker <- c(3.058,3.124,3.191,3.258,3.324,3.391,3.458,3.525,3.591,3.658)\nBayesNonsmoker <- c(2.772,2.982,3.192,3.402,3.612,3.821,4.031,4.241,4.451,4.661)\nAge1 <- seq(10,19,1)\nplot(Age,FEV,xlab=\"Age\", ylab=\"FEV\", lwd=1.5)\nlines(Age1,BayesSmoker,type='l', lty=1, lwd=2,cex=1.2)\nlines(Age1,BayesNonsmoker,type='l', lty=2, lwd=2,cex=1.2)\nlegend(\"bottomright\", c(\"Smoker\", \"Nonsmoker\"), lty=c(1,2), lwd=2)\n\n", "encoding": "ascii"}