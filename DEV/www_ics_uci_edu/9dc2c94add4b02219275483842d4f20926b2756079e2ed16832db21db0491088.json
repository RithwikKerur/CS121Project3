{"url": "https://www.ics.uci.edu/~dan/class/165/notes/avl.html", "content": "<HTML>\n<HEAD><TITLE> AVL </TITLE></HEAD>\n<BODY>\n\n<H2 align=center>Insertion into an AVL Tree </H2>\n\nBalance factors are denoted as follows:\n<table border=1>\n<tr><th>balance factor</th>\n    <th>meaning</th>\n    <th>denoted by</th>\n<tr><td align=center>+1</td>\n    <td>R subtree taller</td>\n    <td align=center><tt>+</tt></td>\n<tr><td align=center>0</td>\n    <td>R,L equal height</td>\n    <td align=center><tt>.</tt></td>\n<tr><td align=center>-1</td>\n    <td>L subtree taller</td>\n    <td align=center><tt>-</tt></td>\n</table>\n<P>\n(Heights of subtrees are indicated in parentheses.)\n<P>\nLet X be the deepest node whose balance factor has become \"illegal\".&nbsp;\nWe consider the scenario in which X's balance factor has become too large, +2.&nbsp;\n(The scenario that X's balance factor has become too small, -2, can be\nhandled in a symmetric manner.)&nbsp;\nThis illegal imbalance happened because X previously had a balance\nfactor of +1, and the insertion caused X's right subtree (headed by Y)\nto increase in height.&nbsp;\nThis height increase implies that Y had a balance factor of 0,\nbecause otherwise either Y would not gain height or Y\nwould become illegally imbalanced.&nbsp;\nThis scenario is illustrated below and devolves into 2 cases --\nthe insertion is made into Y's Right subtree or into Y's Left subtree.\n<P>\n<pre>\n                   X+\n                  / \\\n                     Y\n                    / \\\n</pre>\n<P>\n<B>Case 1</B>: insertion into Y's Right subtree\n<P>\nThis is cured by a single rotation, resulting in this subtree\nhaving the same height as it did before the insertion.\n<P>\n<pre>\n           <font color=red>X</font>+(h+2)              <font color=red>X</font>++(h+3)                    <font color=red>Y</font>.(h+2)\n          / \\                  / \\          rotate         / \\\n       (h)<font color=red>1</font>  <font color=red>Y</font>.(h+1)        (h)<font color=red>1</font>  <font color=red>Y</font>+(h+2)   (XY)L    (h+1)<font color=red>X</font>.  <font color=red>3</font>(h+1)\n            / \\      ====>       / \\        ====>        / \\\n           <font color=red>2</font>   <font color=red>3</font>                <font color=red>2</font>   <font color=red>3</font>                   <font color=red>1</font>   <font color=red>2</font>\n          (h) (h)              (h) (h+1)               (h) (h)\n               ^\n               |\n             insert\n</pre>\n<P>\n<B>Case 2</B>: insertion into Y's Left subtree\n<P>\nThere are two possible subtrees of Z where the insertion\nmay take place that are treated similarly.\n<P>\nThis is cured by a double rotation, resulting in this subtree\nhaving the same height as it did before the insertion.\n<P>\n<pre>\n           <font color=red>X</font>+(h+2)              <font color=red>X</font>++(h+3)    double          <font color=red>Z</font>.(h+2)\n          / \\                  / \\          rotate         /  \\\n       (h)<font color=red>1</font>  <font color=red>Y</font>.(h+1)        (h)<font color=red>1</font>  <font color=red>Y</font>-(h+2)   (XYZ)L    (h+1)<font color=red>X</font>.  <font color=red>Y</font>+(h+1)\n            / \\      ====>       / \\        ====>       / \\    / \\\n        (h)<font color=red>Z</font>.  <font color=red>4</font>(h)        (h+1)<font color=red>Z</font>-  <font color=red>4</font>(h)   same as     <font color=red>1</font>  <font color=red>2</font>   <font color=red>3</font>   <font color=red>4</font>\n          / \\                  / \\          (ZY)R     (h)(h) (h-1)(h)\n         <font color=red>2</font>   <font color=red>3</font>                <font color=red>2</font>   <font color=red>3</font>         (XZ)L\n      (h-1) (h-1)            (h) (h-1)\n         ^\n         |\n       insert\n\n\n           <font color=red>X</font>+(h+2)              <font color=red>X</font>++(h+3)    double          <font color=red>Z</font>.(h+2)\n          / \\                  / \\          rotate         /  \\\n       (h)<font color=red>1</font>  <font color=red>Y</font>.(h+1)       (h)<font color=red>1</font>   <font color=red>Y</font>-(h+2)   (XYZ)L    (h+1)<font color=red>X</font>-  <font color=red>Y</font>.(h+1)\n            / \\      ====>       / \\        ====>       / \\    / \\\n        (h)<font color=red>Z</font>.  <font color=red>4</font>(h)        (h+1)<font color=red>Z</font>+  <font color=red>4</font>(h)   same as     <font color=red>1</font>  <font color=red>2</font>   <font color=red>3</font>   <font color=red>4</font>\n          / \\                  / \\          (ZY)R    (h)(h-1) (h) (h)\n         <font color=red>2</font>   <font color=red>3</font>                <font color=red>2</font>   <font color=red>3</font>         (XZ)L\n      (h-1) (h-1)          (h-1) (h)\n             ^\n             |\n           insert\n</pre>\n<P>\n<HR>\n</BODY></HTML>\n", "encoding": "ascii"}