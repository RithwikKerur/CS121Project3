{"url": "https://www.ics.uci.edu/~majumder/VC/211HW3/vlfeat/src/test_mathop_fast_resqrt.tc", "content": "#define F_EPS VL_XCAT(SFX2, _EPSILON)\n#define F_MAX VL_XCAT(SFX2, _MAX)\n#define F_MIN VL_XCAT(SFX2, _MIN)\n\n{\n  T x ;\n  T dx ;\n  T maxErr = 0 ;\n  T acc ;\n  int numEval = 0 ;\n  double elaps ;\n\n  char const* funcName = VL_XSTRINGIFY(VL_XCAT(vl_fast_resqrt_, SFX)) ;\n\n  for (x = F_MIN, dx = F_EPS ; x < F_MAX ; x += dx, dx *= 1 + 1e-6 ) {\n    T y  = VL_XCAT(vl_fast_resqrt_, SFX)(x) ;\n    T y_ = ONE / SQRT (x) ;\n    T err = ABS (y_ - y) / y * 100 ;\n    maxErr = VL_MAX(maxErr, err) ;\n  }\n\n  VL_PRINTF (\"%20s (max relative error: %.6f%%)\\n\",  funcName, maxErr) ;\n  if (maxErr > 0.001) {\n    VL_PRINTF (\"error: %s: relative error is too large!\\n\", funcName) ;\n    error = 1 ;\n  }\n\n  vl_tic() ;\n  numEval = 0 ;\n  acc = 0 ;\n  for (x = F_MIN, dx = F_EPS ; x < F_MAX ; x += dx, dx *= 1 + 1e-6 ) {\n    T y  = VL_XCAT(vl_fast_resqrt_, SFX)(x) ;\n    acc += y ;\n    numEval += 1 ;\n  }\n  elaps = vl_toc() ;\n\n  VL_PRINTF (\"%20s %10.2g %10.2g\\n\",\n             funcName,\n             elaps,\n             numEval / elaps) ;\n\n  vl_tic() ;\n  numEval = 0 ;\n  acc = 0 ;\n  for (x = F_MIN, dx = F_EPS ; x < F_MAX ; x += dx, dx *= 1 + 1e-6 ) {\n    T y  = ONE / SQRT (x) ;\n    acc += y ;\n    numEval += 1 ;\n  }\n  elaps = vl_toc() ;\n\n  VL_PRINTF (\"%20s %10.2g %10.2g\\n\",\n             \"baseline\",\n             elaps,\n             numEval / elaps) ;\n}\n\n#undef F_MIN\n#undef F_MAX\n#undef F_EPS\n", "encoding": "ascii"}