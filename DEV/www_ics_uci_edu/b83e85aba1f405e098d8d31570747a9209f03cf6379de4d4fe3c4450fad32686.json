{"url": "https://www.ics.uci.edu/~perl/publication/losing_control/", "content": "<!DOCTYPE html>\n<html lang=\"en-us\">\n<head>\n\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <meta name=\"generator\" content=\"Source Themes Academic 4.0.0\">\n  <meta name=\"generator\" content=\"Hugo 0.54.0\" />\n\n  \n\n  \n  \n  \n  \n  \n    \n    \n    \n  \n  \n\n  <meta name=\"author\" content=\"Per Larsen\">\n\n  \n  \n  \n    \n  \n  <meta name=\"description\" content=\"Adversaries exploit memory corruption vulnerabilities to hijack a program&#39;s control flow and gain arbitrary code execution. One promising mitigation, control-flow integrity (CFI), has been the subject of extensive research in the past decade. One of the core findings is that adversaries can construct Turing-complete code-reuse attacks against coarse-grained CFI policies because they admit control flows that are not part of the original program. This insight led the research community to focus on fine-grained CFI implementations. In this paper we show how to exploit heap-based vulnerabilities to control the stack contents including security-critical values used to validate control-flow transfers. Our investigation shows that although program analysis and compiler-based mitigations reduce stack-based vulnerabilities, stack-based memory corruption remains an open problem. Using the Chromium web browser we demonstrate real-world attacks against various CFI implementations: 1)~against CFI implementations under Windows 32-bit by exploiting unprotected context switches, and 2)~against state-of-the-art fine-grained CFI implementations (IFCC and VTV) in the two premier open-source compilers under Unix-like operating systems. Both 32 and 64-bit x86 CFI checks are vulnerable to stack manipulation. Finally, we provide an exploit technique against the latest shadow stack implementation.\">\n\n  \n  <link rel=\"alternate\" hreflang=\"en-us\" href=\"https://www.ics.uci.edu/~perl/publication/losing_control/\">\n\n  \n\n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n  \n  \n  <meta name=\"theme-color\" content=\"hsl(339, 90%, 68%)\">\n  \n\n  \n  \n  \n  \n    \n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css\" integrity=\"sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=\" crossorigin=\"anonymous\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css\" integrity=\"sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=\" crossorigin=\"anonymous\">\n    <link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.6.0/css/all.css\" integrity=\"sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h\" crossorigin=\"anonymous\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css\" integrity=\"sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=\" crossorigin=\"anonymous\">\n\n    \n    \n    \n      \n    \n    \n      \n      \n        \n          <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css\" crossorigin=\"anonymous\" title=\"hl-light\" disabled>\n          <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css\" crossorigin=\"anonymous\" title=\"hl-dark\">\n        \n      \n    \n\n    \n\n    \n\n  \n\n  \n  \n  <link rel=\"stylesheet\" href=\"//fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono\">\n  \n\n  <link rel=\"stylesheet\" href=\"/~perl/styles.css\">\n  \n\n  \n  \n    <script>\n      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;\n      ga('create', 'UA-44066564-1', 'auto');\n      \n      ga('require', 'eventTracker');\n      ga('require', 'outboundLinkTracker');\n      ga('require', 'urlChangeTracker');\n      ga('send', 'pageview');\n    </script>\n    <script async src=\"//www.google-analytics.com/analytics.js\"></script>\n    \n    <script async src=\"https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js\" integrity=\"sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==\" crossorigin=\"anonymous\"></script>\n    \n  \n  \n\n  \n  <link rel=\"alternate\" href=\"https://www.ics.uci.edu/~perl/index.xml\" type=\"application/rss+xml\" title=\"~perl\">\n  <link rel=\"feed\" href=\"https://www.ics.uci.edu/~perl/index.xml\" type=\"application/rss+xml\" title=\"~perl\">\n  \n\n  <link rel=\"manifest\" href=\"/~perl/site.webmanifest\">\n  <link rel=\"icon\" type=\"image/png\" href=\"/~perl/img/icon.png\">\n  <link rel=\"apple-touch-icon\" type=\"image/png\" href=\"/~perl/img/icon-192.png\">\n\n  <link rel=\"canonical\" href=\"https://www.ics.uci.edu/~perl/publication/losing_control/\">\n\n  \n  \n  \n  \n    \n    \n  \n  <meta property=\"twitter:card\" content=\"summary\">\n  \n  <meta property=\"og:site_name\" content=\"~perl\">\n  <meta property=\"og:url\" content=\"https://www.ics.uci.edu/~perl/publication/losing_control/\">\n  <meta property=\"og:title\" content=\"Losing control: On the effectiveness of control-flow integrity under stack attacks | ~perl\">\n  <meta property=\"og:description\" content=\"Adversaries exploit memory corruption vulnerabilities to hijack a program&#39;s control flow and gain arbitrary code execution. One promising mitigation, control-flow integrity (CFI), has been the subject of extensive research in the past decade. One of the core findings is that adversaries can construct Turing-complete code-reuse attacks against coarse-grained CFI policies because they admit control flows that are not part of the original program. This insight led the research community to focus on fine-grained CFI implementations. In this paper we show how to exploit heap-based vulnerabilities to control the stack contents including security-critical values used to validate control-flow transfers. Our investigation shows that although program analysis and compiler-based mitigations reduce stack-based vulnerabilities, stack-based memory corruption remains an open problem. Using the Chromium web browser we demonstrate real-world attacks against various CFI implementations: 1)~against CFI implementations under Windows 32-bit by exploiting unprotected context switches, and 2)~against state-of-the-art fine-grained CFI implementations (IFCC and VTV) in the two premier open-source compilers under Unix-like operating systems. Both 32 and 64-bit x86 CFI checks are vulnerable to stack manipulation. Finally, we provide an exploit technique against the latest shadow stack implementation.\"><meta property=\"og:image\" content=\"https://www.ics.uci.edu/~perl/img/portrait.jpg\">\n  <meta property=\"og:locale\" content=\"en-us\">\n  \n  <meta property=\"article:published_time\" content=\"2015-10-12T00:00:00&#43;00:00\">\n  \n  <meta property=\"article:modified_time\" content=\"2015-10-12T00:00:00&#43;00:00\">\n  \n\n  \n\n  \n\n  <title>Losing control: On the effectiveness of control-flow integrity under stack attacks | ~perl</title>\n\n</head>\n<body id=\"top\" data-spy=\"scroll\" data-target=\"#TableOfContents\" data-offset=\"71\" class=\"dark\">\n  <aside class=\"search-results\" id=\"search\">\n  <div class=\"container\">\n    <section class=\"search-header\">\n\n      <div class=\"row no-gutters justify-content-between mb-3\">\n        <div class=\"col-6\">\n          <h1>Search</h1>\n        </div>\n        <div class=\"col-6 col-search-close\">\n          <a class=\"js-search\" href=\"#\"><i class=\"fas fa-times-circle text-muted\" aria-hidden=\"true\"></i></a>\n        </div>\n      </div>\n\n      <div id=\"search-box\">\n        \n        \n        \n      </div>\n\n    </section>\n    <section class=\"section-search-results\">\n\n      <div id=\"search-hits\">\n        \n      </div>\n\n    </section>\n  </div>\n</aside>\n\n\n<nav class=\"navbar navbar-light fixed-top navbar-expand-lg py-0\" id=\"navbar-main\">\n  <div class=\"container\">\n\n    \n      <a class=\"navbar-brand\" href=\"/~perl/\">~perl</a>\n      \n      <button type=\"button\" class=\"navbar-toggler\" data-toggle=\"collapse\"\n              data-target=\"#navbar\" aria-controls=\"navbar\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n        <span><i class=\"fas fa-bars\"></i></span>\n      </button>\n      \n\n    \n    <div class=\"collapse navbar-collapse\" id=\"navbar\">\n\n      \n      \n      <ul class=\"navbar-nav ml-auto\">\n        \n\n        \n\n        \n        \n        \n          \n        \n\n        <li class=\"nav-item\">\n          <a class=\"nav-link\" href=\"/~perl/#about\">\n            \n            <span>Home</span>\n            \n          </a>\n        </li>\n\n        \n        \n\n        \n\n        \n        \n        \n          \n        \n\n        <li class=\"nav-item\">\n          <a class=\"nav-link\" href=\"/~perl/#talks\">\n            \n            <span>Talks</span>\n            \n          </a>\n        </li>\n\n        \n        \n\n        \n\n        \n        \n        \n          \n        \n\n        <li class=\"nav-item\">\n          <a class=\"nav-link\" href=\"/~perl/#publications_selected\">\n            \n            <span>Publications</span>\n            \n          </a>\n        </li>\n\n        \n        \n\n        \n\n        \n        \n        \n          \n        \n\n        <li class=\"nav-item\">\n          <a class=\"nav-link\" href=\"/~perl/docs/cv.pdf\">\n            \n            <span>CV</span>\n            \n          </a>\n        </li>\n\n        \n        \n\n        \n\n        \n        \n        \n          \n        \n\n        <li class=\"nav-item\">\n          <a class=\"nav-link\" href=\"/~perl/#contact\">\n            \n            <span>Contact</span>\n            \n          </a>\n        </li>\n\n        \n        \n\n      \n\n        \n\n        \n\n        \n\n        \n\n      </ul>\n\n    </div>\n  </div>\n</nav>\n\n<div class=\"pub\" itemscope itemtype=\"http://schema.org/CreativeWork\">\n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n  \n  \n  \n<div class=\"article-container pt-3\">\n  <h1 itemprop=\"name\">Losing control: On the effectiveness of control-flow integrity under stack attacks</h1>\n\n  \n\n  \n    \n\n\n\n<meta content=\"2015-10-12 00:00:00 &#43;0000 UTC\" itemprop=\"datePublished\">\n<meta content=\"2015-10-12 00:00:00 &#43;0000 UTC\" itemprop=\"dateModified\">\n\n<div class=\"article-metadata\">\n\n  \n  \n  \n  \n  <div>\n    <span>Mauro Conti</span>\n    <span>Stephen Crane</span>\n    <span>Lucas Davi</span>\n    <span>Michael Franz</span>\n    <span>Per Larsen</span>\n    <span>Marco Negro</span>\n    <span>Christopher Liebchen</span>\n    <span>Mohaned Qunaibit</span>\n    <span>Ahmad-Reza Sadeghi</span>\n    \n  </div>\n  \n  \n\n  \n  <span class=\"article-date\">\n    \n    \n      \n    \n    <time>October, 2015</time>\n  </span>\n  \n\n  \n\n  \n\n  \n  \n\n  \n\n  \n    \n<div class=\"share-box\" aria-hidden=\"true\">\n  <ul class=\"share\">\n    <li>\n      <a class=\"twitter\"\n         href=\"https://twitter.com/intent/tweet?text=Losing%20control%3a%20On%20the%20effectiveness%20of%20control-flow%20integrity%20under%20stack%20attacks&amp;url=https%3a%2f%2fwww.ics.uci.edu%2f~perl%2fpublication%2flosing_control%2f\"\n         target=\"_blank\" rel=\"noopener\">\n        <i class=\"fab fa-twitter\"></i>\n      </a>\n    </li>\n    <li>\n      <a class=\"facebook\"\n         href=\"https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.ics.uci.edu%2f~perl%2fpublication%2flosing_control%2f\"\n         target=\"_blank\" rel=\"noopener\">\n        <i class=\"fab fa-facebook-f\"></i>\n      </a>\n    </li>\n    <li>\n      <a class=\"linkedin\"\n         href=\"https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.ics.uci.edu%2f~perl%2fpublication%2flosing_control%2f&amp;title=Losing%20control%3a%20On%20the%20effectiveness%20of%20control-flow%20integrity%20under%20stack%20attacks\"\n         target=\"_blank\" rel=\"noopener\">\n        <i class=\"fab fa-linkedin-in\"></i>\n      </a>\n    </li>\n    <li>\n      <a class=\"weibo\"\n         href=\"http://service.weibo.com/share/share.php?url=https%3a%2f%2fwww.ics.uci.edu%2f~perl%2fpublication%2flosing_control%2f&amp;title=Losing%20control%3a%20On%20the%20effectiveness%20of%20control-flow%20integrity%20under%20stack%20attacks\"\n         target=\"_blank\" rel=\"noopener\">\n        <i class=\"fab fa-weibo\"></i>\n      </a>\n    </li>\n    <li>\n      <a class=\"email\"\n         href=\"mailto:?subject=Losing%20control%3a%20On%20the%20effectiveness%20of%20control-flow%20integrity%20under%20stack%20attacks&amp;body=https%3a%2f%2fwww.ics.uci.edu%2f~perl%2fpublication%2flosing_control%2f\">\n        <i class=\"fas fa-envelope\"></i>\n      </a>\n    </li>\n  </ul>\n</div>\n\n\n  \n\n</div>\n\n    \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"btn-links mb-3\">\n  \n  \n\n\n\n\n\n\n\n  \n    \n  \n\n\n<a class=\"btn btn-outline-primary my-1 mr-1\" href=\"https://dl.acm.org/citation.cfm?id=2813671\" target=\"_blank\" rel=\"noopener\">\n  PDF\n</a>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</div>\n\n\n  \n</div>\n\n\n\n  <div class=\"article-container\">\n\n    \n    <h3>Abstract</h3>\n    <p class=\"pub-abstract\" itemprop=\"text\">Adversaries exploit memory corruption vulnerabilities to hijack a program&rsquo;s control flow and gain arbitrary code execution. One promising mitigation, control-flow integrity (CFI), has been the subject of extensive research in the past decade. One of the core findings is that adversaries can construct Turing-complete code-reuse attacks against coarse-grained CFI policies because they admit control flows that are not part of the original program. This insight led the research community to focus on fine-grained CFI implementations. In this paper we show how to exploit heap-based vulnerabilities to control the stack contents including security-critical values used to validate control-flow transfers. Our investigation shows that although program analysis and compiler-based mitigations reduce stack-based vulnerabilities, stack-based memory corruption remains an open problem. Using the Chromium web browser we demonstrate real-world attacks against various CFI implementations: 1)~against CFI implementations under Windows 32-bit by exploiting unprotected context switches, and 2)~against state-of-the-art fine-grained CFI implementations (IFCC and VTV) in the two premier open-source compilers under Unix-like operating systems. Both 32 and 64-bit x86 CFI checks are vulnerable to stack manipulation. Finally, we provide an exploit technique against the latest shadow stack implementation.</p>\n    \n\n    \n    <div class=\"row\">\n      <div class=\"col-md-1\"></div>\n      <div class=\"col-md-10\">\n        <div class=\"row\">\n          <div class=\"col-12 col-md-3 pub-row-heading\">Type</div>\n          <div class=\"col-12 col-md-9\">\n            \n\n            \n            \n            <a href=\"/~perl/publication/#1\">\n              Conference paper\n            </a>\n            \n          </div>\n        </div>\n      </div>\n      <div class=\"col-md-1\"></div>\n    </div>\n    <div class=\"d-md-none space-below\"></div>\n    \n\n    \n    <div class=\"row\">\n      <div class=\"col-md-1\"></div>\n      <div class=\"col-md-10\">\n        <div class=\"row\">\n          <div class=\"col-12 col-md-3 pub-row-heading\">Publication</div>\n          <div class=\"col-12 col-md-9\">In <em>22nd ACM SIGSAC Conference on Computer and Communications Security</em></div>\n        </div>\n      </div>\n      <div class=\"col-md-1\"></div>\n    </div>\n    <div class=\"d-md-none space-below\"></div>\n    \n\n    <div class=\"space-below\"></div>\n\n    <div class=\"article-style\"></div>\n\n    \n\n    \n\n\n\n\n\n\n  \n  \n    \n  \n  \n\n\n\n\n\n\n\n\n  </div>\n</div>\n\n\n\n<div class=\"container\">\n  <footer class=\"site-footer\">\n  \n\n  <p class=\"powered-by\">\n    &copy; 2018 &middot; \n\n    Powered by the\n    <a href=\"https://sourcethemes.com/academic/\" target=\"_blank\" rel=\"noopener\">Academic theme</a> for\n    <a href=\"https://gohugo.io\" target=\"_blank\" rel=\"noopener\">Hugo</a>.\n\n    \n    <span class=\"float-right\" aria-hidden=\"true\">\n      <a href=\"#\" id=\"back_to_top\">\n        <span class=\"button_icon\">\n          <i class=\"fas fa-chevron-up fa-2x\"></i>\n        </span>\n      </a>\n    </span>\n    \n  </p>\n</footer>\n\n</div>\n\n\n<div id=\"modal\" class=\"modal fade\" role=\"dialog\">\n  <div class=\"modal-dialog\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h5 class=\"modal-title\">Cite</h5>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <pre><code class=\"tex hljs\"></code></pre>\n      </div>\n      <div class=\"modal-footer\">\n        <a class=\"btn btn-outline-primary my-1 js-copy-cite\" href=\"#\" target=\"_blank\">\n          <i class=\"fas fa-copy\"></i> Copy\n        </a>\n        <a class=\"btn btn-outline-primary my-1 js-download-cite\" href=\"#\" target=\"_blank\">\n          <i class=\"fas fa-download\"></i> Download\n        </a>\n        <div id=\"modal-error\"></div>\n      </div>\n    </div>\n  </div>\n</div>\n\n    \n\n    \n    \n    \n    <script src=\"/~perl/js/mathjax-config.js\"></script>\n    \n\n    \n    \n    \n      <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js\" integrity=\"sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==\" crossorigin=\"anonymous\"></script>\n      <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js\" integrity=\"sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=\" crossorigin=\"anonymous\"></script>\n      <script src=\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js\" integrity=\"sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=\" crossorigin=\"anonymous\"></script>\n      <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js\" integrity=\"sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=\" crossorigin=\"anonymous\"></script>\n      <script src=\"https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js\" integrity=\"sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=\" crossorigin=\"anonymous\"></script>\n\n      \n        \n        <script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js\" integrity=\"sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=\" crossorigin=\"anonymous\"></script>\n        \n      \n\n      \n      \n      <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full\" integrity=\"sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=\" crossorigin=\"anonymous\" async></script>\n      \n    \n\n    \n    \n      <script async defer src=\"//maps.googleapis.com/maps/api/js?key=AIzaSyB_DEkV2y3xlXeeDfG9fcbZYyYsPxBpldM\"></script>\n      \n      <script src=\"https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js\" integrity=\"sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=\" crossorigin=\"anonymous\"></script>\n      \n    \n\n    \n    \n    \n\n    \n    \n    <script>hljs.initHighlightingOnLoad();</script>\n    \n\n    \n    \n    <script>\n      const search_index_filename = \"/~perl/index.json\";\n      const i18n = {\n        'placeholder': \"Search...\",\n        'results': \"results found\",\n        'no_results': \"No results found\"\n      };\n      const content_type = {\n        'post': \"Posts\",\n        'project': \"Projects\",\n        'publication' : \"Publications\",\n        'talk' : \"Talks\"\n        };\n    </script>\n    \n\n    \n    \n\n    \n\n    \n    \n\n    \n    \n\n    \n    \n    \n    \n    \n    \n    \n      \n    \n    \n    \n    \n    <script src=\"/~perl/js/academic.min.2b2a0e939771664b9c3baf89bef86785.js\"></script>\n\n  </body>\n</html>\n\n", "encoding": "ascii"}