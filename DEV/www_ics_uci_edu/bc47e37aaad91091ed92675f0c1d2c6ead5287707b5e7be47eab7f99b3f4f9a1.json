{"url": "https://www.ics.uci.edu/~wjohnson/BIDA/Ch5/RcodeCh5.txt", "content": "Bayes Book\nChapter 5\nR code\nAdam Branscum\n\n\n\n\n\nSection 5.1.1.2\n\n# Code 1\ntheta0 <- 0.2\nbtilde <- 1:100\na <- (1+theta0*(btilde-2)) / (1-theta0)\nqbeta(0.95,a,btilde)\n\n\n\n# Code 2\nbtilde <- 1:100\ntheta0 <- 0.2\nb1tilde <- 10+(btilde/100)\na <- (1+theta0*(b1tilde-2)) / (1-theta0)\nqbeta(0.95,a,b1tilde)\n\n\n\n\n\n# Section 5.2:  Brass alloy zinc data\nn=12\ny=c(4.20, 4.36, 4.11, 3.96, 5.63, 4.50, 5.64, 4.38,4.45, 3.67, 5.26, 4.66)\nmean(y)\nsd(y)\nsd(y)/sqrt(n)\nmin(y)\nmax(y)\nquantile(y, c(0.25,0.50,0.75))\n\n\n\n\n\n# Section 5.2.3:  Independence priors\nsigma0 <- 15.625\nf <- 1:100\ne <- 1+sigma0*f\nqgamma(0.95,e,f)   ## Look for 20.31\n\nf <- seq(2,3,0.001)\ne <- 1+sigma0*f\nqgamma(0.95,e,f)   ## Look for 20.31\n\n\n\n\n\ntau0 <- 0.004096\nd <- 1000:2000\nc <- 1+tau0*d\nqgamma(0.95,c,d)   ## Look for 0.008359\n\n\n\n\nx <- seq(0,40,0.01)\ny <- 1/sqrt(rgamma(10000,6.439,1328))\nhist(y,prob=T)\nlines(x,dgamma(x,41.375,2.588),lty=2)\n\n\n\n\n\n# Exercise 5.26\n#1 R Code for finding prior on sigma\nalpha <- 0.90\nbeta <- 0.95\na <- 65 # Best guess for mu\ntildegamma <- 85 # Best guess for gamma_alpha\ntildeu <- 91 # Best guess percentile of gamma_alpha\nzalpha <- 1.28  # qnorm(0.90,0,1)\nf <- 3 # Initial value for f\n# Could use a sequence of values, say f <- seq(1,50,1)\nsigma0 <- (tildegamma - a)/zalpha\ne <- 1 + sigma0*f\n# We must find the Gamma(e,f) distribution that\n# has beta-percentile = tildesigmabeta\ntildesigmabeta <- (tildeu - a)/zalpha\ntrialq <- qgamma(beta,e,f) # Return beta-percentile for the selected gamma distribution.\ntrialq # If trialq = tildesigmabeta\ntildesigmabeta # stop and pick corresponding f\n\n\n\n#2 R Code for finding prior on tau\nalpha <- 0.9\nbeta <- 0.95\nzalpha <- 1.28\na <- 65\ntildegamma <- 85\ntildel <- 79\nd <- 1100\ntau0 = (zalpha/(tildegamma - a))^2\nc = 1 + tau0*d\ntildetaubeta = (zalpha/(tildel - a))^2\ntrialq = qgamma(beta,c,d)\ntrialq\ntildetaubeta\n\n\n\n\n\n\n\n\n\n#Exercise 5.32\nmode <- 10\nb <- 1:100\na <- 1+(mode * b)\nqgamma(0.95,a,b)\n\nmode <- 10\nb <- 1:100/100\na <- 1+(mode*b)\nround(qgamma(0.95,a,b),1)\n\nb[22]\na[22]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "encoding": "ascii"}