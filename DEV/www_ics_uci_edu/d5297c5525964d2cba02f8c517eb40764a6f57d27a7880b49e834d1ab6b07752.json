{"url": "https://www.ics.uci.edu/~eppstein/projects/pairs/Source/testbed/TwoAdic.cp", "content": "// Test of closest pair algorithms\n// David Eppstein, UC Irvine, 19 Apr 1997\n//\n// Random binary values with two-adic valuation\n// distance = 1/(2^i) where i=index of least significant differing bit\n\n#include \"TwoAdic.h\"\n#include \"Random.h\"\n#include \"Error.h\"\n\nTwoAdic::TwoAdic(unsigned long np) : PointSet(np)\n{\n\tvalues = new unsigned long[np];\n\tif (values == 0) error(\"TwoAdic: can't allocate table of values\");\n\twhile (np > 0) values[--np] = RandomLong();\n}\n\nTwoAdic::~TwoAdic() { delete values; }\n\ndouble TwoAdic::operator() (point i, point j)\n{\n\tgDistances++;\n\tunsigned long x = values[i]^values[j];\t// get differing bits\n\tx ^= x - 1;\t\t\t\t\t// turn into 2^{i+1}-1 where i=least sig diff\n\treturn 2.0 / ((double) x + 1.0);\n}", "encoding": "ascii"}